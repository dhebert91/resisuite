/*! 
* date.js - v1.0 Alpha-1
* http://www.datejs.com/
* Copyright (c) 2006-2007 - Coolite Inc.; Licensed MIT licence */
function hex_md5(a){return binl2hex(core_md5(str2binl(a),a.length*chrsz))}function core_md5(a,b){a[b>>5]|=128<<b%32,a[(b+64>>>9<<4)+14]=b;for(var c=1732584193,d=-271733879,e=-1732584194,f=271733878,g=0;g<a.length;g+=16)var h=c,i=d,j=e,k=f,c=md5_ff(c,d,e,f,a[g+0],7,-680876936),f=md5_ff(f,c,d,e,a[g+1],12,-389564586),e=md5_ff(e,f,c,d,a[g+2],17,606105819),d=md5_ff(d,e,f,c,a[g+3],22,-1044525330),c=md5_ff(c,d,e,f,a[g+4],7,-176418897),f=md5_ff(f,c,d,e,a[g+5],12,1200080426),e=md5_ff(e,f,c,d,a[g+6],17,-1473231341),d=md5_ff(d,e,f,c,a[g+7],22,-45705983),c=md5_ff(c,d,e,f,a[g+8],7,1770035416),f=md5_ff(f,c,d,e,a[g+9],12,-1958414417),e=md5_ff(e,f,c,d,a[g+10],17,-42063),d=md5_ff(d,e,f,c,a[g+11],22,-1990404162),c=md5_ff(c,d,e,f,a[g+12],7,1804603682),f=md5_ff(f,c,d,e,a[g+13],12,-40341101),e=md5_ff(e,f,c,d,a[g+14],17,-1502002290),d=md5_ff(d,e,f,c,a[g+15],22,1236535329),c=md5_gg(c,d,e,f,a[g+1],5,-165796510),f=md5_gg(f,c,d,e,a[g+6],9,-1069501632),e=md5_gg(e,f,c,d,a[g+11],14,643717713),d=md5_gg(d,e,f,c,a[g+0],20,-373897302),c=md5_gg(c,d,e,f,a[g+5],5,-701558691),f=md5_gg(f,c,d,e,a[g+10],9,38016083),e=md5_gg(e,f,c,d,a[g+15],14,-660478335),d=md5_gg(d,e,f,c,a[g+4],20,-405537848),c=md5_gg(c,d,e,f,a[g+9],5,568446438),f=md5_gg(f,c,d,e,a[g+14],9,-1019803690),e=md5_gg(e,f,c,d,a[g+3],14,-187363961),d=md5_gg(d,e,f,c,a[g+8],20,1163531501),c=md5_gg(c,d,e,f,a[g+13],5,-1444681467),f=md5_gg(f,c,d,e,a[g+2],9,-51403784),e=md5_gg(e,f,c,d,a[g+7],14,1735328473),d=md5_gg(d,e,f,c,a[g+12],20,-1926607734),c=md5_hh(c,d,e,f,a[g+5],4,-378558),f=md5_hh(f,c,d,e,a[g+8],11,-2022574463),e=md5_hh(e,f,c,d,a[g+11],16,1839030562),d=md5_hh(d,e,f,c,a[g+14],23,-35309556),c=md5_hh(c,d,e,f,a[g+1],4,-1530992060),f=md5_hh(f,c,d,e,a[g+4],11,1272893353),e=md5_hh(e,f,c,d,a[g+7],16,-155497632),d=md5_hh(d,e,f,c,a[g+10],23,-1094730640),c=md5_hh(c,d,e,f,a[g+13],4,681279174),f=md5_hh(f,c,d,e,a[g+0],11,-358537222),e=md5_hh(e,f,c,d,a[g+3],16,-722521979),d=md5_hh(d,e,f,c,a[g+6],23,76029189),c=md5_hh(c,d,e,f,a[g+9],4,-640364487),f=md5_hh(f,c,d,e,a[g+12],11,-421815835),e=md5_hh(e,f,c,d,a[g+15],16,530742520),d=md5_hh(d,e,f,c,a[g+2],23,-995338651),c=md5_ii(c,d,e,f,a[g+0],6,-198630844),f=md5_ii(f,c,d,e,a[g+7],10,1126891415),e=md5_ii(e,f,c,d,a[g+14],15,-1416354905),d=md5_ii(d,e,f,c,a[g+5],21,-57434055),c=md5_ii(c,d,e,f,a[g+12],6,1700485571),f=md5_ii(f,c,d,e,a[g+3],10,-1894986606),e=md5_ii(e,f,c,d,a[g+10],15,-1051523),d=md5_ii(d,e,f,c,a[g+1],21,-2054922799),c=md5_ii(c,d,e,f,a[g+8],6,1873313359),f=md5_ii(f,c,d,e,a[g+15],10,-30611744),e=md5_ii(e,f,c,d,a[g+6],15,-1560198380),d=md5_ii(d,e,f,c,a[g+13],21,1309151649),c=md5_ii(c,d,e,f,a[g+4],6,-145523070),f=md5_ii(f,c,d,e,a[g+11],10,-1120210379),e=md5_ii(e,f,c,d,a[g+2],15,718787259),d=md5_ii(d,e,f,c,a[g+9],21,-343485551),c=safe_add(c,h),d=safe_add(d,i),e=safe_add(e,j),f=safe_add(f,k);return[c,d,e,f]}function md5_cmn(a,b,c,d,e,f){return safe_add(bit_rol(safe_add(safe_add(b,a),safe_add(d,f)),e),c)}function md5_ff(a,b,c,d,e,f,g){return md5_cmn(b&c|~b&d,a,b,e,f,g)}function md5_gg(a,b,c,d,e,f,g){return md5_cmn(b&d|c&~d,a,b,e,f,g)}function md5_hh(a,b,c,d,e,f,g){return md5_cmn(b^c^d,a,b,e,f,g)}function md5_ii(a,b,c,d,e,f,g){return md5_cmn(c^(b|~d),a,b,e,f,g)}function core_hmac_md5(a,b){var c=str2binl(a);16<c.length&&(c=core_md5(c,a.length*chrsz));for(var d=Array(16),e=Array(16),f=0;16>f;f++)d[f]=909522486^c[f],e[f]=1549556828^c[f];return c=core_md5(d.concat(str2binl(b)),512+b.length*chrsz),core_md5(e.concat(c),640)}function safe_add(a,b){var c=(65535&a)+(65535&b);return(a>>16)+(b>>16)+(c>>16)<<16|65535&c}function bit_rol(a,b){return a<<b|a>>>32-b}function str2binl(a){for(var b=[],c=(1<<chrsz)-1,d=0;d<a.length*chrsz;d+=chrsz)b[d>>5]|=(a.charCodeAt(d/chrsz)&c)<<d%32;return b}function binl2str(a){for(var b="",c=(1<<chrsz)-1,d=0;d<32*a.length;d+=chrsz)b+=String.fromCharCode(a[d>>5]>>>d%32&c);return b}function binl2hex(a){for(var b=hexcase?"0123456789ABCDEF":"0123456789abcdef",c="",d=0;d<4*a.length;d++)c+=b.charAt(a[d>>2]>>8*(d%4)+4&15)+b.charAt(a[d>>2]>>8*(d%4)&15);return c}function binl2b64(a){for(var b="",c=0;c<4*a.length;c+=3)for(var d=(a[c>>2]>>8*(c%4)&255)<<16|(a[c+1>>2]>>8*((c+1)%4)&255)<<8|a[c+2>>2]>>8*((c+2)%4)&255,e=0;4>e;e++)b=8*c+6*e>32*a.length?b+b64pad:b+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>6*(3-e)&63);return b}function rtrim(a){for(;' '==a.charAt(a.length-1);)a=a.slice(0,-1);return a}function ucfirst(a){return'string'==typeof a?a.charAt(0).toUpperCase()+a.substr(1):''}function lcfirst(a){return'string'==typeof a?a.charAt(0).toLowerCase()+a.substr(1):''}function explode(a,b){for(var c=[],d=0,e=b.length;e>d;){if(pos=b.indexOf(a,d),-1==pos){c.push(b.slice(d));break}c.push(b.slice(d,pos)),d=pos+a.length}return c}function remove_value(a,b){var c=[];for(i in a)a[i]!=b&&c.push(a[i]);return c}function add_value(a,b){var c=remove_value(a,b);return c.push(b),c}function merge_domains(a,b){result=[];for(x in a)for(y in b)x.push(y),result.push([x]);return result}Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|after|from)/i,subtract:/^(\-|before|ago)/i,yesterday:/^yesterday/i,today:/^t(oday)?/i,tomorrow:/^tomorrow/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^min(ute)?s?/i,hour:/^h(ou)?rs?/i,week:/^w(ee)?k/i,month:/^m(o(nth)?s?)?/i,day:/^d(ays?)?/i,year:/^y((ea)?rs?)?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a|p)/i},abbreviatedTimeZoneStandard:{GMT:"-000",EST:"-0400",CST:"-0500",MST:"-0600",PST:"-0700"},abbreviatedTimeZoneDST:{GMT:"-000",EDT:"-0500",CDT:"-0600",MDT:"-0700",PDT:"-0800"}},Date.getMonthNumberFromName=function(a){for(var b=Date.CultureInfo.monthNames,c=Date.CultureInfo.abbreviatedMonthNames,d=a.toLowerCase(),e=0;e<b.length;e++)if(b[e].toLowerCase()==d||c[e].toLowerCase()==d)return e;return-1},Date.getDayNumberFromName=function(a){for(var b=Date.CultureInfo.dayNames,c=Date.CultureInfo.abbreviatedDayNames,d=(Date.CultureInfo.shortestDayNames,a.toLowerCase()),e=0;e<b.length;e++)if(b[e].toLowerCase()==d||c[e].toLowerCase()==d)return e;return-1},Date.isLeapYear=function(a){return a%4===0&&a%100!==0||a%400===0},Date.getDaysInMonth=function(a,b){return[31,Date.isLeapYear(a)?29:28,31,30,31,30,31,31,30,31,30,31][b]},Date.getTimezoneOffset=function(a,b){return b?Date.CultureInfo.abbreviatedTimeZoneDST[a.toUpperCase()]:Date.CultureInfo.abbreviatedTimeZoneStandard[a.toUpperCase()]},Date.getTimezoneAbbreviation=function(a,b){var c,d=b?Date.CultureInfo.abbreviatedTimeZoneDST:Date.CultureInfo.abbreviatedTimeZoneStandard;for(c in d)if(d[c]===a)return c;return null},Date.prototype.clone=function(){return new Date(this.getTime())},Date.prototype.compareTo=function(a){if(isNaN(this))throw new Error(this);if(a instanceof Date&&!isNaN(a))return this>a?1:a>this?-1:0;throw new TypeError(a)},Date.prototype.equals=function(a){return 0===this.compareTo(a)},Date.prototype.between=function(a,b){var c=this.getTime();return c>=a.getTime()&&c<=b.getTime()},Date.prototype.addMilliseconds=function(a){return this.setMilliseconds(this.getMilliseconds()+a),this},Date.prototype.addSeconds=function(a){return this.addMilliseconds(1e3*a)},Date.prototype.addMinutes=function(a){return this.addMilliseconds(6e4*a)},Date.prototype.addHours=function(a){return this.addMilliseconds(36e5*a)},Date.prototype.addDays=function(a){return this.addMilliseconds(864e5*a)},Date.prototype.addWeeks=function(a){return this.addMilliseconds(6048e5*a)},Date.prototype.addMonths=function(a){var b=this.getDate();return this.setDate(1),this.setMonth(this.getMonth()+a),this.setDate(Math.min(b,this.getDaysInMonth())),this},Date.prototype.addYears=function(a){return this.addMonths(12*a)},Date.prototype.add=function(a){if("number"==typeof a)return this._orient=a,this;var b=a;return(b.millisecond||b.milliseconds)&&this.addMilliseconds(b.millisecond||b.milliseconds),(b.second||b.seconds)&&this.addSeconds(b.second||b.seconds),(b.minute||b.minutes)&&this.addMinutes(b.minute||b.minutes),(b.hour||b.hours)&&this.addHours(b.hour||b.hours),(b.month||b.months)&&this.addMonths(b.month||b.months),(b.year||b.years)&&this.addYears(b.year||b.years),(b.day||b.days)&&this.addDays(b.day||b.days),this},Date._validate=function(a,b,c,d){if("number"!=typeof a)throw new TypeError(a+" is not a Number.");if(b>a||a>c)throw new RangeError(a+" is not a valid value for "+d+".");return!0},Date.validateMillisecond=function(a){return Date._validate(a,0,999,"milliseconds")},Date.validateSecond=function(a){return Date._validate(a,0,59,"seconds")},Date.validateMinute=function(a){return Date._validate(a,0,59,"minutes")},Date.validateHour=function(a){return Date._validate(a,0,23,"hours")},Date.validateDay=function(a,b,c){return Date._validate(a,1,Date.getDaysInMonth(b,c),"days")},Date.validateMonth=function(a){return Date._validate(a,0,11,"months")},Date.validateYear=function(a){return Date._validate(a,1,9999,"seconds")},Date.prototype.set=function(a){var b=a;return b.millisecond||0===b.millisecond||(b.millisecond=-1),b.second||0===b.second||(b.second=-1),b.minute||0===b.minute||(b.minute=-1),b.hour||0===b.hour||(b.hour=-1),b.day||0===b.day||(b.day=-1),b.month||0===b.month||(b.month=-1),b.year||0===b.year||(b.year=-1),-1!=b.millisecond&&Date.validateMillisecond(b.millisecond)&&this.addMilliseconds(b.millisecond-this.getMilliseconds()),-1!=b.second&&Date.validateSecond(b.second)&&this.addSeconds(b.second-this.getSeconds()),-1!=b.minute&&Date.validateMinute(b.minute)&&this.addMinutes(b.minute-this.getMinutes()),-1!=b.hour&&Date.validateHour(b.hour)&&this.addHours(b.hour-this.getHours()),-1!==b.month&&Date.validateMonth(b.month)&&this.addMonths(b.month-this.getMonth()),-1!=b.year&&Date.validateYear(b.year)&&this.addYears(b.year-this.getFullYear()),-1!=b.day&&Date.validateDay(b.day,this.getFullYear(),this.getMonth())&&this.addDays(b.day-this.getDate()),b.timezone&&this.setTimezone(b.timezone),b.timezoneOffset&&this.setTimezoneOffset(b.timezoneOffset),this},Date.prototype.clearTime=function(){return this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this},Date.prototype.isLeapYear=function(){var a=this.getFullYear();return a%4===0&&a%100!==0||a%400===0},Date.prototype.isWeekday=function(){return!(this.is().sat()||this.is().sun())},Date.prototype.getDaysInMonth=function(){return Date.getDaysInMonth(this.getFullYear(),this.getMonth())},Date.prototype.moveToFirstDayOfMonth=function(){return this.set({day:1})},Date.prototype.moveToLastDayOfMonth=function(){return this.set({day:this.getDaysInMonth()})},Date.prototype.moveToDayOfWeek=function(a,b){var c=(a-this.getDay()+7*(b||1))%7;return this.addDays(0===c?c+=7*(b||1):c)},Date.prototype.moveToMonth=function(a,b){var c=(a-this.getMonth()+12*(b||1))%12;return this.addMonths(0===c?c+=12*(b||1):c)},Date.prototype.getDayOfYear=function(){return Math.floor((this-new Date(this.getFullYear(),0,1))/864e5)},Date.prototype.getWeekOfYear=function(a){var b=this.getFullYear(),c=this.getMonth(),d=this.getDate(),e=a||Date.CultureInfo.firstDayOfWeek,f=8-new Date(b,0,1).getDay();8==f&&(f=1);var g=(Date.UTC(b,c,d,0,0,0)-Date.UTC(b,0,1,0,0,0))/864e5+1,h=Math.floor((g-f+7)/7);if(h===e){b--;var i=8-new Date(b,0,1).getDay();h=2==i||8==i?53:52}return h},Date.prototype.isDST=function(){return"D"==this.toString().match(/(E|C|M|P)(S|D)T/)[2]},Date.prototype.getTimezone=function(){return Date.getTimezoneAbbreviation(this.getUTCOffset,this.isDST())},Date.prototype.setTimezoneOffset=function(a){var b=this.getTimezoneOffset(),c=-6*Number(a)/10;return this.addMinutes(c-b),this},Date.prototype.setTimezone=function(a){return this.setTimezoneOffset(Date.getTimezoneOffset(a))},Date.prototype.getUTCOffset=function(){var a,b=-10*this.getTimezoneOffset()/6;return 0>b?(a=(b-1e4).toString(),a[0]+a.substr(2)):(a=(b+1e4).toString(),"+"+a.substr(1))},Date.prototype.getDayName=function(a){return a?Date.CultureInfo.abbreviatedDayNames[this.getDay()]:Date.CultureInfo.dayNames[this.getDay()]},Date.prototype.getMonthName=function(a){return a?Date.CultureInfo.abbreviatedMonthNames[this.getMonth()]:Date.CultureInfo.monthNames[this.getMonth()]},Date.prototype._toString=Date.prototype.toString,Date.prototype.toString=function(a){var b=this,c=function(a){return 1==a.toString().length?"0"+a:a};return a?a.replace(/dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?/g,function(a){switch(a){case"hh":return c(b.getHours()<13?b.getHours():b.getHours()-12);case"h":return b.getHours()<13?b.getHours():b.getHours()-12;case"HH":return c(b.getHours());case"H":return b.getHours();case"mm":return c(b.getMinutes());case"m":return b.getMinutes();case"ss":return c(b.getSeconds());case"s":return b.getSeconds();case"yyyy":return b.getFullYear();case"yy":return b.getFullYear().toString().substring(2,4);case"dddd":return b.getDayName();case"ddd":return b.getDayName(!0);case"dd":return c(b.getDate());case"d":return b.getDate().toString();case"MMMM":return b.getMonthName();case"MMM":return b.getMonthName(!0);case"MM":return c(b.getMonth()+1);case"M":return b.getMonth()+1;case"t":return b.getHours()<12?Date.CultureInfo.amDesignator.substring(0,1):Date.CultureInfo.pmDesignator.substring(0,1);case"tt":return b.getHours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator;case"zzz":case"zz":case"z":return""}}):this._toString()},Date.now=function(){return new Date},Date.today=function(){return Date.now().clearTime()},Date.prototype._orient=1,Date.prototype.next=function(){return this._orient=1,this},Date.prototype.last=Date.prototype.prev=Date.prototype.previous=function(){return this._orient=-1,this},Date.prototype._is=!1,Date.prototype.is=function(){return this._is=!0,this},Number.prototype._dateElement="day",Number.prototype.fromNow=function(){var a={};return a[this._dateElement]=this,Date.now().add(a)},Number.prototype.ago=function(){var a={};return a[this._dateElement]=-1*this,Date.now().add(a)},function(){for(var a,b=Date.prototype,c=Number.prototype,d="sunday monday tuesday wednesday thursday friday saturday".split(/\s/),e="january february march april may june july august september october november december".split(/\s/),f="Millisecond Second Minute Hour Day Week Month Year".split(/\s/),g=function(a){return function(){return this._is?(this._is=!1,this.getDay()==a):this.moveToDayOfWeek(a,this._orient)}},h=0;h<d.length;h++)b[d[h]]=b[d[h].substring(0,3)]=g(h);for(var i=function(a){return function(){return this._is?(this._is=!1,this.getMonth()===a):this.moveToMonth(a,this._orient)}},j=0;j<e.length;j++)b[e[j]]=b[e[j].substring(0,3)]=i(j);for(var k=function(a){return function(){return"s"!=a.substring(a.length-1)&&(a+="s"),this["add"+a](this._orient)}},l=function(a){return function(){return this._dateElement=a,this}},m=0;m<f.length;m++)a=f[m].toLowerCase(),b[a]=b[a+"s"]=k(f[m]),c[a]=c[a+"s"]=l(a)}(),Date.prototype.toJSONString=function(){return this.toString("yyyy-MM-ddThh:mm:ssZ")},Date.prototype.toShortDateString=function(){return this.toString(Date.CultureInfo.formatPatterns.shortDatePattern)},Date.prototype.toLongDateString=function(){return this.toString(Date.CultureInfo.formatPatterns.longDatePattern)},Date.prototype.toShortTimeString=function(){return this.toString(Date.CultureInfo.formatPatterns.shortTimePattern)},Date.prototype.toLongTimeString=function(){return this.toString(Date.CultureInfo.formatPatterns.longTimePattern)},Date.prototype.getOrdinal=function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},function(){Date.Parsing={Exception:function(a){this.message="Parse error at '"+a.substring(0,10)+" ...'"}};for(var a=Date.Parsing,b=a.Operators={rtoken:function(b){return function(c){var d=c.match(b);if(d)return[d[0],c.substring(d[0].length)];throw new a.Exception(c)}},token:function(a){return function(a){return b.rtoken(new RegExp("^s*"+a+"s*"))(a)}},stoken:function(a){return b.rtoken(new RegExp("^"+a))},until:function(a){return function(b){for(var c=[],d=null;b.length;){try{d=a.call(this,b)}catch(e){c.push(d[0]),b=d[1];continue}break}return[c,b]}},many:function(a){return function(b){for(var c=[],d=null;b.length;){try{d=a.call(this,b)}catch(e){return[c,b]}c.push(d[0]),b=d[1]}return[c,b]}},optional:function(a){return function(b){var c=null;try{c=a.call(this,b)}catch(d){return[null,b]}return[c[0],c[1]]}},not:function(b){return function(c){try{b.call(this,c)}catch(d){return[null,c]}throw new a.Exception(c)}},ignore:function(a){return a?function(b){var c=null;return c=a.call(this,b),[null,c[1]]}:null},product:function(){for(var a=arguments[0],c=Array.prototype.slice.call(arguments,1),d=[],e=0;e<a.length;e++)d.push(b.each(a[e],c));return d},cache:function(b){var c={},d=null;return function(e){try{d=c[e]=c[e]||b.call(this,e)}catch(f){d=c[e]=f}if(d instanceof a.Exception)throw d;return d}},any:function(){var b=arguments;return function(c){for(var d=null,e=0;e<b.length;e++)if(null!=b[e]){try{d=b[e].call(this,c)}catch(f){d=null}if(d)return d}throw new a.Exception(c)}},each:function(){var b=arguments;return function(c){for(var d=[],e=null,f=0;f<b.length;f++)if(null!=b[f]){try{e=b[f].call(this,c)}catch(g){throw new a.Exception(c)}d.push(e[0]),c=e[1]}return[d,c]}},all:function(){var a=arguments,b=b;return b.each(b.optional(a))},sequence:function(c,d,e){return d=d||b.rtoken(/^\s*/),e=e||null,1==c.length?c[0]:function(b){for(var f=null,g=null,h=[],i=0;i<c.length;i++){try{f=c[i].call(this,b)}catch(j){break}h.push(f[0]);try{g=d.call(this,f[1])}catch(k){g=null;break}b=g[1]}if(!f)throw new a.Exception(b);if(g)throw new a.Exception(g[1]);if(e)try{f=e.call(this,f[1])}catch(l){throw new a.Exception(f[1])}return[h,f?f[1]:b]}},between:function(a,c,d){d=d||a;var e=b.each(b.ignore(a),c,b.ignore(d));return function(a){var b=e.call(this,a);return[[b[0][0],r[0][2]],b[1]]}},list:function(a,c,d){return c=c||b.rtoken(/^\s*/),d=d||null,a instanceof Array?b.each(b.product(a.slice(0,-1),b.ignore(c)),a.slice(-1),b.ignore(d)):b.each(b.many(b.each(a,b.ignore(c))),px,b.ignore(d))},set:function(c,d,e){return d=d||b.rtoken(/^\s*/),e=e||null,function(f){for(var g=null,h=null,i=null,j=null,k=[[],f],l=!1,m=0;m<c.length;m++){i=null,h=null,g=null,l=1==c.length;try{g=c[m].call(this,f)}catch(n){continue}if(j=[[g[0]],g[1]],g[1].length>0&&!l)try{i=d.call(this,g[1])}catch(o){l=!0}else l=!0;if(l||0!==i[1].length||(l=!0),!l){for(var p=[],q=0;q<c.length;q++)m!=q&&p.push(c[q]);h=b.set(p,d).call(this,i[1]),h[0].length>0&&(j[0]=j[0].concat(h[0]),j[1]=h[1])}if(j[1].length<k[1].length&&(k=j),0===k[1].length)break}if(0===k[0].length)return k;if(e){try{i=e.call(this,k[1])}catch(r){throw new a.Exception(k[1])}k[1]=i[1]}return k}},forward:function(a,b){return function(c){return a[b].call(this,c)}},replace:function(a,b){return function(c){var d=a.call(this,c);return[b,d[1]]}},process:function(a,b){return function(c){var d=a.call(this,c);return[b.call(this,d[0]),d[1]]}},min:function(b,c){return function(d){var e=c.call(this,d);if(e[0].length<b)throw new a.Exception(d);return e}}},c=function(a){return function(){var b=null,c=[];if(arguments.length>1?b=Array.prototype.slice.call(arguments):arguments[0]instanceof Array&&(b=arguments[0]),!b)return a.apply(null,arguments);for(var d=0,e=b.shift();d<e.length;d++)return b.unshift(e[d]),c.push(a.apply(null,b)),b.shift(),c}},d="optional not ignore cache".split(/\s/),e=0;e<d.length;e++)b[d[e]]=c(b[d[e]]);for(var f=function(a){return function(){return arguments[0]instanceof Array?a.apply(null,arguments[0]):a.apply(null,arguments)}},g="each any all".split(/\s/),h=0;h<g.length;h++)b[g[h]]=f(b[g[h]])}(),function(){var a=function(b){for(var c=[],d=0;d<b.length;d++)b[d]instanceof Array?c=c.concat(a(b[d])):b[d]&&c.push(b[d]);return c};Date.Grammar={},Date.Translator={hour:function(a){return function(){this.hour=Number(a)}},minute:function(a){return function(){this.minute=Number(a)}},second:function(a){return function(){this.second=Number(a)}},meridian:function(a){return function(){this.meridian=a.slice(0,1).toLowerCase()}},timezone:function(a){return function(){var b=a.replace(/[^\d\+\-]/g,"");b.length?this.timezoneOffset=Number(b):this.timezone=a.toLowerCase()}},day:function(a){var b=a[0];return function(){this.day=Number(b.match(/\d+/)[0])}},month:function(a){return function(){this.month=3==a.length?Date.getMonthNumberFromName(a):Number(a)-1}},year:function(a){return function(){var b=Number(a);this.year=a.length>2?b:b+(b+2e3<Date.CultureInfo.twoDigitYearMax?2e3:1900)}},rday:function(a){return function(){switch(a){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0,this.now=!0}}},finishExact:function(a){a=a instanceof Array?a:[a];var b=new Date;this.year=b.getFullYear(),this.month=b.getMonth(),this.day=1,this.hour=0,this.minute=0,this.second=0;for(var c=0;c<a.length;c++)a[c]&&a[c].call(this);if(this.hour="p"==this.meridian&&this.hour<13?this.hour+12:this.hour,this.day>Date.getDaysInMonth(this.year,this.month))throw new RangeError(this.day+" is not a valid value for days.");var d=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);return this.timezone?d.set({timezone:this.timezone}):this.timezoneOffset&&d.set({timezoneOffset:this.timezoneOffset}),d},finish:function(b){if(b=b instanceof Array?a(b):[b],0===b.length)return null;for(var c=0;c<b.length;c++)"function"==typeof b[c]&&b[c].call(this);if(this.now)return new Date;var d=Date.today(),e=!(null==this.days&&!this.orient&&!this.operator);if(e){var f,g,h;return h="past"==this.orient||"subtract"==this.operator?-1:1,this.weekday&&(this.unit="day",f=Date.getDayNumberFromName(this.weekday)-d.getDay(),g=7,this.days=f?(f+h*g)%g:h*g),this.month&&(this.unit="month",f=this.month-d.getMonth(),g=12,this.months=f?(f+h*g)%g:h*g,this.month=null),this.unit||(this.unit="day"),(null==this[this.unit+"s"]||null!=this.operator)&&(this.value||(this.value=1),"week"==this.unit&&(this.unit="day",this.value=7*this.value),this[this.unit+"s"]=this.value*h),d.add(this)}return this.meridian&&this.hour&&(this.hour=this.hour<13&&"p"==this.meridian?this.hour+12:this.hour),this.weekday&&!this.day&&(this.day=d.addDays(Date.getDayNumberFromName(this.weekday)-d.getDay()).getDate()),this.month&&!this.day&&(this.day=1),d.set(this)}};var b,c=Date.Parsing.Operators,d=Date.Grammar,e=Date.Translator;d.datePartDelimiter=c.rtoken(/^([\s\-\.\,\/\x27]+)/),d.timePartDelimiter=c.stoken(":"),d.whiteSpace=c.rtoken(/^\s*/),d.generalDelimiter=c.rtoken(/^(([\s\,]|at|on)+)/);var f={};d.ctoken=function(a){var b=f[a];if(!b){for(var d=Date.CultureInfo.regexPatterns,e=a.split(/\s+/),g=[],h=0;h<e.length;h++)g.push(c.replace(c.rtoken(d[e[h]]),e[h]));b=f[a]=c.any.apply(null,g)}return b},d.ctoken2=function(a){return c.rtoken(Date.CultureInfo.regexPatterns[a])},d.h=c.cache(c.process(c.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),e.hour)),d.hh=c.cache(c.process(c.rtoken(/^(0[0-9]|1[0-2])/),e.hour)),d.H=c.cache(c.process(c.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),e.hour)),d.HH=c.cache(c.process(c.rtoken(/^([0-1][0-9]|2[0-3])/),e.hour)),d.m=c.cache(c.process(c.rtoken(/^([0-5][0-9]|[0-9])/),e.minute)),d.mm=c.cache(c.process(c.rtoken(/^[0-5][0-9]/),e.minute)),d.s=c.cache(c.process(c.rtoken(/^([0-5][0-9]|[0-9])/),e.second)),d.ss=c.cache(c.process(c.rtoken(/^[0-5][0-9]/),e.second)),d.hms=c.cache(c.sequence([d.H,d.mm,d.ss],d.timePartDelimiter)),d.t=c.cache(c.process(d.ctoken2("shortMeridian"),e.meridian)),d.tt=c.cache(c.process(d.ctoken2("longMeridian"),e.meridian)),d.z=c.cache(c.process(c.rtoken(/^(\+|\-)?\s*\d\d\d\d?/),e.timezone)),d.zz=c.cache(c.process(c.rtoken(/^(\+|\-)\s*\d\d\d\d/),e.timezone)),d.zzz=c.cache(c.process(d.ctoken2("timezone"),e.timezone)),d.timeSuffix=c.each(c.ignore(d.whiteSpace),c.set([d.tt,d.zzz])),d.time=c.each(c.optional(c.ignore(c.stoken("T"))),d.hms,d.timeSuffix),d.d=c.cache(c.process(c.each(c.rtoken(/^([0-2]\d|3[0-1]|\d)/),c.optional(d.ctoken2("ordinalSuffix"))),e.day)),d.dd=c.cache(c.process(c.each(c.rtoken(/^([0-2]\d|3[0-1])/),c.optional(d.ctoken2("ordinalSuffix"))),e.day)),d.ddd=d.dddd=c.cache(c.process(d.ctoken("sun mon tue wed thu fri sat"),function(a){return function(){this.weekday=a}})),d.M=c.cache(c.process(c.rtoken(/^(1[0-2]|0\d|\d)/),e.month)),d.MM=c.cache(c.process(c.rtoken(/^(1[0-2]|0\d)/),e.month)),d.MMM=d.MMMM=c.cache(c.process(d.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),e.month)),d.y=c.cache(c.process(c.rtoken(/^(\d\d?)/),e.year)),d.yy=c.cache(c.process(c.rtoken(/^(\d\d)/),e.year)),d.yyy=c.cache(c.process(c.rtoken(/^(\d\d?\d?\d?)/),e.year)),d.yyyy=c.cache(c.process(c.rtoken(/^(\d\d\d\d)/),e.year)),b=function(){return c.each(c.any.apply(null,arguments),c.not(d.ctoken2("timeContext")))},d.day=b(d.d,d.dd),d.month=b(d.M,d.MMM),d.year=b(d.yyyy,d.yy),d.orientation=c.process(d.ctoken("past future"),function(a){return function(){this.orient=a}}),d.operator=c.process(d.ctoken("add subtract"),function(a){return function(){this.operator=a}}),d.rday=c.process(d.ctoken("yesterday tomorrow today now"),e.rday),d.unit=c.process(d.ctoken("minute hour day week month year"),function(a){return function(){this.unit=a}}),d.value=c.process(c.rtoken(/^\d\d?(st|nd|rd|th)?/),function(a){return function(){this.value=a.replace(/\D/g,"")}}),d.expression=c.set([d.rday,d.operator,d.value,d.unit,d.orientation,d.ddd,d.MMM]),b=function(){return c.set(arguments,d.datePartDelimiter)},d.mdy=b(d.ddd,d.month,d.day,d.year),d.ymd=b(d.ddd,d.year,d.month,d.day),d.dmy=b(d.ddd,d.day,d.month,d.year),d.date=function(a){return(d[Date.CultureInfo.dateElementOrder]||d.mdy).call(this,a)},d.format=c.process(c.many(c.any(c.process(c.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(a){if(d[a])return d[a];throw Date.Parsing.Exception(a)}),c.process(c.rtoken(/^[^dMyhHmstz]+/),function(a){return c.ignore(c.stoken(a))}))),function(a){return c.process(c.each.apply(null,a),e.finishExact)});var g={},h=function(a){return g[a]=g[a]||d.format(a)[0]};d.formats=function(a){if(a instanceof Array){for(var b=[],d=0;d<a.length;d++)b.push(h(a[d]));return c.any.apply(null,b)}return h(a)},d._formats=d.formats(["yyyy-MM-ddTHH:mm:ss","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","d"]),d._start=c.process(c.set([d.date,d.time,d.expression],d.generalDelimiter,d.whiteSpace),e.finish),d.start=function(a){try{var b=d._formats.call({},a);if(0===b[1].length)return b}catch(c){}return d._start.call({},a)}}(),Date._parse=Date.parse,Date.parse=function(a){var b=null;if(!a)return null;try{b=Date.Grammar.start.call({},a)}catch(c){return null}return 0===b[1].length?b[0]:null},Date.getParseFunction=function(a){var b=Date.Grammar.formats(a);return function(a){var c=null;try{c=b.call({},a)}catch(d){return null}return 0===c[1].length?c[0]:null}},Date.parseExact=function(a,b){return Date.getParseFunction(b)(a)};var TimeSpan=function(a,b,c,d,e){for(var f="days hours minutes seconds milliseconds".split(/\s+/),g=function(a){return function(){return this[a]}},h=function(a){return function(b){return this[a]=b,this}},i=0;i<f.length;i++){var j=f[i],k=j.slice(0,1).toUpperCase()+j.slice(1);TimeSpan.prototype[j]=0,TimeSpan.prototype["get"+k]=g(j),TimeSpan.prototype["set"+k]=h(j)}if(4==arguments.length)this.setDays(a),this.setHours(b),this.setMinutes(c),this.setSeconds(d);else if(5==arguments.length)this.setDays(a),this.setHours(b),this.setMinutes(c),this.setSeconds(d),this.setMilliseconds(e);else if(1==arguments.length&&"number"==typeof a){var l=0>a?-1:1;this.setMilliseconds(Math.abs(a)),this.setDays(Math.floor(this.getMilliseconds()/864e5)*l),this.setMilliseconds(this.getMilliseconds()%864e5),this.setHours(Math.floor(this.getMilliseconds()/36e5)*l),this.setMilliseconds(this.getMilliseconds()%36e5),this.setMinutes(Math.floor(this.getMilliseconds()/6e4)*l),this.setMilliseconds(this.getMilliseconds()%6e4),this.setSeconds(Math.floor(this.getMilliseconds()/1e3)*l),this.setMilliseconds(this.getMilliseconds()%1e3),this.setMilliseconds(this.getMilliseconds()*l)}return this.getTotalMilliseconds=function(){return 864e5*this.getDays()+36e5*this.getHours()+6e4*this.getMinutes()+1e3*this.getSeconds()},this.compareTo=function(a){var b,c=new Date(1970,1,1,this.getHours(),this.getMinutes(),this.getSeconds());return b=null===a?new Date(1970,1,1,0,0,0):new Date(1970,1,1,a.getHours(),a.getMinutes(),a.getSeconds()),b>c?-1:c>b?1:0},this.equals=function(a){return 0===this.compareTo(a)},this.add=function(a){return null===a?this:this.addSeconds(a.getTotalMilliseconds()/1e3)},this.subtract=function(a){return null===a?this:this.addSeconds(-a.getTotalMilliseconds()/1e3)},this.addDays=function(a){return new TimeSpan(this.getTotalMilliseconds()+864e5*a)},this.addHours=function(a){return new TimeSpan(this.getTotalMilliseconds()+36e5*a)},this.addMinutes=function(a){return new TimeSpan(this.getTotalMilliseconds()+6e4*a)},this.addSeconds=function(a){return new TimeSpan(this.getTotalMilliseconds()+1e3*a)},this.addMilliseconds=function(a){return new TimeSpan(this.getTotalMilliseconds()+a)},this.get12HourHour=function(){return this.getHours()>12?this.getHours()-12:0===this.getHours()?12:this.getHours()},this.getDesignator=function(){return this.getHours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator},this.toString=function(a){this._toString=function(){return null!==this.getDays()&&this.getDays()>0?this.getDays()+"."+this.getHours()+":"+this.p(this.getMinutes())+":"+this.p(this.getSeconds()):this.getHours()+":"+this.p(this.getMinutes())+":"+this.p(this.getSeconds())},this.p=function(a){return a.toString().length<2?"0"+a:a};var b=this;return a?a.replace(/dd?|HH?|hh?|mm?|ss?|tt?/g,function(a){switch(a){case"d":return b.getDays();case"dd":return b.p(b.getDays());case"H":return b.getHours();case"HH":return b.p(b.getHours());case"h":return b.get12HourHour();case"hh":return b.p(b.get12HourHour());case"m":return b.getMinutes();case"mm":return b.p(b.getMinutes());case"s":return b.getSeconds();case"ss":return b.p(b.getSeconds());case"t":return(b.getHours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator).substring(0,1);case"tt":return b.getHours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator}}):this._toString()},this};Date.prototype.getTimeOfDay=function(){return new TimeSpan(0,this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())};var TimePeriod=function(a,b,c,d,e,f,g){for(var h="years months days hours minutes seconds milliseconds".split(/\s+/),i=function(a){return function(){return this[a]}},j=function(a){return function(b){return this[a]=b,this}},k=0;k<h.length;k++){var l=h[k],m=l.slice(0,1).toUpperCase()+l.slice(1);
TimePeriod.prototype[l]=0,TimePeriod.prototype["get"+m]=i(l),TimePeriod.prototype["set"+m]=j(l)}if(7==arguments.length)this.years=a,this.months=b,this.setDays(c),this.setHours(d),this.setMinutes(e),this.setSeconds(f),this.setMilliseconds(g);else if(2==arguments.length&&arguments[0]instanceof Date&&arguments[1]instanceof Date){var n=a.clone(),o=b.clone(),p=n.clone(),q=n>o?-1:1;if(this.years=o.getFullYear()-n.getFullYear(),p.addYears(this.years),1==q?p>o&&0!==this.years&&this.years--:o>p&&0!==this.years&&this.years++,n.addYears(this.years),1==q)for(;o>n&&n.clone().addDays(Date.getDaysInMonth(n.getYear(),n.getMonth()))<o;)n.addMonths(1),this.months++;else for(;n>o&&n.clone().addDays(-n.getDaysInMonth())>o;)n.addMonths(-1),this.months--;var r=o-n;if(0!==r){var s=new TimeSpan(r);this.setDays(s.getDays()),this.setHours(s.getHours()),this.setMinutes(s.getMinutes()),this.setSeconds(s.getSeconds()),this.setMilliseconds(s.getMilliseconds())}}return this};/*! 
* evol.colorpicker - v3.2.0
* https://github.com/evoluteur/colorpicker
* Copyright (c) 2015 - Olivier Giulieri; Licensed MIT licence */
!function(a,b){var c=0,d=window.navigator.userAgent,e=d.indexOf("MSIE ")>0,f=e?'-ie':'',g=e?!1:/mozilla/.test(d.toLowerCase())&&!/webkit/.test(d.toLowerCase()),h=[],i=['ffffff','000000','eeece1','1f497d','4f81bd','c0504d','9bbb59','8064a2','4bacc6','f79646'],j=['f2f2f2','7f7f7f','ddd9c3','c6d9f0','dbe5f1','f2dcdb','ebf1dd','e5e0ec','dbeef3','fdeada','d8d8d8','595959','c4bd97','8db3e2','b8cce4','e5b9b7','d7e3bc','ccc1d9','b7dde8','fbd5b5','bfbfbf','3f3f3f','938953','548dd4','95b3d7','d99694','c3d69b','b2a2c7','92cddc','fac08f','a5a5a5','262626','494429','17365d','366092','953734','76923c','5f497a','31859b','e36c09','7f7f7f','0c0c0c','1d1b10','0f243e','244061','632423','4f6128','3f3151','205867','974806'],k=['c00000','ff0000','ffc000','ffff00','92d050','00b050','00b0f0','0070c0','002060','7030a0'],l=[['003366','336699','3366cc','003399','000099','0000cc','000066'],['006666','006699','0099cc','0066cc','0033cc','0000ff','3333ff','333399'],['669999','009999','33cccc','00ccff','0099ff','0066ff','3366ff','3333cc','666699'],['339966','00cc99','00ffcc','00ffff','33ccff','3399ff','6699ff','6666ff','6600ff','6600cc'],['339933','00cc66','00ff99','66ffcc','66ffff','66ccff','99ccff','9999ff','9966ff','9933ff','9900ff'],['006600','00cc00','00ff00','66ff99','99ffcc','ccffff','ccccff','cc99ff','cc66ff','cc33ff','cc00ff','9900cc'],['003300','009933','33cc33','66ff66','99ff99','ccffcc','ffffff','ffccff','ff99ff','ff66ff','ff00ff','cc00cc','660066'],['333300','009900','66ff33','99ff66','ccff99','ffffcc','ffcccc','ff99cc','ff66cc','ff33cc','cc0099','993399'],['336600','669900','99ff33','ccff66','ffff99','ffcc99','ff9999','ff6699','ff3399','cc3399','990099'],['666633','99cc00','ccff33','ffff66','ffcc66','ff9966','ff6666','ff0066','d60094','993366'],['a58800','cccc00','ffff00','ffcc00','ff9933','ff6600','ff0033','cc0066','660033'],['996633','cc9900','ff9900','cc6600','ff3300','ff0000','cc0000','990033'],['663300','996600','cc3300','993300','990000','800000','993333']],m='#0000ffff',n=function(a){var b=a.toString(16);return 1==b.length&&(b='0'+b),b},o=function(a){return n(Number(a))},p=function(a){var b=n(a);return b+b+b},q=function(a){if(a.length>10){var b=1+a.indexOf('('),c=a.indexOf(')'),d=a.substring(b,c).split(',');return['#',o(d[0]),o(d[1]),o(d[2])].join('')}return a};a.widget("evol.colorpicker",{version:'3.2.0',options:{color:null,showOn:'both',hideButton:!1,displayIndicator:!0,transparentColor:!1,history:!0,defaultPalette:'theme',strings:'Theme Colors,Standard Colors,Web Colors,Theme Colors,Back to Palette,History,No history yet.'},_create:function(){var b=this;switch(this._paletteIdx='theme'==this.options.defaultPalette?1:2,this._id='evo-cp'+c++,this._enabled=!0,this.options.showOn=this.options.hideButton?'focus':this.options.showOn,this.element.get(0).tagName){case'INPUT':var d=this.options.color,h=this.element,i=('focus'===this.options.showOn?'':'evo-pointer ')+'evo-colorind'+(g?'-ff':f)+(this.options.hideButton?' evo-hidden-button':''),j='';if(this._isPopup=!0,this._palette=null,null!==d)h.val(d);else{var k=h.val();''!==k&&(d=this.options.color=k)}d===m?i+=' evo-transparent':j=null!==d?'background-color:'+d:'',h.addClass('colorPicker '+this._id).wrap('<div style="width:'+(this.options.hideButton?this.element.width():this.element.width()+32)+'px;'+(e?'margin-bottom:-21px;':'')+(g?'padding:1px 0;':'')+'"></div>').after('<div class="'+i+'" style="'+j+'"></div>').on('keyup onpaste',function(c){var d=a(this).val();d!=b.options.color&&b._setValue(d,!0)});var l=this.options.showOn;('both'===l||'focus'===l)&&h.on('focus',function(){b.showPalette()}),('both'===l||'button'===l)&&h.next().on('click',function(a){a.stopPropagation(),b.showPalette()});break;default:this._isPopup=!1,this._palette=this.element.html(this._paletteHTML()).attr('aria-haspopup','true'),this._bindColors()}d&&this.options.history&&this._add2History(d)},_paletteHTML:function(){var a=this._paletteIdx=Math.abs(this._paletteIdx),b=this.options,c=b.strings.split(','),d='<div class="evo-pop'+f+' ui-widget ui-widget-content ui-corner-all"'+(this._isPopup?' style="position:absolute"':'')+"><span>"+this['_paletteHTML'+a]()+"</span><div class=\"evo-more\"><a href=\"javascript:void(0)\">"+c[1+a]+'</a>';return b.history&&(d+='<a href="javascript:void(0)" class="evo-hist">'+c[5]+'</a>'),d+='</div>',b.displayIndicator&&(d+=this._colorIndHTML(this.options.color)+this._colorIndHTML('')),d+='</div>'},_colorIndHTML:function(a){var b=e?'evo-colorbox-ie ':'',c='';return a?a===m?b+='evo-transparent':c='background-color:'+a:c='display:none',"<div class=\"evo-color\" style=\"float:left\"><div style=\""+c+'" class="'+b+'"></div><span>'+(a?a:'')+'</span></div>'},_paletteHTML1:function(){for(var a=this.options,b=a.strings.split(','),c='<td style="background-color:#',d=e?'"><div style="width:2px;"></div></td>':'"><span/></td>',g='<tr><th colspan="10" class="ui-widget-content">',h='<table class="evo-palette'+f+'">'+g+b[0]+'</th></tr><tr>',l=0;10>l;l++)h+=c+i[l]+d;for(h+='</tr>',e||(h+='<tr><th colspan="10"></th></tr>'),h+='<tr class="top">',l=0;10>l;l++)h+=c+j[l]+d;for(var m=1;4>m;m++)for(h+='</tr><tr class="in">',l=0;10>l;l++)h+=c+j[10*m+l]+d;for(h+='</tr><tr class="bottom">',l=40;50>l;l++)h+=c+j[l]+d;for(h+='</tr>'+g,a.transparentColor&&(h+='<div class="evo-transparent evo-tr-box"></div>'),h+=b[1]+'</th></tr><tr>',l=0;10>l;l++)h+=c+k[l]+d;return h+='</tr></table>'},_paletteHTML2:function(){for(var a,b,c='<td style="background-color:#',d=e?'"><div style="width:5px;"></div></td>':'"><span/></td>',g='<table class="evo-palette2'+f+'"><tr>',h='</tr></table>',i='<div class="evo-palcenter">',j=0,k=l.length;k>j;j++){i+=g;var m=l[j];for(a=0,b=m.length;b>a;a++)i+=c+m[a]+d;i+=h}i+='<div class="evo-sep"/>';var n='';for(i+=g,a=255;a>10;a-=10)i+=c+p(a)+d,a-=10,n+=c+p(a)+d;return i+=h+g+n+h+'</div>'},_switchPalette:function(b){if(this._enabled){var c,d,e,f=this.options.strings.split(',');if(a(b).hasClass('evo-hist')){var g=['<table class="evo-palette"><tr><th class="ui-widget-content">',f[5],'</th></tr></tr></table>','<div class="evo-cHist">'];if(0===h.length)g.push('<p>&nbsp;',f[6],'</p>');else for(var i=h.length-1;i>-1;i--)9===h[i].length?g.push('<div class="evo-transparent"></div>'):g.push('<div style="background-color:',h[i],'"></div>');g.push('</div>'),c=-this._paletteIdx,d=g.join(''),e=f[4]}else this._paletteIdx<0?(c=-this._paletteIdx,this._palette.find('.evo-hist').show()):c=2==this._paletteIdx?1:2,d=this['_paletteHTML'+c](),e=f[c+1],this._paletteIdx=c;this._paletteIdx=c;var j=this._palette.find('.evo-more').prev().html(d).end().children().eq(0).html(e);0>c&&j.next().hide()}},showPalette:function(){if(this._enabled&&(a('.colorPicker').not('.'+this._id).colorpicker('hidePalette'),null===this._palette)){this._palette=this.element.next().after(this._paletteHTML()).next().on('click',function(a){a.stopPropagation()}),this._bindColors();var b=this;this._isPopup&&a(document.body).on('click.'+b._id,function(a){a.target!=b.element.get(0)&&b.hidePalette()}).on('keyup.'+b._id,function(a){27===a.keyCode&&b.hidePalette()})}return this},hidePalette:function(){if(this._isPopup&&this._palette){a(document.body).off('click.'+this._id);var b=this;this._palette.off('mouseover click','td,.evo-transparent').fadeOut(function(){b._palette.remove(),b._palette=b._cTxt=null}).find('.evo-more a').off('click')}return this},_bindColors:function(){var b=this,c=this.options,d=this._palette.find('div.evo-color'),e=c.history?'td,.evo-cHist>div':'td';c.transparentColor&&(e+=',.evo-transparent'),this._cTxt1=d.eq(0).children().eq(0),this._cTxt2=d.eq(1).children().eq(0),this._palette.on('click',e,function(c){if(b._enabled){var d=a(this);b._setValue(d.hasClass('evo-transparent')?m:q(d.attr('style').substring(17)))}}).on('mouseover',e,function(c){if(b._enabled){var d=a(this),e=d.hasClass('evo-transparent')?m:q(d.attr('style').substring(17));b.options.displayIndicator&&b._setColorInd(e,2),b.element.trigger('mouseover.color',e)}}).find('.evo-more a').on('click',function(){b._switchPalette(this)})},val:function(a){return'undefined'==typeof a?this.options.color:(this._setValue(a),this)},_setValue:function(a,b){a=a.replace(/ /g,''),this.options.color=a,this._isPopup?(b||this.hidePalette(),this._setBoxColor(this.element.val(a).next(),a)):this._setColorInd(a,1),this.options.history&&this._paletteIdx>0&&this._add2History(a),this.element.trigger('change.color',a)},_setColorInd:function(a,b){var c=this['_cTxt'+b];this._setBoxColor(c,a),c.next().html(a)},_setBoxColor:function(a,b){b===m?a.addClass('evo-transparent').removeAttr('style'):a.removeClass('evo-transparent').attr('style','background-color:'+b)},_setOption:function(a,b){'color'==a?this._setValue(b,!0):this.options[a]=b},_add2History:function(a){for(var b=h.length,c=0;b>c;c++)if(a==h[c])return;b>27&&h.shift(),h.push(a)},enable:function(){var a=this.element;return this._isPopup?a.removeAttr('disabled'):a.css({opacity:'1','pointer-events':'auto'}),'focus'!==this.options.showOn&&this.element.next().addClass('evo-pointer'),a.removeAttr('aria-disabled'),this._enabled=!0,this},disable:function(){var a=this.element;return this._isPopup?a.attr('disabled','disabled'):(this.hidePalette(),a.css({opacity:'0.3','pointer-events':'none'})),'focus'!==this.options.showOn&&this.element.next().removeClass('evo-pointer'),a.attr('aria-disabled','true'),this._enabled=!1,this},isDisabled:function(){return!this._enabled},destroy:function(){a(document.body).off('click.'+this._id),this._palette&&(this._palette.off('mouseover click','td,.evo-cHist>div,.evo-transparent').find('.evo-more a').off('click'),this._isPopup&&this._palette.remove(),this._palette=this._cTxt=null),this._isPopup&&this.element.next().off('click').remove().end().off('focus').unwrap(),this.element.removeClass('colorPicker '+this.id).empty(),a.Widget.prototype.destroy.call(this)}})}(jQuery),/*! 
* Date range picker - v2.3.17
* http://www.filamentgroup.com/examples/daterangepicker/
* Copyright (c) 2010 - Filament Group (Scott Jehl); Licensed MIT, GPL licenses */
function(a){a.fn.daterangepicker=function(b){function c(b){if(null==b||!b.getDate())return'';var c=(b.getDate(),b.getMonth());b.getFullYear();c++;var d=j.dateFormat;return a.datepicker.formatDate(d,b)}function d(){'closed'==p.data('state')&&(g(),p.fadeIn(300).data('state','open'),j.onOpen())}function e(){'open'==p.data('state')&&(p.fadeOut(300).data('state','closed'),j.onClose())}function f(){'open'==p.data('state')?e():d()}function g(){var b=u||i,c=b.offset(),d='left',e=c.left,f=a(window).width()-e-b.outerWidth();e>f&&(d='right',e=f),p.parent().css(d,e).css('top',c.top+b.outerHeight())}function h(a,b,c,d){if(a.is('.ui-daterangepicker-specificDate'))d.hide(),c.show(),b.find('.title-start').text(j.presets.specificDate),b.find('.range-start').restoreDateFromData().css('opacity',1).show(400),b.find('.range-end').restoreDateFromData().css('opacity',0).hide(400),setTimeout(function(){d.fadeIn()},400);else if(a.is('.ui-daterangepicker-allDatesBefore'))d.hide(),c.show(),b.find('.title-end').text(j.presets.allDatesBefore),b.find('.range-start').saveDateToData().datepicker('setDate',j.earliestDate).css('opacity',0).hide(400),b.find('.range-end').restoreDateFromData().css('opacity',1).show(400),setTimeout(function(){d.fadeIn()},400);else if(a.is('.ui-daterangepicker-allDatesAfter'))d.hide(),c.show(),b.find('.title-start').text(j.presets.allDatesAfter),b.find('.range-start').restoreDateFromData().css('opacity',1).show(400),b.find('.range-end').saveDateToData().datepicker('setDate',j.latestDate).css('opacity',0).hide(400),setTimeout(function(){d.fadeIn()},400);else if(a.is('.ui-daterangepicker-dateRange'))d.hide(),c.show(),b.find('.title-start').text(j.rangeStartTitle),b.find('.title-end').text(j.rangeEndTitle),b.find('.range-start').restoreDateFromData().css('opacity',1).show(400),b.find('.range-end').restoreDateFromData().css('opacity',1).show(400),setTimeout(function(){d.fadeIn()},400);else{d.hide(),b.find('.range-start, .range-end').css('opacity',0).hide(400,function(){c.hide()});var e='string'==typeof a.data('dateStart')?Date.parse(a.data('dateStart')):a.data('dateStart')(),f='string'==typeof a.data('dateEnd')?Date.parse(a.data('dateEnd')):a.data('dateEnd')();b.find('.range-start').datepicker('setDate',e).find('.ui-datepicker-current-day').trigger('click'),b.find('.range-end').datepicker('setDate',f).find('.ui-datepicker-current-day').trigger('click')}return!1}var i=a(this),j=a.extend({presetRanges:[{text:'Today',dateStart:'today',dateEnd:'today'},{text:'Last 7 days',dateStart:'today-7days',dateEnd:'today'},{text:'Month to date',dateStart:function(){return Date.parse('today').moveToFirstDayOfMonth()},dateEnd:'today'},{text:'Year to date',dateStart:function(){var a=Date.parse('today');return a.setMonth(0),a.setDate(1),a},dateEnd:'today'},{text:'The previous Month',dateStart:function(){return Date.parse('1 month ago').moveToFirstDayOfMonth()},dateEnd:function(){return Date.parse('1 month ago').moveToLastDayOfMonth()}}],presets:{specificDate:'Specific Date',allDatesBefore:'All Dates Before',allDatesAfter:'All Dates After',dateRange:'Date Range'},rangeStartTitle:'Start date',rangeEndTitle:'End date',nextLinkText:'Next',prevLinkText:'Prev',target:i,doneButtonText:'Done',earliestDate:Date.parse('-15years'),latestDate:Date.parse('+15years'),constrainDates:!1,rangeSplitter:'-',dateFormat:'m/d/yy',closeOnSelect:!0,arrows:!1,appendTo:'body',onClose:function(){},onOpen:function(){},onChange:function(){},datepickerOptions:null},b),k={onSelect:function(b,d){var f=p.find('.range-start'),g=p.find('.range-end');p.find('.ui-daterangepicker-specificDate').is('.ui-state-active')&&g.datepicker('setDate',f.datepicker('getDate')),a(this).trigger('constrainOtherPicker');var h=c(f.datepicker('getDate')),k=c(g.datepicker('getDate'));2==i.length?(i.eq(0).val(h),i.eq(1).val(k)):i.val(h!=k?h+' '+j.rangeSplitter+' '+k:h),j.closeOnSelect&&(p.find('li.ui-state-active').is('.ui-daterangepicker-dateRange')||p.is(':animated')||e(),a(this).trigger('constrainOtherPicker'),j.onChange())},defaultDate:0};i.bind('change',j.onChange),j.datepickerOptions=b?a.extend(k,b.datepickerOptions):k;var l,m,n,o=Date.parse('today');2==i.size()?(m=Date.parse(i.eq(0).val()),n=Date.parse(i.eq(1).val()),null==m&&(m=n),null==n&&(n=m)):(m=Date.parse(i.val().split(j.rangeSplitter)[0]),n=Date.parse(i.val().split(j.rangeSplitter)[1]),null==n&&(n=m)),null!=m&&(l=m),null!=n&&(o=n);var p=a('<div class="ui-daterangepicker ui-widget ui-helper-clearfix ui-widget-content ui-corner-all"></div>');(function(){var b=a('<ul class="ui-widget-content"></ul>').appendTo(p);a.each(j.presetRanges,function(){a('<li class="ui-daterangepicker-'+this.text.replace(/ /g,'')+' ui-corner-all"><a href="#">'+this.text+'</a></li>').data('dateStart',this.dateStart).data('dateEnd',this.dateEnd).appendTo(b)});var c=0;return a.each(j.presets,function(d,e){a('<li class="ui-daterangepicker-'+d+' preset_'+c+' ui-helper-clearfix ui-corner-all"><span class="ui-icon ui-icon-triangle-1-e"></span><a href="#">'+e+'</a></li>').appendTo(b),c++}),b.find('li').hover(function(){a(this).addClass('ui-state-hover')},function(){a(this).removeClass('ui-state-hover')}).click(function(){return p.find('.ui-state-active').removeClass('ui-state-active'),a(this).addClass('ui-state-active'),h(a(this),p,q,r),!1}),b})();a.fn.restoreDateFromData=function(){return a(this).data('saveDate')&&a(this).datepicker('setDate',a(this).data('saveDate')).removeData('saveDate'),this},a.fn.saveDateToData=function(){return a(this).data('saveDate')||a(this).data('saveDate',a(this).datepicker('getDate')),this};var q=a('<div class="ranges ui-widget-header ui-corner-all ui-helper-clearfix"><div class="range-start"><span class="title-start">Start Date</span></div><div class="range-end"><span class="title-end">End Date</span></div></div>').appendTo(p);q.find('.range-start, .range-end').datepicker(j.datepickerOptions),q.find('.range-start').datepicker('setDate',l),q.find('.range-end').datepicker('setDate',o),q.find('.range-start, .range-end').bind('constrainOtherPicker',function(){j.constrainDates&&(a(this).is('.range-start')?p.find('.range-end').datepicker("option","minDate",a(this).datepicker('getDate')):p.find('.range-start').datepicker("option","maxDate",a(this).datepicker('getDate')))}).trigger('constrainOtherPicker');var r=a('<button class="btnDone ui-state-default ui-corner-all">'+j.doneButtonText+'</button>').click(function(){p.find('.ui-datepicker-current-day').trigger('click'),e()}).hover(function(){a(this).addClass('ui-state-hover')},function(){a(this).removeClass('ui-state-hover')}).appendTo(q);if(a(this).click(function(){return f(),!1}),q.hide().find('.range-start, .range-end, .btnDone').hide(),p.data('state','closed'),q.find('.ui-datepicker').css("display","block"),a(j.appendTo).append(p),p.wrap('<div class="ui-daterangepickercontain"></div>'),j.arrows&&1==i.size()){var s=a('<a href="#" class="ui-daterangepicker-prev ui-corner-all" title="'+j.prevLinkText+'"><span class="ui-icon ui-icon-circle-triangle-w">'+j.prevLinkText+'</span></a>'),t=a('<a href="#" class="ui-daterangepicker-next ui-corner-all" title="'+j.nextLinkText+'"><span class="ui-icon ui-icon-circle-triangle-e">'+j.nextLinkText+'</span></a>');a(this).addClass('ui-rangepicker-input ui-widget-content').wrap('<div class="ui-daterangepicker-arrows ui-widget ui-widget-header ui-helper-clearfix ui-corner-all"></div>').before(s).before(t).parent().find('a').click(function(){var b=q.find('.range-start').datepicker('getDate'),c=q.find('.range-end').datepicker('getDate'),d=Math.abs(new TimeSpan(b-c).getTotalMilliseconds())+864e5;return a(this).is('.ui-daterangepicker-prev')&&(d=-d),q.find('.range-start, .range-end ').each(function(){var b=a(this).datepicker("getDate");return null==b?!1:void a(this).datepicker("setDate",b.add({milliseconds:d})).find('.ui-datepicker-current-day').trigger('click')}),!1}).hover(function(){a(this).addClass('ui-state-hover')},function(){a(this).removeClass('ui-state-hover')});var u=i.parent()}return a(document).click(function(){p.is(':visible')&&e()}),p.click(function(){return!1}).hide(),this}}(jQuery),function(a,b){a.widget("ui.panel",{options:{height:200,width:400,linkWidth:100,click:!1,flip:!1},_create:function(){var b=this,c=b.options,d=b.element;d.addClass("ui-panel ui-widget ui-helper-reset ui-corner-all"),b._oWidth=d.css("width");var e=d.children("div").addClass("ui-panel-content");b._pWidth=e.css("width"),b._pHeight=e.css("height"),c.flip&&e.addClass('ui-panel-content-flip');var f=d.children("ul").addClass("ui-panel-list ui-widget-header");b._lHeight=f.css("height"),b._lWidth=f.css("width"),c.flip&&f.addClass('ui-panel-list-flip'),(b._multi=e.length>1?!0:!1)&&(f.children("li").first().addClass("ui-state-selected ui-state-active"),e.hide().first().show()),f.children("li").addClass("ui-state-default ui-panel-item").mouseover(function(a){return b._mouseover(a),!1}).mouseout(function(a){return b._mouseout(a),!1}).click(function(a){return b._click(a),!1}),b.resize(),a(window).bind("resize",function(a){b.resize()})},_mouseover:function(b){var c=this,d=c.options;return d.mouseover&&0==d.mouseover(b)?!1:d.hover&&0==d.hover(b)?!1:void a(b.target).addClass("ui-state-hover")},_mouseout:function(b){var c=this,d=c.options;return d.mouseout&&0==d.mouseout(b)?!1:d.hover&&0==d.hover(b)?!1:void a(b.target).removeClass("ui-state-hover")},_click:function(b){var c=this,d=c.options,e=a(b.target);if(d.beforeClick&&!1===d.beforeClick(b))return!1;if(d.click){if(!1===d.click(b))return!1}else if(c._multi){var f=c.element.children("div"),g=f.slice(e.index(),e.index()+1);g.length>0&&(f.hide(),g.show())}return c.element.children("ul").children("li.ui-state-selected").removeClass("ui-state-selected ui-state-active"),e.addClass("ui-state-selected ui-state-active"),d.afterClick&&!1===d.afterClick(b)?!1:void 0},_setBeforeClick:function(a){var b=this,c=b.options;return a?(c.beforeClick=a,b):c.beforeClick},_setClick:function(a){var b=this,c=b.options;return a?(c.click=a,b):c.click},_setAfterClick:function(a){var b=this,c=b.options;return a?(c.afterClick=a,b):c.afterClick},_height:function(a){var b=this,c=b.options;return a?(c.height=a,b.resize()):c.height},_width:function(a){var b=this,c=b.options;return a?(c.width=a,b.resize()):c.width},_linkWidth:function(a){var b=this,c=b.options;return a?(c.linkWidth=a,b.resize()):c.linkWidth},_flip:function(a){var b=this,c=b.options;return a?(c.flip=a,b.flip()):c.flip},add:function(b,c){var d=this,e=d.element;if(b){var f=a("string"==typeof b?'<li>'+b+'</li>':b);f.addClass("ui-state-default ui-panel-item").mouseover(function(a){return d._mouseover(a),!1}).mouseout(function(a){return d._mouseout(a),!1}).click(function(a){return d._click(a),!1}),e.children("ul").append(f)}if(c){var g=a("string"==typeof c?'<div>'+c+'</div>':c);g.addClass("ui-panel-content"),e.append(g)}return d},remove:function(a,b){var c=this,d=c.element;return d.children("ul").find(a||"li.ui-state-active").remove(),d.children("div").filter(b||":visible").remove(),c},contents:function(b,c){var d=this,e=d.element,c=c?a(c):e.children("div").filter(":visible");return c.html(b),d},append:function(b,c){var d=this,e=d.element,c=c?a(c):e.children("div").filter(":visible");return c.append(b),d},prepend:function(b,c){var d=this,e=d.element,c=c?a(c):e.children("div").filter(":visible");return c.prepend(b),d},resize:function(a,b,c){var d=this,e=d.options,f=d.element,a=e.width=a||e.width,b=e.height=b||e.height,c=e.linkWidth=c||e.linkWidth;f.width(a);var g=f.children("ul"),h=f.children("div").height(b);return g.height(b>h.outerHeight()?b:h.outerHeight()).width((""+c).search("%")>-1?f.width()*('.'+parseFloat(c)):c+100>a?a-100:c),h.width(f.width()-g.outerWidth()-(h.outerWidth()-h.width())-2),d},flip:function(a){var c=this,d=c.options,e=c.element,a=d.flip=a===b?!d.flip:a;return a?(e.children("ul").addClass("ui-panel-list-flip"),e.children("div").addClass("ui-panel-content-flip")):(e.children("ul").removeClass("ui-panel-list-flip"),e.children("div").removeClass("ui-panel-content-flip")),alert(d.flip),c},destroy:function(){var b=this,c=b.element;return c.removeClass("ui-panel ui-widget ui-helper-reset ui-corner-all").css("width",b._oWidth),c.children("ul").removeClass("ui-panel-list ui-widget-header ui-panel-list-flip").css("height",b._lHeight).css("width",b._lWidth).children("li").removeClass("ui-state-default ui-state-selected ui-panel-item").unbind(),c.children("div").removeClass("ui-panel-content ui-content-panel-flip").css("width",b._pWidth).css("height",b._pHeight),a.Widget.prototype.destroy.call(this)},_setOption:function(b,c){var d=this;switch(b){case"height":d._height(c);break;case"width":d._width(c);break;case"linkWidth":d._linkWidth(c);break;case"beforeClick":d._setBeforeClick(c);break;case"click":d._setClick(c);break;case"afterClick":d._setAfterClick(c);break;case"flip":d._flip(c)}a.Widget.prototype._setOption.apply(d,arguments)}}),a.extend(a.ui.panel,{version:"0.5"})}(jQuery),/*! 
* jQuery timepicker plugin - v1.0.1
* http://trentrichardson.com
* Copyright (c) 2012 Trent Richardson; Licensed MIT, GPL */
function($){function Timepicker(){this.regional=[],this.regional['']={currentText:'Now',closeText:'Done',ampm:!1,amNames:['AM','A'],pmNames:['PM','P'],timeFormat:'hh:mm tt',timeSuffix:'',timeOnlyTitle:'Choose Time',timeText:'Time',hourText:'Hour',minuteText:'Minute',secondText:'Second',millisecText:'Millisecond',timezoneText:'Time Zone'},this._defaults={showButtonPanel:!0,timeOnly:!1,showHour:!0,showMinute:!0,showSecond:!1,showMillisec:!1,showTimezone:!1,showTime:!0,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,hour:0,minute:0,second:0,millisec:0,timezone:null,useLocalTimezone:!1,defaultTimezone:"+0000",hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,minDateTime:null,maxDateTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,alwaysSetTime:!0,separator:' ',altFieldTimeOnly:!0,showTimepicker:!0,timezoneIso8601:!1,timezoneList:null,addSliderAccess:!1,sliderAccessArgs:null},$.extend(this._defaults,this.regional[''])}function extendRemove(a,b){$.extend(a,b);for(var c in b)(null===b[c]||void 0===b[c])&&(a[c]=b[c]);return a}if($.ui.timepicker=$.ui.timepicker||{},!$.ui.timepicker.version){$.extend($.ui,{timepicker:{version:"1.0.1"}}),$.extend(Timepicker.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,timezone_select:null,hour:0,minute:0,second:0,millisec:0,timezone:null,defaultTimezone:"+0000",hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,ampm:'',formattedDate:'',formattedTime:'',formattedDateTime:'',timezoneList:null,setDefaults:function(a){return extendRemove(this._defaults,a||{}),this},_newInst:function($input,o){var tp_inst=new Timepicker,inlineSettings={};for(var attrName in this._defaults){var attrValue=$input.attr('time:'+attrName);if(attrValue)try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}if(tp_inst._defaults=$.extend({},this._defaults,inlineSettings,o,{beforeShow:function(a,b){return $.isFunction(o.beforeShow)?o.beforeShow(a,b,tp_inst):void 0},onChangeMonthYear:function(a,b,c){tp_inst._updateDateTime(c),$.isFunction(o.onChangeMonthYear)&&o.onChangeMonthYear.call($input[0],a,b,c,tp_inst)},onClose:function(a,b){tp_inst.timeDefined===!0&&''!==$input.val()&&tp_inst._updateDateTime(b),$.isFunction(o.onClose)&&o.onClose.call($input[0],a,b,tp_inst)},timepicker:tp_inst}),tp_inst.amNames=$.map(tp_inst._defaults.amNames,function(a){return a.toUpperCase()}),tp_inst.pmNames=$.map(tp_inst._defaults.pmNames,function(a){return a.toUpperCase()}),null===tp_inst._defaults.timezoneList){for(var timezoneList=[],i=-11;12>=i;i++)timezoneList.push((i>=0?'+':'-')+('0'+Math.abs(i).toString()).slice(-2)+'00');tp_inst._defaults.timezoneIso8601&&(timezoneList=$.map(timezoneList,function(a){return'+0000'==a?'Z':a.substring(0,3)+':'+a.substring(3)})),tp_inst._defaults.timezoneList=timezoneList}return tp_inst.timezone=tp_inst._defaults.timezone,tp_inst.hour=tp_inst._defaults.hour,tp_inst.minute=tp_inst._defaults.minute,tp_inst.second=tp_inst._defaults.second,tp_inst.millisec=tp_inst._defaults.millisec,tp_inst.ampm='',tp_inst.$input=$input,o.altField&&(tp_inst.$altInput=$(o.altField).css({cursor:'pointer'}).focus(function(){$input.trigger("focus")})),(0===tp_inst._defaults.minDate||0===tp_inst._defaults.minDateTime)&&(tp_inst._defaults.minDate=new Date),(0===tp_inst._defaults.maxDate||0===tp_inst._defaults.maxDateTime)&&(tp_inst._defaults.maxDate=new Date),void 0!==tp_inst._defaults.minDate&&tp_inst._defaults.minDate instanceof Date&&(tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime())),void 0!==tp_inst._defaults.minDateTime&&tp_inst._defaults.minDateTime instanceof Date&&(tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime())),void 0!==tp_inst._defaults.maxDate&&tp_inst._defaults.maxDate instanceof Date&&(tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime())),void 0!==tp_inst._defaults.maxDateTime&&tp_inst._defaults.maxDateTime instanceof Date&&(tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime())),tp_inst},_addTimePicker:function(a){var b=this.$altInput&&this._defaults.altFieldTimeOnly?this.$input.val()+' '+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(b),this._limitMinMaxDateTime(a,!1),this._injectTimePicker()},_parseTime:function(a,b){if(this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),b||!this._defaults.timeOnly){var c=$.datepicker._get(this.inst,'dateFormat');try{var d=parseDateTimeInternal(c,this._defaults.timeFormat,a,$.datepicker._getFormatConfig(this.inst),this._defaults);if(!d.timeObj)return!1;$.extend(this,d.timeObj)}catch(e){return!1}return!0}var f=$.datepicker.parseTime(this._defaults.timeFormat,a,this._defaults);return f?($.extend(this,f),!0):!1},_injectTimePicker:function(){var a=this.inst.dpDiv,b=this._defaults,c=this,d=parseInt(b.hourMax-(b.hourMax-b.hourMin)%b.stepHour,10),e=parseInt(b.minuteMax-(b.minuteMax-b.minuteMin)%b.stepMinute,10),f=parseInt(b.secondMax-(b.secondMax-b.secondMin)%b.stepSecond,10),g=parseInt(b.millisecMax-(b.millisecMax-b.millisecMin)%b.stepMillisec,10),h=this.inst.id.toString().replace(/([^A-Za-z0-9_])/g,'');if(0===a.find("div#ui-timepicker-div-"+h).length&&b.showTimepicker){var i=' style="display:none;"',j='<div class="ui-timepicker-div" id="ui-timepicker-div-'+h+"\"><dl><dt class=\"ui_tpicker_time_label\" id=\"ui_tpicker_time_label_"+h+'"'+(b.showTime?'':i)+'>'+b.timeText+"</dt><dd class=\"ui_tpicker_time\" id=\"ui_tpicker_time_"+h+'"'+(b.showTime?'':i)+"></dd><dt class=\"ui_tpicker_hour_label\" id=\"ui_tpicker_hour_label_"+h+'"'+(b.showHour?'':i)+'>'+b.hourText+'</dt>',k=0,l=0,m=0,n=0,o=null;if(j+='<dd class="ui_tpicker_hour"><div id="ui_tpicker_hour_'+h+'"'+(b.showHour?'':i)+'></div>',b.showHour&&b.hourGrid>0){j+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>';for(var p=b.hourMin;d>=p;p+=parseInt(b.hourGrid,10)){k++;var q=b.ampm&&p>12?p-12:p;10>q&&(q='0'+q),b.ampm&&(0===p?q="12a":q+=12>p?'a':'p'),j+='<td>'+q+'</td>'}j+='</tr></table></div>'}if(j+='</dd>',j+='<dt class="ui_tpicker_minute_label" id="ui_tpicker_minute_label_'+h+'"'+(b.showMinute?'':i)+'>'+b.minuteText+"</dt><dd class=\"ui_tpicker_minute\"><div id=\"ui_tpicker_minute_"+h+'"'+(b.showMinute?'':i)+'></div>',b.showMinute&&b.minuteGrid>0){j+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>';for(var r=b.minuteMin;e>=r;r+=parseInt(b.minuteGrid,10))l++,j+='<td>'+(10>r?'0':'')+r+'</td>';j+='</tr></table></div>'}if(j+='</dd>',j+='<dt class="ui_tpicker_second_label" id="ui_tpicker_second_label_'+h+'"'+(b.showSecond?'':i)+'>'+b.secondText+"</dt><dd class=\"ui_tpicker_second\"><div id=\"ui_tpicker_second_"+h+'"'+(b.showSecond?'':i)+'></div>',b.showSecond&&b.secondGrid>0){j+='<div style="padding-left: 1px"><table><tr>';for(var s=b.secondMin;f>=s;s+=parseInt(b.secondGrid,10))m++,j+='<td>'+(10>s?'0':'')+s+'</td>';j+='</tr></table></div>'}if(j+='</dd>',j+='<dt class="ui_tpicker_millisec_label" id="ui_tpicker_millisec_label_'+h+'"'+(b.showMillisec?'':i)+'>'+b.millisecText+"</dt><dd class=\"ui_tpicker_millisec\"><div id=\"ui_tpicker_millisec_"+h+'"'+(b.showMillisec?'':i)+'></div>',b.showMillisec&&b.millisecGrid>0){j+='<div style="padding-left: 1px"><table><tr>';for(var t=b.millisecMin;g>=t;t+=parseInt(b.millisecGrid,10))n++,j+='<td>'+(10>t?'0':'')+t+'</td>';j+='</tr></table></div>'}j+='</dd>',j+='<dt class="ui_tpicker_timezone_label" id="ui_tpicker_timezone_label_'+h+'"'+(b.showTimezone?'':i)+'>'+b.timezoneText+'</dt>',j+='<dd class="ui_tpicker_timezone" id="ui_tpicker_timezone_'+h+'"'+(b.showTimezone?'':i)+'></dd>',j+='</dl></div>';var u=$(j);if(b.timeOnly===!0&&(u.prepend("<div class=\"ui-widget-header ui-helper-clearfix ui-corner-all\"><div class=\"ui-datepicker-title\">"+b.timeOnlyTitle+"</div></div>"),a.find('.ui-datepicker-header, .ui-datepicker-calendar').hide()),this.hour_slider=u.find('#ui_tpicker_hour_'+h).slider({orientation:"horizontal",value:this.hour,min:b.hourMin,max:d,step:b.stepHour,slide:function(a,b){c.hour_slider.slider("option","value",b.value),c._onTimeChange()}}),this.minute_slider=u.find('#ui_tpicker_minute_'+h).slider({orientation:"horizontal",value:this.minute,min:b.minuteMin,max:e,step:b.stepMinute,slide:function(a,b){c.minute_slider.slider("option","value",b.value),c._onTimeChange()}}),this.second_slider=u.find('#ui_tpicker_second_'+h).slider({orientation:"horizontal",value:this.second,min:b.secondMin,max:f,step:b.stepSecond,slide:function(a,b){c.second_slider.slider("option","value",b.value),c._onTimeChange()}}),this.millisec_slider=u.find('#ui_tpicker_millisec_'+h).slider({orientation:"horizontal",value:this.millisec,min:b.millisecMin,max:g,step:b.stepMillisec,slide:function(a,b){c.millisec_slider.slider("option","value",b.value),c._onTimeChange()}}),this.timezone_select=u.find('#ui_tpicker_timezone_'+h).append('<select></select>').find("select"),$.fn.append.apply(this.timezone_select,$.map(b.timezoneList,function(a,b){return $("<option />").val("object"==typeof a?a.value:a).text("object"==typeof a?a.label:a)})),"undefined"!=typeof this.timezone&&null!==this.timezone&&""!==this.timezone){var v=new Date(this.inst.selectedYear,this.inst.selectedMonth,this.inst.selectedDay,12),w=timeZoneString(v);w==this.timezone?selectLocalTimeZone(c):this.timezone_select.val(this.timezone)}else"undefined"!=typeof this.hour&&null!==this.hour&&""!==this.hour?this.timezone_select.val(b.defaultTimezone):selectLocalTimeZone(c);this.timezone_select.change(function(){c._defaults.useLocalTimezone=!1,c._onTimeChange()}),b.showHour&&b.hourGrid>0&&(o=100*k*b.hourGrid/(d-b.hourMin),u.find(".ui_tpicker_hour table").css({width:o+"%",marginLeft:o/(-2*k)+"%",borderCollapse:'collapse'}).find("td").each(function(a){$(this).click(function(){var a=$(this).html();if(b.ampm){var d=a.substring(2).toLowerCase(),e=parseInt(a.substring(0,2),10);a='a'==d?12==e?0:e:12==e?12:e+12}c.hour_slider.slider("option","value",a),c._onTimeChange(),c._onSelectHandler()}).css({cursor:'pointer',width:100/k+'%',textAlign:'center',overflow:'hidden'})})),b.showMinute&&b.minuteGrid>0&&(o=100*l*b.minuteGrid/(e-b.minuteMin),u.find(".ui_tpicker_minute table").css({width:o+"%",marginLeft:o/(-2*l)+"%",borderCollapse:'collapse'}).find("td").each(function(a){$(this).click(function(){c.minute_slider.slider("option","value",$(this).html()),c._onTimeChange(),c._onSelectHandler()}).css({cursor:'pointer',width:100/l+'%',textAlign:'center',overflow:'hidden'})})),b.showSecond&&b.secondGrid>0&&u.find(".ui_tpicker_second table").css({width:o+"%",marginLeft:o/(-2*m)+"%",borderCollapse:'collapse'}).find("td").each(function(a){$(this).click(function(){c.second_slider.slider("option","value",$(this).html()),c._onTimeChange(),c._onSelectHandler()}).css({cursor:'pointer',width:100/m+'%',textAlign:'center',overflow:'hidden'})}),b.showMillisec&&b.millisecGrid>0&&u.find(".ui_tpicker_millisec table").css({width:o+"%",marginLeft:o/(-2*n)+"%",borderCollapse:'collapse'}).find("td").each(function(a){$(this).click(function(){c.millisec_slider.slider("option","value",$(this).html()),c._onTimeChange(),c._onSelectHandler()}).css({cursor:'pointer',width:100/n+'%',textAlign:'center',overflow:'hidden'})});var x=a.find('.ui-datepicker-buttonpane');if(x.length?x.before(u):a.append(u),this.$timeObj=u.find('#ui_tpicker_time_'+h),null!==this.inst){var y=this.timeDefined;this._onTimeChange(),this.timeDefined=y}var z=function(){c._onSelectHandler()};if(this.hour_slider.bind('slidestop',z),this.minute_slider.bind('slidestop',z),this.second_slider.bind('slidestop',z),this.millisec_slider.bind('slidestop',z),this._defaults.addSliderAccess){var A=this._defaults.sliderAccessArgs;setTimeout(function(){if(0===u.find('.ui-slider-access').length){u.find('.ui-slider:visible').sliderAccess(A);var a=u.find('.ui-slider-access:eq(0)').outerWidth(!0);a&&u.find('table:visible').each(function(){var b=$(this),c=b.outerWidth(),d=b.css('marginLeft').toString().replace('%',''),e=c-a,f=d*e/c+'%';b.css({width:e,marginLeft:f})})}},0)}}},_limitMinMaxDateTime:function(a,b){var c=this._defaults,d=new Date(a.selectedYear,a.selectedMonth,a.selectedDay);if(this._defaults.showTimepicker){if(null!==$.datepicker._get(a,'minDateTime')&&void 0!==$.datepicker._get(a,'minDateTime')&&d){var e=$.datepicker._get(a,'minDateTime'),f=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0);(null===this.hourMinOriginal||null===this.minuteMinOriginal||null===this.secondMinOriginal||null===this.millisecMinOriginal)&&(this.hourMinOriginal=c.hourMin,this.minuteMinOriginal=c.minuteMin,this.secondMinOriginal=c.secondMin,this.millisecMinOriginal=c.millisecMin),a.settings.timeOnly||f.getTime()==d.getTime()?(this._defaults.hourMin=e.getHours(),this.hour<=this._defaults.hourMin?(this.hour=this._defaults.hourMin,this._defaults.minuteMin=e.getMinutes(),this.minute<=this._defaults.minuteMin?(this.minute=this._defaults.minuteMin,this._defaults.secondMin=e.getSeconds()):this.second<=this._defaults.secondMin?(this.second=this._defaults.secondMin,this._defaults.millisecMin=e.getMilliseconds()):(this.millisec<this._defaults.millisecMin&&(this.millisec=this._defaults.millisecMin),this._defaults.millisecMin=this.millisecMinOriginal)):(this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)):(this._defaults.hourMin=this.hourMinOriginal,this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)}if(null!==$.datepicker._get(a,'maxDateTime')&&void 0!==$.datepicker._get(a,'maxDateTime')&&d){var g=$.datepicker._get(a,'maxDateTime'),h=new Date(g.getFullYear(),g.getMonth(),g.getDate(),0,0,0,0);(null===this.hourMaxOriginal||null===this.minuteMaxOriginal||null===this.secondMaxOriginal)&&(this.hourMaxOriginal=c.hourMax,this.minuteMaxOriginal=c.minuteMax,this.secondMaxOriginal=c.secondMax,this.millisecMaxOriginal=c.millisecMax),a.settings.timeOnly||h.getTime()==d.getTime()?(this._defaults.hourMax=g.getHours(),this.hour>=this._defaults.hourMax?(this.hour=this._defaults.hourMax,this._defaults.minuteMax=g.getMinutes(),this.minute>=this._defaults.minuteMax?(this.minute=this._defaults.minuteMax,this._defaults.secondMax=g.getSeconds()):this.second>=this._defaults.secondMax?(this.second=this._defaults.secondMax,this._defaults.millisecMax=g.getMilliseconds()):(this.millisec>this._defaults.millisecMax&&(this.millisec=this._defaults.millisecMax),this._defaults.millisecMax=this.millisecMaxOriginal)):(this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal)):(this._defaults.hourMax=this.hourMaxOriginal,this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal)}if(void 0!==b&&b===!0){var i=parseInt(this._defaults.hourMax-(this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour,10),j=parseInt(this._defaults.minuteMax-(this._defaults.minuteMax-this._defaults.minuteMin)%this._defaults.stepMinute,10),k=parseInt(this._defaults.secondMax-(this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond,10),l=parseInt(this._defaults.millisecMax-(this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec,10);this.hour_slider&&this.hour_slider.slider("option",{min:this._defaults.hourMin,max:i}).slider('value',this.hour),this.minute_slider&&this.minute_slider.slider("option",{min:this._defaults.minuteMin,max:j}).slider('value',this.minute),this.second_slider&&this.second_slider.slider("option",{min:this._defaults.secondMin,max:k}).slider('value',this.second),this.millisec_slider&&this.millisec_slider.slider("option",{min:this._defaults.millisecMin,max:l}).slider('value',this.millisec)}}},_onTimeChange:function(){var a=this.hour_slider?this.hour_slider.slider('value'):!1,b=this.minute_slider?this.minute_slider.slider('value'):!1,c=this.second_slider?this.second_slider.slider('value'):!1,d=this.millisec_slider?this.millisec_slider.slider('value'):!1,e=this.timezone_select?this.timezone_select.val():!1,f=this._defaults;'object'==typeof a&&(a=!1),'object'==typeof b&&(b=!1),'object'==typeof c&&(c=!1),'object'==typeof d&&(d=!1),'object'==typeof e&&(e=!1),a!==!1&&(a=parseInt(a,10)),b!==!1&&(b=parseInt(b,10)),c!==!1&&(c=parseInt(c,10)),d!==!1&&(d=parseInt(d,10));var g=f[12>a?'amNames':'pmNames'][0],h=a!=this.hour||b!=this.minute||c!=this.second||d!=this.millisec||this.ampm.length>0&&12>a!=(-1!==$.inArray(this.ampm.toUpperCase(),this.amNames))||e!=this.timezone;h&&(a!==!1&&(this.hour=a),b!==!1&&(this.minute=b),c!==!1&&(this.second=c),d!==!1&&(this.millisec=d),e!==!1&&(this.timezone=e),this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),this._limitMinMaxDateTime(this.inst,!0)),f.ampm&&(this.ampm=g),this.formattedTime=$.datepicker.formatTime(this._defaults.timeFormat,this,this._defaults),this.$timeObj&&this.$timeObj.text(this.formattedTime+f.timeSuffix),this.timeDefined=!0,h&&this._updateDateTime()},_onSelectHandler:function(){var a=this._defaults.onSelect,b=this.$input?this.$input[0]:null;a&&b&&a.apply(b,[this.formattedDateTime,this])},_formatTime:function(a,b){a=a||{hour:this.hour,minute:this.minute,second:this.second,millisec:this.millisec,ampm:this.ampm,timezone:this.timezone};var c=(b||this._defaults.timeFormat).toString();return c=$.datepicker.formatTime(c,a,this._defaults),arguments.length?c:void(this.formattedTime=c)},_updateDateTime:function(a){a=this.inst||a;var b=$.datepicker._daylightSavingAdjust(new Date(a.selectedYear,a.selectedMonth,a.selectedDay)),c=$.datepicker._get(a,'dateFormat'),d=$.datepicker._getFormatConfig(a),e=null!==b&&this.timeDefined;this.formattedDate=$.datepicker.formatDate(c,null===b?new Date:b,d);var f=this.formattedDate;this._defaults.timeOnly===!0?f=this.formattedTime:this._defaults.timeOnly!==!0&&(this._defaults.alwaysSetTime||e)&&(f+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix),this.formattedDateTime=f,this._defaults.showTimepicker?this.$altInput&&this._defaults.altFieldTimeOnly===!0?(this.$altInput.val(this.formattedTime),this.$input.val(this.formattedDate)):this.$altInput?(this.$altInput.val(f),this.$input.val(f)):this.$input.val(f):this.$input.val(this.formattedDate),this.$input.trigger("change")}}),$.fn.extend({timepicker:function(a){a=a||{};var b=arguments;return'object'==typeof a&&(b[0]=$.extend(a,{timeOnly:!0})),$(this).each(function(){$.fn.datetimepicker.apply($(this),b)})},datetimepicker:function(a){a=a||{};var b=arguments;return'string'==typeof a?'getDate'==a?$.fn.datepicker.apply($(this[0]),b):this.each(function(){var a=$(this);a.datepicker.apply(a,b)}):this.each(function(){var b=$(this);b.datepicker($.timepicker._newInst(b,a)._defaults)})}}),$.datepicker.parseDateTime=function(a,b,c,d,e){var f=parseDateTimeInternal(a,b,c,d,e);if(f.timeObj){var g=f.timeObj;f.date.setHours(g.hour,g.minute,g.second,g.millisec)}return f.date},$.datepicker.parseTime=function(a,b,c){var d,e=function(a,b){var c=[];return a&&$.merge(c,a),b&&$.merge(c,b),c=$.map(c,function(a){return a.replace(/[.*+?|()\[\]{}\\]/g,'\\$&')}),'('+c.join('|')+')?'},f=function(a){var b=a.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|t{1,2}|z)/g),c={h:-1,m:-1,s:-1,l:-1,t:-1,z:-1};if(b)for(var d=0;d<b.length;d++)-1==c[b[d].toString().charAt(0)]&&(c[b[d].toString().charAt(0)]=d+1);return c},g=extendRemove(extendRemove({},$.timepicker._defaults),c||{}),h='^'+a.toString().replace(/h{1,2}/gi,'(\\d?\\d)').replace(/m{1,2}/gi,'(\\d?\\d)').replace(/s{1,2}/gi,'(\\d?\\d)').replace(/l{1}/gi,'(\\d?\\d?\\d)').replace(/t{1,2}/gi,e(g.amNames,g.pmNames)).replace(/z{1}/gi,'(z|[-+]\\d\\d:?\\d\\d)?').replace(/\s/g,'\\s?')+g.timeSuffix+'$',i=f(a),j='';d=b.match(new RegExp(h,'i'));var k={hour:0,minute:0,second:0,millisec:0};if(d){if(-1!==i.t&&(void 0===d[i.t]||0===d[i.t].length?(j='',k.ampm=''):(j=-1!==$.inArray(d[i.t],g.amNames)?'AM':'PM',k.ampm=g['AM'==j?'amNames':'pmNames'][0])),-1!==i.h&&('AM'==j&&'12'==d[i.h]?k.hour=0:'PM'==j&&'12'!=d[i.h]?k.hour=parseInt(d[i.h],10)+12:k.hour=Number(d[i.h])),-1!==i.m&&(k.minute=Number(d[i.m])),-1!==i.s&&(k.second=Number(d[i.s])),-1!==i.l&&(k.millisec=Number(d[i.l])),-1!==i.z&&void 0!==d[i.z]){var l=d[i.z].toUpperCase();switch(l.length){case 1:l=g.timezoneIso8601?'Z':'+0000';break;case 5:g.timezoneIso8601&&(l='0000'==l.substring(1)?'Z':l.substring(0,3)+':'+l.substring(3));break;case 6:g.timezoneIso8601?'00:00'==l.substring(1)&&(l='Z'):l='Z'==l||'00:00'==l.substring(1)?'+0000':l.replace(/:/,'')}k.timezone=l}return k}return!1},$.datepicker.formatTime=function(a,b,c){c=c||{},c=$.extend($.timepicker._defaults,c),b=$.extend({hour:0,minute:0,second:0,millisec:0,timezone:'+0000'},b);var d=a,e=c.amNames[0],f=parseInt(b.hour,10);return c.ampm&&(f>11&&(e=c.pmNames[0],f>12&&(f%=12)),0===f&&(f=12)),d=d.replace(/(?:hh?|mm?|ss?|[tT]{1,2}|[lz])/g,function(a){switch(a.toLowerCase()){case'hh':return('0'+f).slice(-2);case'h':return f;case'mm':return('0'+b.minute).slice(-2);case'm':return b.minute;case'ss':return('0'+b.second).slice(-2);case's':return b.second;case'l':return('00'+b.millisec).slice(-3);case'z':return b.timezone;case't':case'tt':return c.ampm?(1==a.length&&(e=e.charAt(0)),'T'==a.charAt(0)?e.toUpperCase():e.toLowerCase()):''}}),d=$.trim(d)},$.datepicker._base_selectDate=$.datepicker._selectDate,$.datepicker._selectDate=function(a,b){var c=this._getInst($(a)[0]),d=this._get(c,'timepicker');d?(d._limitMinMaxDateTime(c,!0),c.inline=c.stay_open=!0,this._base_selectDate(a,b),c.inline=c.stay_open=!1,this._notifyChange(c),this._updateDatepicker(c)):this._base_selectDate(a,b)},$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker,$.datepicker._updateDatepicker=function(a){var b=a.input[0];if(!($.datepicker._curInst&&$.datepicker._curInst!=a&&$.datepicker._datepickerShowing&&$.datepicker._lastInput!=b||'boolean'==typeof a.stay_open&&a.stay_open!==!1)){this._base_updateDatepicker(a);var c=this._get(a,'timepicker');if(c&&(c._addTimePicker(a),c._defaults.useLocalTimezone)){var d=new Date(a.selectedYear,a.selectedMonth,a.selectedDay,12);selectLocalTimeZone(c,d),c._onTimeChange()}}},$.datepicker._base_doKeyPress=$.datepicker._doKeyPress,$.datepicker._doKeyPress=function(a){var b=$.datepicker._getInst(a.target),c=$.datepicker._get(b,'timepicker');if(c&&$.datepicker._get(b,'constrainInput')){var d=c._defaults.ampm,e=$.datepicker._possibleChars($.datepicker._get(b,'dateFormat')),f=c._defaults.timeFormat.toString().replace(/[hms]/g,'').replace(/TT/g,d?'APM':'').replace(/Tt/g,d?'AaPpMm':'').replace(/tT/g,d?'AaPpMm':'').replace(/T/g,d?'AP':'').replace(/tt/g,d?'apm':'').replace(/t/g,d?'ap':'')+" "+c._defaults.separator+c._defaults.timeSuffix+(c._defaults.showTimezone?c._defaults.timezoneList.join(''):'')+c._defaults.amNames.join('')+c._defaults.pmNames.join('')+e,g=String.fromCharCode(void 0===a.charCode?a.keyCode:a.charCode);return a.ctrlKey||' '>g||!e||f.indexOf(g)>-1}return $.datepicker._base_doKeyPress(a)},$.datepicker._base_doKeyUp=$.datepicker._doKeyUp,$.datepicker._doKeyUp=function(a){var b=$.datepicker._getInst(a.target),c=$.datepicker._get(b,'timepicker');if(c&&c._defaults.timeOnly&&b.input.val()!=b.lastVal)try{$.datepicker._updateDatepicker(b)}catch(d){$.datepicker.log(d)}return $.datepicker._base_doKeyUp(a)},$.datepicker._base_gotoToday=$.datepicker._gotoToday,$.datepicker._gotoToday=function(a){var b=this._getInst($(a)[0]),c=b.dpDiv;this._base_gotoToday(a);var d=this._get(b,'timepicker');selectLocalTimeZone(d);var e=new Date;this._setTime(b,e),$('.ui-datepicker-today',c).click()},$.datepicker._disableTimepickerDatepicker=function(a){var b=this._getInst(a);if(b){var c=this._get(b,'timepicker');$(a).datepicker('getDate'),c&&(c._defaults.showTimepicker=!1,c._updateDateTime(b))}},$.datepicker._enableTimepickerDatepicker=function(a){var b=this._getInst(a);if(b){var c=this._get(b,'timepicker');$(a).datepicker('getDate'),c&&(c._defaults.showTimepicker=!0,c._addTimePicker(b),c._updateDateTime(b))}},$.datepicker._setTime=function(a,b){var c=this._get(a,'timepicker');if(c){var d=c._defaults,e=b?b.getHours():d.hour,f=b?b.getMinutes():d.minute,g=b?b.getSeconds():d.second,h=b?b.getMilliseconds():d.millisec,i=e===d.hourMin,j=f===d.minuteMin,k=g===d.secondMin,l=!1;e<d.hourMin||e>d.hourMax?l=!0:(f<d.minuteMin||f>d.minuteMax)&&i?l=!0:(g<d.secondMin||g>d.secondMax)&&i&&j?l=!0:(h<d.millisecMin||h>d.millisecMax)&&i&&j&&k&&(l=!0),l&&(e=d.hourMin,f=d.minuteMin,g=d.secondMin,h=d.millisecMin),c.hour=e,c.minute=f,c.second=g,c.millisec=h,c.hour_slider&&c.hour_slider.slider('value',e),c.minute_slider&&c.minute_slider.slider('value',f),c.second_slider&&c.second_slider.slider('value',g),c.millisec_slider&&c.millisec_slider.slider('value',h),c._onTimeChange(),c._updateDateTime(a)}},$.datepicker._setTimeDatepicker=function(a,b,c){var d=this._getInst(a);if(d){var e=this._get(d,'timepicker');if(e){this._setDateFromField(d);var f;b&&("string"==typeof b?(e._parseTime(b,c),f=new Date,f.setHours(e.hour,e.minute,e.second,e.millisec)):f=new Date(b.getTime()),'Invalid Date'==f.toString()&&(f=void 0),this._setTime(d,f))}}},$.datepicker._base_setDateDatepicker=$.datepicker._setDateDatepicker,$.datepicker._setDateDatepicker=function(a,b){var c=this._getInst(a);if(c){var d=b instanceof Date?new Date(b.getTime()):b;this._updateDatepicker(c),this._base_setDateDatepicker.apply(this,arguments),this._setTimeDatepicker(a,d,!0)}},$.datepicker._base_getDateDatepicker=$.datepicker._getDateDatepicker,$.datepicker._getDateDatepicker=function(a,b){var c=this._getInst(a);if(c){var d=this._get(c,'timepicker');if(d){this._setDateFromField(c,b);var e=this._getDate(c);return e&&d._parseTime($(a).val(),d.timeOnly)&&e.setHours(d.hour,d.minute,d.second,d.millisec),e}return this._base_getDateDatepicker(a,b)}},$.datepicker._base_parseDate=$.datepicker.parseDate,$.datepicker.parseDate=function(a,b,c){var d=splitDateTime(a,b,c);return $.datepicker._base_parseDate(a,d[0],c)},$.datepicker._base_formatDate=$.datepicker._formatDate,$.datepicker._formatDate=function(a,b,c,d){var e=this._get(a,'timepicker');return e?(e._updateDateTime(a),e.$input.val()):this._base_formatDate(a)},$.datepicker._base_optionDatepicker=$.datepicker._optionDatepicker,$.datepicker._optionDatepicker=function(a,b,c){var d=this._getInst(a);if(!d)return null;var e=this._get(d,'timepicker');if(e){var f=null,g=null,h=null;'string'==typeof b?'minDate'===b||'minDateTime'===b?f=c:'maxDate'===b||'maxDateTime'===b?g=c:'onSelect'===b&&(h=c):'object'==typeof b&&(b.minDate?f=b.minDate:b.minDateTime?f=b.minDateTime:b.maxDate?g=b.maxDate:b.maxDateTime&&(g=b.maxDateTime)),f?(f=0===f?new Date:new Date(f),e._defaults.minDate=f,e._defaults.minDateTime=f):g?(g=0===g?new Date:new Date(g),e._defaults.maxDate=g,e._defaults.maxDateTime=g):h&&(e._defaults.onSelect=h)}return void 0===c?this._base_optionDatepicker(a,b):this._base_optionDatepicker(a,b,c)};var splitDateTime=function(a,b,c){try{$.datepicker._base_parseDate(a,b,c)}catch(d){if(d.indexOf(":")>=0){var e=b.length-(d.length-d.indexOf(':')-2);b.substring(e);return[b.substring(0,e),b.substring(e)]}throw d}return[b,'']},parseDateTimeInternal=function(a,b,c,d,e){var f,g=splitDateTime(a,c,d);if(f=$.datepicker._base_parseDate(a,g[0],d),''!==g[1]){var h=g[1],i=e&&e.separator?e.separator:$.timepicker._defaults.separator;if(0!==h.indexOf(i))throw'Missing time separator';h=h.substring(i.length);var j=$.datepicker.parseTime(b,h,e);if(null===j)throw'Wrong time format';return{date:f,timeObj:j}}return{date:f}},selectLocalTimeZone=function(a,b){if(a&&a.timezone_select){a._defaults.useLocalTimezone=!0;var c='undefined'!=typeof b?b:new Date,d=timeZoneString(c);a._defaults.timezoneIso8601&&(d=d.substring(0,3)+':'+d.substring(3)),a.timezone_select.val(d)}},timeZoneString=function(a){var b=-10100*a.getTimezoneOffset()/60,c=(b>=0?'+':'-')+Math.abs(b).toString().substr(1);return c};$.timepicker=new Timepicker,$.timepicker.version="1.0.1"}}(jQuery),/*! 
* jQuery Array Utilities - v1.0
* https://github.com/KristianAbrahamsen/jquery.arrayUtilities
* Copyright (c) 2013 - Kristian Marheim Abrahamsen; Licensed MIT licence */
function(a){var b={},c=function(a){for(var b=0;b<a.length;b++)if(!(a[b]instanceof Array))throw new Error('Every argument must be an array!')};b.distinct=function(b){if(1!=arguments.length)throw new Error('There must be exactly 1 array argument!');c(arguments);for(var d=[],e=0;e<b.length;e++){var f=b[e];-1===a.inArray(f,d)&&d.push(f)}return d},b.union=function(){if(arguments.length<2)throw new Error('There must be minimum 2 array arguments!');c(arguments);for(var b=this.distinct(arguments[0]),d=1;d<arguments.length;d++)for(var e=arguments[d],f=0;f<e.length;f++){var g=e[f];-1===a.inArray(g,b)&&b.push(g)}return b},b.intersect=function(){if(arguments.length<2)throw new Error('There must be minimum 2 array arguments!');c(arguments);var b=[],d=this.distinct(arguments[0]);if(0===d.length)return[];for(var e=0;e<d.length;e++){for(var f=d[e],g=!0,h=1;h<arguments.length;h++){var i=arguments[h];if(0==i.length)return[];if(-1===a.inArray(f,i)){g=!1;break}}g&&b.push(f)}return b},b.except=function(){if(arguments.length<2)throw new Error('There must be minimum 2 array arguments!');c(arguments);for(var b=[],d=this.distinct(arguments[0]),e=[],f=1;f<arguments.length;f++){var g=arguments[f];e=e.concat(g)}for(var f=0;f<d.length;f++){var h=d[f];-1===a.inArray(h,e)&&b.push(h)}return b},a.arrayUtilities=b,a.distinct=b.distinct,a.union=b.union,a.intersect=b.intersect,a.except=b.except}(jQuery),/*! 
* Input Mask plugin - v2.3.17
* http://github.com/RobinHerbots/jquery.inputmask
* Copyright (c) 2010 - 2013 Robin Herbots; Licensed MIT license */
function(a){void 0==a.fn.inputmask&&(a.inputmask={defaults:{placeholder:"_",optionalmarker:{start:"[",end:"]"},escapeChar:"\\",mask:null,oncomplete:a.noop,onincomplete:a.noop,oncleared:a.noop,repeat:0,greedy:!0,autoUnmask:!1,clearMaskOnLostFocus:!0,insertMode:!0,clearIncomplete:!1,aliases:{},onKeyUp:a.noop,onKeyDown:a.noop,showMaskOnFocus:!0,showMaskOnHover:!0,onKeyValidation:a.noop,skipOptionalPartCharacter:" ",showTooltip:!1,numericInput:!1,isNumeric:!1,radixPoint:"",skipRadixDance:!1,rightAlignNumerics:!0,definitions:{9:{validator:"[0-9]",cardinality:1},a:{validator:"[A-Za-zА-яЁё]",cardinality:1},'*':{validator:"[A-Za-zА-яЁё0-9]",cardinality:1}},keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91},ignorables:[9,13,19,27,33,34,35,36,37,38,39,40,45,46,93,112,113,114,115,116,117,118,119,120,121,122,123],getMaskLength:function(a,b,c,d,e){var f=a.length;return b||("*"==c?f=d.length+1:c>1&&(f+=a.length*(c-1))),f}},val:a.fn.val,escapeRegex:function(a){var b=['/','.','*','+','?','|','(',')','[',']','{','}','\\'];return a.replace(new RegExp('(\\'+b.join('|\\')+')','gim'),'\\$1')}},a.fn.inputmask=function(b,c){function d(a){var b=document.createElement('input'),a='on'+a,c=a in b;return c||(b.setAttribute(a,'return;'),c='function'==typeof b[a]),b=null,c}function e(b,c){var d=n.aliases[b];return d?(d.alias&&e(d.alias),a.extend(!0,n,d),a.extend(!0,n,c),!0):!1}function f(b){var c=!1,d=0,e=n.greedy,f=n.repeat;"*"==f&&(e=!1),1==b.length&&0==e&&(n.placeholder="");for(var g=a.map(b.split(""),function(a,b){var e=[];if(a==n.escapeChar)c=!0;else if(a!=n.optionalmarker.start&&a!=n.optionalmarker.end||c){var f=n.definitions[a];if(f&&!c)for(var g=0;g<f.cardinality;g++)e.push(j(d+g));else e.push(a),c=!1;return d+=e.length,e}}),h=g.slice(),i=1;f>i&&e;i++)h=h.concat(g.slice());return{mask:h,repeat:f,greedy:e}}function g(b){var c=!1,d=!1,e=!1;return a.map(b.split(""),function(a,b){var f=[];if(a==n.escapeChar)d=!0;else if(a!=n.optionalmarker.start||d){if(a!=n.optionalmarker.end||d){var g=n.definitions[a];if(g&&!d){for(var h=g.prevalidator,i=h?h.length:0,j=1;j<g.cardinality;j++){var k=i>=j?h[j-1]:[],l=k.validator,m=k.cardinality;f.push({fn:l?'string'==typeof l?new RegExp(l):new function(){this.test=l}:new RegExp("."),cardinality:m?m:1,optionality:c,newBlockMarker:1==c?e:!1,offset:0,casing:g.casing,def:g.definitionSymbol|a}),1==c&&(e=!1)}f.push({fn:g.validator?'string'==typeof g.validator?new RegExp(g.validator):new function(){this.test=g.validator}:new RegExp("."),cardinality:g.cardinality,optionality:c,newBlockMarker:e,offset:0,casing:g.casing,def:g.definitionSymbol|a})}else f.push({fn:null,cardinality:0,optionality:c,newBlockMarker:e,offset:0,casing:null,def:a}),d=!1;return e=!1,f}c=!1,e=!0}else c=!0,e=!0})}function h(){function b(a){return n.optionalmarker.start+a+n.optionalmarker.end}function c(a){var b=0,c=0,d=a.length;for(i=0;i<d&&(a.charAt(i)==n.optionalmarker.start&&b++,a.charAt(i)==n.optionalmarker.end&&c++,!(b>0&&b==c));i++);var e=[a.substring(0,i)];return i<d&&e.push(a.substring(i+1,d)),e}function d(a){var b=a.length;for(i=0;i<b&&a.charAt(i)!=n.optionalmarker.start;i++);var c=[a.substring(0,i)];return i<b&&c.push(a.substring(i+1,b)),c}function e(i,k){var l,m,n=c(k),o=d(n[0]);o.length>1?(l=i+o[0]+b(o[1])+(n.length>1?n[1]:""),-1==a.inArray(l,j)&&(j.push(l),m=f(l),h.push({mask:l,_buffer:m.mask,buffer:m.mask.slice(),tests:g(l),lastValidPosition:void 0,greedy:m.greedy,repeat:m.repeat})),l=i+o[0]+(n.length>1?n[1]:""),-1==a.inArray(l,j)&&(j.push(l),m=f(l),h.push({mask:l,_buffer:m.mask,buffer:m.mask.slice(),tests:g(l),lastValidPosition:void 0,greedy:m.greedy,repeat:m.repeat})),d(o[1]).length>1&&e(i+o[0],o[1]+n[1]),n.length>1&&d(n[1]).length>1&&(e(i+o[0]+b(o[1]),n[1]),e(i+o[0],n[1]))):(l=i+n,-1==a.inArray(l,j)&&(j.push(l),m=f(l),h.push({mask:l,_buffer:m.mask,buffer:m.mask.slice(),tests:g(l),lastValidPosition:void 0,greedy:m.greedy,repeat:m.repeat})))}var h=[],j=[];return a.isArray(n.mask)?a.each(n.mask,function(a,b){e("",b.toString())}):e("",n.mask.toString()),n.greedy?h:h.sort(function(a,b){return a.mask.length-b.mask.length})}function j(a){return n.placeholder.charAt(a%n.placeholder.length)}function k(b,c){function d(){return b[c]}function e(){return d().tests}function f(){return d()._buffer}function g(){return d().buffer}function h(e,g,h){function i(a,b){for(var c=m(a),d=g?1:0,e='',f=b.buffer,i=b.tests[c].cardinality;i>d;i--)e+=v(f,c-(i-1));return g&&(e+=g),null!=b.tests[c].fn?b.tests[c].fn.test(e,f,a,h,n):!1}if(h=h===!0){var j=i(e,d());return j===!0&&(j={pos:e}),j}var l=[],j=!1,p=c;return a.each(b,function(a,h){if("object"==typeof h){c=a;var m=e;if(p!=c&&!k(e)){if(g==f()[m]||g==n.skipOptionalPartCharacter)return l.push({activeMasksetIndex:a,result:{refresh:!0,c:f()[m]}}),d().lastValidPosition=m,!1;b[p].lastValidPosition>=m?d().lastValidPosition=-1:m=s(e)}if((void 0==d().lastValidPosition&&m==s(-1)||d().lastValidPosition>=t(m))&&m>=0&&m<o()){if(j=i(m,d()),j!==!1){j===!0&&(j={pos:m});var q=j.pos||m;(void 0==d().lastValidPosition||d().lastValidPosition<q)&&(d().lastValidPosition=q)}l.push({activeMasksetIndex:a,result:j})}}}),c=p,l}function i(){var e=c,f={activeMasksetIndex:0,lastValidPosition:-1};a.each(b,function(a,b){if("object"==typeof b){var c=this;void 0!=c.lastValidPosition&&c.lastValidPosition>f.lastValidPosition&&(f.activeMasksetIndex=a,f.lastValidPosition=c.lastValidPosition)}}),c=f.activeMasksetIndex,e!=c&&(y(g(),s(f.lastValidPosition),o()),d().writeOutBuffer=!0)}function k(a){var b=m(a),c=e()[b];return void 0!=c?c.fn:!1}function m(a){return a%e().length}function o(){return n.getMaskLength(f(),d().greedy,d().repeat,g(),n)}function s(a){var b=o();if(a>=b)return b;for(var c=a;++c<b&&!k(c););return c}function t(a){var b=a;if(0>=b)return 0;for(;--b>0&&!k(b););return b}function u(a,b,c,d){d&&(b=w(a,b));var f=e()[m(b)],g=c;if(void 0!=g)switch(f.casing){case"upper":g=c.toUpperCase();break;case"lower":g=c.toLowerCase()}a[b]=g}function v(a,b,c){return c&&(b=w(a,b)),a[b]}function w(a,b){for(var c;void 0==a[b]&&a.length<o();)for(c=0;void 0!==f()[c];)a.push(f()[c++]);return b}function x(a,b,c){a._valueSet(b.join('')),void 0!=c&&F(a,c)}function y(a,b,c){for(var d=b,e=o();c>d&&e>d;d++)u(a,d,v(f().slice(),d,!0))}function z(a,b){var c=m(b);u(a,b,v(f(),c))}function A(e,g,h,i){var j=void 0!=i?i.slice():C(e._valueGet()).split('');a.each(b,function(a,b){"object"==typeof b&&(b.buffer=b._buffer.slice(),b.lastValidPosition=void 0,b.p=0)}),h!==!0&&(c=0),g&&e._valueSet("");o();a.each(j,function(b,c){var i=b,j=d().lastValidPosition,l=d().p;l=void 0==j?i:l,j=void 0==j?-1:j,(h&&k(i)||(c!=v(f().slice(),i,!0)||k(i))&&-1==a.inArray(c,f().slice(j+1,l)))&&a(e).trigger("keypress",[!0,c.charCodeAt(0),g,h,i])}),h===!0&&(d().lastValidPosition=t(d().p))}function B(b){return a.inputmask.escapeRegex.call(this,b)}function C(a){return a.replace(new RegExp("("+B(f().join(''))+")*$"),"")}function D(a){for(var b,c,d=g(),f=d.slice(),c=f.length-1;c>=0;c--){var b=m(c);if(!e()[b].optionality)break;if(k(c)&&h(c,d[c],!0))break;f.pop()}x(a,f)}function E(b,c){return!e()||c!==!0&&b.hasClass('hasDatepicker')?b[0]._valueGet():a.map(g(),function(a,b){return k(b)&&h(b,a,!0)?a:null}).join('')}function F(b,c,d,e){function f(a){if(e!==!0&&I&&'number'==typeof a){var b=g().length;a=b-a}return a}var h,i=b.jquery&&b.length>0?b[0]:b;return'number'!=typeof c?a(b).is(':visible')?(i.setSelectionRange?(c=i.selectionStart,d=i.selectionEnd):document.selection&&document.selection.createRange&&(h=document.selection.createRange(),c=0-h.duplicate().moveStart('character',-1e5),d=c+h.text.length),c=f(c),d=f(d),{begin:c,end:d}):{begin:0,end:0}:(c=f(c),d=f(d),a(b).is(':visible')&&(d='number'==typeof d?d:c,0==n.insertMode&&c==d&&d++,i.setSelectionRange?(i.selectionStart=c,i.selectionEnd=q?c:d):i.createTextRange&&(h=i.createTextRange(),h.collapse(!0),h.moveEnd('character',d),h.moveStart('character',c),h.select())),void 0)}function G(d){var e=!1,g=0,h=c;return a.each(b,function(a,b){if("object"==typeof b){c=a;var h=t(o());if(void 0!=b.lastValidPosition&&b.lastValidPosition>=g&&b.lastValidPosition==h){for(var i=!0,l=0;h>=l;l++){var n=k(l),p=m(l);if(n&&(void 0==d[l]||d[l]==j(l))||!n&&d[l]!=f()[p]){i=!1;break}}if(e=e||i)return!1}g=b.lastValidPosition}}),c=h,e}function H(a,b){return I?a-b>1||a-b==1&&n.insertMode:b-a>1||b-a==1&&n.insertMode}var I=!1;return this.unmaskedvalue=function(a,b){return I=a.data('_inputmask').isRTL,E(a,b)},this.isComplete=function(a){return G(a)},this.mask=function(q){function w(b){var c=a._data(b).events;a.each(c,function(b,c){a.each(c,function(a,b){if("inputmask"==b.namespace){var c=b.handler;b.handler=function(a){return this.readOnly||this.disabled?void a.preventDefault:c.apply(this,arguments)}}})})}function B(b){var c;if(Object.getOwnPropertyDescriptor&&(c=Object.getOwnPropertyDescriptor(b,"value")),c&&c.get){if(!b._valueGet){var d=c.get,e=c.set;b._valueGet=function(){return I?d.call(this).split('').reverse().join(''):d.call(this)},b._valueSet=function(a){e.call(this,I?a.split('').reverse().join(''):a)},Object.defineProperty(b,"value",{get:function(){var b=a(this),c=a(this).data('_inputmask'),d=c.masksets,e=c.activeMasksetIndex;return c&&c.opts.autoUnmask?b.inputmask('unmaskedvalue'):this._valueGet()!=d[e]._buffer.join('')?this._valueGet():''},set:function(b){this._valueSet(b),a(this).triggerHandler('setvalue.inputmask')}})}}else if(document.__lookupGetter__&&b.__lookupGetter__("value")){if(!b._valueGet){var d=b.__lookupGetter__("value"),e=b.__lookupSetter__("value");b._valueGet=function(){return I?d.call(this).split('').reverse().join(''):d.call(this)},b._valueSet=function(a){e.call(this,I?a.split('').reverse().join(''):a)},b.__defineGetter__("value",function(){var b=a(this),c=a(this).data('_inputmask'),d=c.masksets,e=c.activeMasksetIndex;return c&&c.opts.autoUnmask?b.inputmask('unmaskedvalue'):this._valueGet()!=d[e]._buffer.join('')?this._valueGet():''}),b.__defineSetter__("value",function(b){this._valueSet(b),a(this).triggerHandler('setvalue.inputmask')})}}else b._valueGet||(b._valueGet=function(){return I?this.value.split('').reverse().join(''):this.value},b._valueSet=function(a){this.value=I?a.split('').reverse().join(''):a}),1!=a.fn.val.inputmaskpatch&&(a.fn.val=function(){if(0==arguments.length){var b=a(this);if(b.data('_inputmask')){if(b.data('_inputmask').opts.autoUnmask)return b.inputmask('unmaskedvalue');var c=a.inputmask.val.apply(b),d=a(this).data('_inputmask'),e=d.masksets,f=d.activeMasksetIndex;return c!=e[f]._buffer.join('')?c:''}return a.inputmask.val.apply(b)}var g=arguments;return this.each(function(){var b=a(this),c=a.inputmask.val.apply(b,g);return b.data('_inputmask')&&b.triggerHandler('setvalue.inputmask'),c})},a.extend(a.fn.val,{inputmaskpatch:!0}))}function E(a,b,c){for(var i=g();!k(a)&&a-1>=0;)a--;for(var l=a;b>l&&l<o();l++)if(k(l)){z(i,l);var n=s(l),p=v(i,n);if(p!=j(n))if(n<o()&&h(l,p,!0)!==!1&&e()[m(l)].def==e()[m(n)].def)u(i,l,v(i,n),!0),b>n&&z(i,n);else if(k(l))break}else z(i,l);if(void 0!=c&&u(i,t(b),c),0==d().greedy){var q=C(i.join('')).split('');i.length=q.length;for(var l=0,r=i.length;r>l;l++)i[l]=q[l];0==i.length&&(d().buffer=f().slice())}return a}function J(a,b,c,i){for(var l=g(),n=a;b>=n&&n<o();n++)if(k(n)){var p=v(l,n,!0);if(u(l,n,c,!0),p!=j(n)){var q=s(n);if(!(q<o()))break;if(h(q,p,!0)!==!1&&e()[m(n)].def==e()[m(q)].def)c=p;else{if(k(q))break;c=p}}else if(c=p,i!==!0)break}else z(l,n);var r=l.length;if(0==d().greedy){var t=C(l.join('')).split('');l.length=t.length;for(var n=0,w=l.length;w>n;n++)l[n]=t[n];0==l.length&&(d().buffer=f().slice())}return b-(r-l.length)}function K(e){P=!1;var h=this,m=e.keyCode,q=F(h);if(m==n.keyCode.BACKSPACE||m==n.keyCode.DELETE||p&&127==m||e.ctrlKey&&88==m){if(e.preventDefault(),n.numericInput||I)switch(m){case n.keyCode.BACKSPACE:m=n.keyCode.DELETE;break;case n.keyCode.DELETE:m=n.keyCode.BACKSPACE}if(H(q.begin,q.end)){if(I){var r=q.end;q.end=q.begin,q.begin=r}if(y(g(),q.begin,q.end),0==q.begin&&q.end==o())a.each(b,function(a,b){"object"==typeof b&&(b.buffer=b._buffer.slice(),b.lastValidPosition=void 0,b.p=0)});else{var u=o();if(0==n.greedy)E(q.begin,u);else for(var v=q.begin;v<q.end;v++)k(v)&&E(q.begin,u);A(h,!1,!0,g())}}else a.each(b,function(a,b){if("object"==typeof b){c=a;var e=l?q.end:q.begin,h=g(),i=s(-1),k=o();m==n.keyCode.DELETE?(i>e&&(e=i),k>e&&(n.isNumeric&&""!=n.radixPoint&&h[e]==n.radixPoint?(e=h.length-1==e?e:s(e),e=E(e,k)):e=E(e,k),void 0!=d().lastValidPosition&&(-1!=d().lastValidPosition&&g()[d().lastValidPosition]==f()[d().lastValidPosition]&&(d().lastValidPosition=0==d().lastValidPosition?-1:t(d().lastValidPosition)),d().lastValidPosition<i?(d().lastValidPosition=void 0,d().p=i):(d().writeOutBuffer=!0,d().p=e)))):m==n.keyCode.BACKSPACE&&(e>i?(e-=1,n.isNumeric&&""!=n.radixPoint&&h[e]==n.radixPoint?(e=J(0,h.length-1==e?e:e-1,j(e),!0),e++):e=E(e,k),void 0!=d().lastValidPosition&&(-1!=d().lastValidPosition&&g()[d().lastValidPosition]==f()[d().lastValidPosition]&&(d().lastValidPosition=0==d().lastValidPosition?-1:t(d().lastValidPosition)),d().lastValidPosition<i?(d().lastValidPosition=void 0,d().p=i):(d().writeOutBuffer=!0,d().p=e))):c>0&&(d().lastValidPosition=void 0,d().writeOutBuffer=!0,d().p=i,c=0,d().buffer=f().slice(),d().p=s(-1),d().lastValidPosition=void 0))}});i(),x(h,g(),d().p),h._valueGet()==f().join('')&&a(h).trigger('cleared'),n.showTooltip&&N.prop("title",d().mask)}else m==n.keyCode.END||m==n.keyCode.PAGE_DOWN?setTimeout(function(){var a=s(d().lastValidPosition);n.insertMode||a!=o()||e.shiftKey||a--,F(h,e.shiftKey?q.begin:a,a)},0):m==n.keyCode.HOME&&!e.shiftKey||m==n.keyCode.PAGE_UP?F(h,0,e.shiftKey?q.begin:0):m==n.keyCode.ESCAPE?(h._valueSet(d().undoBuffer),A(h,!0,!0)):m!=n.keyCode.INSERT||e.shiftKey||e.ctrlKey?0!=n.insertMode||e.shiftKey||(m==n.keyCode.RIGHT?setTimeout(function(){var a=F(h);F(h,a.begin)},0):m==n.keyCode.LEFT&&setTimeout(function(){var a=F(h);F(h,a.begin-1)},0)):(n.insertMode=!n.insertMode,F(h,n.insertMode||q.begin!=o()?q.begin:q.begin-1));var w=F(h);n.onKeyDown.call(this,e,g(),n),F(h,w.begin,w.end),Q=-1!=a.inArray(m,n.ignorables)}function L(e,f,l,m,p,q){if(void 0==l&&P)return!1;P=!0;var r=this,w=a(r);e=e||window.event;var l=l||e.which||e.charCode||e.keyCode,z=String.fromCharCode(l);if(!(e.ctrlKey&&e.altKey||!(e.ctrlKey||e.metaKey||Q)||f===!0))return!0;if(l){var B,C,D;if(f){var K=p?q:d().p;B={begin:K,end:K}}else B=F(r);var L=H(B.begin,B.end),M=!1;if(L){if(I){var N=B.end;B.end=B.begin,B.begin=N}var O=c;a.each(b,function(a,b){if("object"==typeof b){c=a,d().undoBuffer=g().join('');var e=B.end<o()?B.end:o();d().lastValidPosition>B.begin&&d().lastValidPosition<e?d().lastValidPosition=t(B.begin):M=!0,y(g(),B.begin,e);var f=o();if(0==n.greedy)E(B.begin,f);else for(var h=B.begin;e>h;h++)k(h)&&E(B.begin,f)}}),M===!0&&(c=O,A(r,!1,!0,g()),n.insertMode||a.each(b,function(a,b){"object"==typeof b&&(c=a,J(B.begin,o(),j(B.begin),!0),d().lastValidPosition=s(d().lastValidPosition))})),c=O}if(n.isNumeric&&z==n.radixPoint&&f!==!0){var R=g().join(''),S=R.indexOf(n.radixPoint);-1!=S&&(B.begin=B.begin==S?s(S):S,B.end=B.begin,F(r,B.begin))}var T=n.numericInput&&1!=p&&!L?t(B.begin):s(B.begin-1);if(C=h(T,z,p),p===!0&&(C=[{activeMasksetIndex:c,result:C}]),a.each(C,function(a,b){c=b.activeMasksetIndex,d().writeOutBuffer=!0;var e=b.result;if(e!==!1){var f=!1,h=g();if(e!==!0&&(f=e.refresh,T=void 0!=e.pos?e.pos:T,z=void 0!=e.c?e.c:z),f!==!0)if(1==n.insertMode){for(var i=o(),k=h.slice();v(k,i,!0)!=j(i)&&i>=T;)i=0==i?-1:t(i);if(i>=T){J(T,h.length,z);var l=d().lastValidPosition,m=s(l);m!=o()&&l>=T&&v(g(),m)!=j(m)&&(d().lastValidPosition=m)}else d().writeOutBuffer=!1}else u(h,T,z,!0);d().p=s(T)}}),p!==!0&&i(),m!==!1&&(a.each(C,function(a,b){return b.activeMasksetIndex==c?(D=b,!1):void 0}),void 0!=D)){var U=this;if(setTimeout(function(){n.onKeyValidation.call(U,D.result,n)},0),d().writeOutBuffer&&D.result!==!1){var V=g();x(r,V,f?void 0:n.numericInput?t(d().p):d().p),f!==!0&&setTimeout(function(){G(V)&&w.trigger("complete")},0)}else L&&(d().buffer=d().undoBuffer.split(''))}n.showTooltip&&w.prop("title",d().mask),e.preventDefault()}}function M(b){var c=a(this),e=this,h=b.keyCode,i=g(),j=F(e);n.onKeyUp.call(this,b,i,n),F(e,j.begin,j.end),h==n.keyCode.TAB&&c.hasClass('focus.inputmask')&&0==e._valueGet().length&&n.showMaskOnFocus&&(i=f().slice(),x(e,i),F(e,0),d().undoBuffer=e._valueGet())}var N=a(q);if(N.is(":input")){if(N.data('_inputmask',{masksets:b,activeMasksetIndex:c,opts:n,isRTL:!1}),n.showTooltip&&N.prop("title",d().mask),d().greedy=d().greedy?d().greedy:0==d().repeat,null!=N.attr("maxLength")){var O=N.prop('maxLength');O>-1&&a.each(b,function(a,b){"object"==typeof b&&"*"==b.repeat&&(b.repeat=O)}),o()>O&&O>-1&&(O<f().length&&(f().length=O),0==d().greedy&&(d().repeat=Math.round(O/f().length)),N.prop('maxLength',2*o()))}B(q),d().undoBuffer=q._valueGet();var P=!1,Q=!1;if(("rtl"==q.dir||n.numericInput&&n.rightAlignNumerics||n.isNumeric&&n.rightAlignNumerics)&&N.css("text-align","right"),"rtl"==q.dir||n.numericInput){q.dir="ltr",N.removeAttr("dir");var R=N.data('_inputmask');R.isRTL=!0,N.data('_inputmask',R),I=!0}N.unbind(".inputmask"),N.removeClass('focus.inputmask'),N.closest('form').bind("submit",function(){N[0]._valueGet&&N[0]._valueGet()!=d().undoBuffer&&N.change()}).bind('reset',function(){a.each(b,function(a,b){"object"==typeof b&&(b.buffer=b._buffer.slice(),b.lastValidPosition=void 0,b.p=-1)})}),N.bind("mouseenter.inputmask",function(){var b=a(this),c=this;!b.hasClass('focus.inputmask')&&n.showMaskOnHover&&c._valueGet()!=g().join('')&&x(c,g())}).bind("blur.inputmask",function(){var e=a(this),h=this,i=h._valueGet(),j=g();e.removeClass('focus.inputmask'),i!=d().undoBuffer&&e.change(),n.clearMaskOnLostFocus&&''!=i&&(i==f().join('')?h._valueSet(''):D(h)),G(j)||(e.trigger("incomplete"),n.clearIncomplete&&(a.each(b,function(a,b){"object"==typeof b&&(b.buffer=b._buffer.slice(),b.lastValidPosition=void 0,b.p=0)}),c=0,n.clearMaskOnLostFocus?h._valueSet(''):(j=f().slice(),x(h,j))))}).bind("focus.inputmask",function(){var b=a(this),c=this,e=c._valueGet();n.showMaskOnFocus&&!b.hasClass('focus.inputmask')&&(!n.showMaskOnHover||n.showMaskOnHover&&''==e)&&c._valueGet()!=g().join('')&&x(c,g(),d().p),b.addClass('focus.inputmask'),d().undoBuffer=c._valueGet(),b.click()}).bind("mouseleave.inputmask",function(){var b=a(this),c=this;n.clearMaskOnLostFocus&&(b.hasClass('focus.inputmask')||(c._valueGet()==f().join('')||''==c._valueGet()?c._valueSet(''):D(c)))}).bind("click.inputmask",function(){var b=this;setTimeout(function(){var c=F(b),e=g();if(c.begin==c.end){var f,i=c.begin,j=d().lastValidPosition;f=n.isNumeric?n.skipRadixDance===!1&&""!=n.radixPoint&&-1!=a.inArray(n.radixPoint,e)?a.inArray(n.radixPoint,e):o():s(void 0==j?-1:j),F(b,f>i&&(h(i,e[i],!0)!==!1||!k(i))?i:f)}},0)}).bind('dblclick.inputmask',function(){var a=this;void 0!=d().lastValidPosition&&setTimeout(function(){F(a,0,s(d().lastValidPosition))},0)}).bind("keydown.inputmask",K).bind("keypress.inputmask",L).bind("keyup.inputmask",M).bind(r+".inputmask dragdrop.inputmask drop.inputmask",function(){var b=this,c=a(b);setTimeout(function(){A(b,!0,!1),G(g())&&c.trigger("complete"),c.click()},0)}).bind('setvalue.inputmask',function(){var a=this;d().undoBuffer=a._valueGet(),A(a,!0),a._valueGet()==f().join('')&&a._valueSet('')}).bind('complete.inputmask',n.oncomplete).bind('incomplete.inputmask',n.onincomplete).bind('cleared.inputmask',n.oncleared),A(q,!0,!1);var S;try{S=document.activeElement}catch(T){}S===q?(N.addClass('focus.inputmask'),F(q,d().p)):n.clearMaskOnLostFocus?g().join('')==f().join('')?q._valueSet(''):D(q):x(q,g()),w(q)}},this}var l,m,n=a.extend(!0,{},a.inputmask.defaults,c),o=/*@cc_on!@*/!1,p=null!==navigator.userAgent.match(new RegExp("iphone","i")),q=null!==navigator.userAgent.match(new RegExp("android.*safari.*","i")),r=d('paste')&&!o?'paste':'input',s=0;if(q){var t=navigator.userAgent.match(/safari.*/i),u=parseInt(new RegExp(/[0-9]+/).exec(t));l=537>=u}if("string"==typeof b)switch(b){case"mask":return e(n.alias,c),m=h(),this.each(function(){k(a.extend(!0,{},m),0).mask(this)});case"unmaskedvalue":var v=a(this);return v.data('_inputmask')?(m=v.data('_inputmask').masksets,s=v.data('_inputmask').activeMasksetIndex,n=v.data('_inputmask').opts,k(m,s).unmaskedvalue(v)):v.val();case"remove":return this.each(function(){var b=a(this),c=this;if(b.data('_inputmask')){m=b.data('_inputmask').masksets,s=b.data('_inputmask').activeMasksetIndex,n=b.data('_inputmask').opts,c._valueSet(k(m,s).unmaskedvalue(b,!0)),b.removeData('_inputmask'),b.unbind(".inputmask"),b.removeClass('focus.inputmask');var d;Object.getOwnPropertyDescriptor&&(d=Object.getOwnPropertyDescriptor(c,"value")),d&&d.get?c._valueGet&&Object.defineProperty(c,"value",{get:c._valueGet,set:c._valueSet}):document.__lookupGetter__&&c.__lookupGetter__("value")&&c._valueGet&&(c.__defineGetter__("value",c._valueGet),c.__defineSetter__("value",c._valueSet));try{delete c._valueGet,delete c._valueSet}catch(e){c._valueGet=void 0,c._valueSet=void 0}}});case"getemptymask":return this.data('_inputmask')?(m=this.data('_inputmask').masksets,s=this.data('_inputmask').activeMasksetIndex,m[s]._buffer.join('')):"";case"hasMaskedValue":return this.data('_inputmask')?!this.data('_inputmask').opts.autoUnmask:!1;case"isComplete":return m=this.data('_inputmask').masksets,s=this.data('_inputmask').activeMasksetIndex,n=this.data('_inputmask').opts,k(m,s).isComplete(this[0]._valueGet().split(''));default:return e(b,c)||(n.mask=b),m=h(),this.each(function(){k(a.extend(!0,{},m),s).mask(this)})}else{if("object"==typeof b)return n=a.extend(!0,{},a.inputmask.defaults,b),e(n.alias,b),m=h(),this.each(function(){k(a.extend(!0,{},m),s).mask(this)});if(void 0==b)return this.each(function(){var b=a(this).attr("data-inputmask");if(b&&""!=b)try{b=b.replace(new RegExp("'","g"),'"');var d=a.parseJSON("{"+b+"}");a.extend(!0,d,c),n=a.extend(!0,{},a.inputmask.defaults,d),e(n.alias,d),n.alias=void 0,a(this).inputmask(n)}catch(f){}})}return this})}(jQuery),function(a){a.extend(a.inputmask.defaults.definitions,{A:{validator:"[A-Za-z]",cardinality:1,casing:"upper"},'#':{validator:"[A-Za-zА-яЁё0-9]",cardinality:1,casing:"upper"}}),a.extend(a.inputmask.defaults.aliases,{url:{mask:"ir",placeholder:"",separator:"",defaultPrefix:"http://",regex:{urlpre1:new RegExp("[fh]"),urlpre2:new RegExp("(ft|ht)"),urlpre3:new RegExp("(ftp|htt)"),urlpre4:new RegExp("(ftp:|http|ftps)"),urlpre5:new RegExp("(ftp:/|ftps:|http:|https)"),urlpre6:new RegExp("(ftp://|ftps:/|http:/|https:)"),urlpre7:new RegExp("(ftp://|ftps://|http://|https:/)"),urlpre8:new RegExp("(ftp://|ftps://|http://|https://)")},definitions:{i:{validator:function(a,b,c,d,e){return!0},cardinality:8,prevalidator:function(){for(var a=[],b=8,c=0;b>c;c++)a[c]=function(){var a=c;return{validator:function(b,c,d,e,f){if(f.regex["urlpre"+(a+1)]){var g,h=b;a+1-b.length>0&&(h=c.join('').substring(0,a+1-b.length)+""+h);var i=f.regex["urlpre"+(a+1)].test(h);if(!e&&!i){for(d-=a,g=0;g<f.defaultPrefix.length;g++)c[d]=f.defaultPrefix[g],d++;for(g=0;g<h.length-1;g++)c[d]=h[g],d++;return{pos:d}}return i}return!1},cardinality:a}}();return a}()},r:{validator:".",cardinality:50}},insertMode:!1,autoUnmask:!1},ip:{mask:"i.i.i.i",definitions:{i:{validator:"25[0-5]|2[0-4][0-9]|[01][0-9][0-9]",cardinality:3,prevalidator:[{validator:"[0-2]",cardinality:1},{validator:"2[0-5]|[01][0-9]",cardinality:2}]}}}})}(jQuery),function(a){a.extend(a.inputmask.defaults.definitions,{h:{validator:"[01][0-9]|2[0-3]",cardinality:2,prevalidator:[{validator:"[0-2]",cardinality:1}]},s:{validator:"[0-5][0-9]",cardinality:2,prevalidator:[{validator:"[0-5]",cardinality:1}]},d:{validator:"0[1-9]|[12][0-9]|3[01]",cardinality:2,prevalidator:[{validator:"[0-3]",cardinality:1}]},m:{validator:"0[1-9]|1[012]",cardinality:2,prevalidator:[{validator:"[01]",cardinality:1}]},y:{validator:"(19|20)\\d{2}",cardinality:4,prevalidator:[{validator:"[12]",cardinality:1},{validator:"(19|20)",cardinality:2},{validator:"(19|20)\\d",cardinality:3}]}}),a.extend(a.inputmask.defaults.aliases,{'dd/mm/yyyy':{mask:"1/2/y",placeholder:"dd/mm/yyyy",regex:{val1pre:new RegExp("[0-3]"),val1:new RegExp("0[1-9]|[12][0-9]|3[01]"),val2pre:function(b){var c=a.inputmask.escapeRegex.call(this,b);return new RegExp("((0[1-9]|[12][0-9]|3[01])"+c+"[01])")},val2:function(b){var c=a.inputmask.escapeRegex.call(this,b);return new RegExp("((0[1-9]|[12][0-9])"+c+"(0[1-9]|1[012]))|(30"+c+"(0[13-9]|1[012]))|(31"+c+"(0[13578]|1[02]))")}},leapday:"29/02/",separator:'/',yearrange:{minyear:1900,maxyear:2099},isInYearRange:function(a,b,c){var d=parseInt(a.concat(b.toString().slice(a.length))),e=parseInt(a.concat(c.toString().slice(a.length)));return(NaN!=d?d>=b&&c>=d:!1)||(NaN!=e?e>=b&&c>=e:!1)},determinebaseyear:function(a,b,c){var d=(new Date).getFullYear();if(a>d)return a;if(d>b){for(var e=b.toString().slice(0,2),f=b.toString().slice(2,4);e+c>b;)e--;var g=e+f;return a>g?a:g}return d},onKeyUp:function(b,c,d){var e=a(this);if(b.ctrlKey&&b.keyCode==d.keyCode.RIGHT){var f=new Date;e.val(f.getDate().toString()+(f.getMonth()+1).toString()+f.getFullYear().toString())}},definitions:{1:{validator:function(a,b,c,d,e){var f=e.regex.val1.test(a);return d||f||a.charAt(1)!=e.separator&&-1=="-./".indexOf(a.charAt(1))||!(f=e.regex.val1.test("0"+a.charAt(0)))?f:(b[c-1]="0",{pos:c,c:a.charAt(0)})},cardinality:2,prevalidator:[{validator:function(a,b,c,d,e){var f=e.regex.val1pre.test(a);return d||f||!(f=e.regex.val1.test("0"+a))?f:(b[c]="0",c++,{pos:c})},cardinality:1}]},2:{validator:function(a,b,c,d,e){var f=b.join('').substr(0,3),g=e.regex.val2(e.separator).test(f+a);return d||g||a.charAt(1)!=e.separator&&-1=="-./".indexOf(a.charAt(1))||!(g=e.regex.val2(e.separator).test(f+"0"+a.charAt(0)))?g:(b[c-1]="0",{pos:c,c:a.charAt(0)})},cardinality:2,prevalidator:[{validator:function(a,b,c,d,e){var f=b.join('').substr(0,3),g=e.regex.val2pre(e.separator).test(f+a);return d||g||!(g=e.regex.val2(e.separator).test(f+"0"+a))?g:(b[c]="0",c++,{pos:c})},cardinality:1}]},y:{validator:function(a,b,c,d,e){if(e.isInYearRange(a,e.yearrange.minyear,e.yearrange.maxyear)){var f=b.join('').substr(0,6);if(f!=e.leapday)return!0;var g=parseInt(a,10);return g%4===0?g%100===0?g%400===0?!0:!1:!0:!1}return!1},cardinality:4,prevalidator:[{validator:function(a,b,c,d,e){var f=e.isInYearRange(a,e.yearrange.minyear,e.yearrange.maxyear);if(!d&&!f){var g=e.determinebaseyear(e.yearrange.minyear,e.yearrange.maxyear,a+"0").toString().slice(0,1);if(f=e.isInYearRange(g+a,e.yearrange.minyear,e.yearrange.maxyear))return b[c++]=g[0],{pos:c};if(g=e.determinebaseyear(e.yearrange.minyear,e.yearrange.maxyear,a+"0").toString().slice(0,2),f=e.isInYearRange(g+a,e.yearrange.minyear,e.yearrange.maxyear))return b[c++]=g[0],b[c++]=g[1],{pos:c}}return f},cardinality:1},{validator:function(a,b,c,d,e){var f=e.isInYearRange(a,e.yearrange.minyear,e.yearrange.maxyear);if(!d&&!f){var g=e.determinebaseyear(e.yearrange.minyear,e.yearrange.maxyear,a).toString().slice(0,2);if(f=e.isInYearRange(a[0]+g[1]+a[1],e.yearrange.minyear,e.yearrange.maxyear))return b[c++]=g[1],{pos:c};if(g=e.determinebaseyear(e.yearrange.minyear,e.yearrange.maxyear,a).toString().slice(0,2),e.isInYearRange(g+a,e.yearrange.minyear,e.yearrange.maxyear)){var h=b.join('').substr(0,6);if(h!=e.leapday)f=!0;else{var i=parseInt(a,10);f=i%4===0?i%100===0?i%400===0?!0:!1:!0:!1}}else f=!1;if(f)return b[c-1]=g[0],b[c++]=g[1],b[c++]=a[0],{pos:c}}return f},cardinality:2},{validator:function(a,b,c,d,e){return e.isInYearRange(a,e.yearrange.minyear,e.yearrange.maxyear)},cardinality:3}]}},insertMode:!1,autoUnmask:!1},'mm/dd/yyyy':{placeholder:"mm/dd/yyyy",alias:"dd/mm/yyyy",regex:{val2pre:function(b){var c=a.inputmask.escapeRegex.call(this,b);return new RegExp("((0[13-9]|1[012])"+c+"[0-3])|(02"+c+"[0-2])")},val2:function(b){var c=a.inputmask.escapeRegex.call(this,b);return new RegExp("((0[1-9]|1[012])"+c+"(0[1-9]|[12][0-9]))|((0[13-9]|1[012])"+c+"30)|((0[13578]|1[02])"+c+"31)")},val1pre:new RegExp("[01]"),val1:new RegExp("0[1-9]|1[012]")},leapday:"02/29/",onKeyUp:function(b,c,d){var e=a(this);if(b.ctrlKey&&b.keyCode==d.keyCode.RIGHT){var f=new Date;e.val((f.getMonth()+1).toString()+f.getDate().toString()+f.getFullYear().toString())}}},'yyyy/mm/dd':{mask:"y/1/2",placeholder:"yyyy/mm/dd",alias:"mm/dd/yyyy",leapday:"/02/29",onKeyUp:function(b,c,d){var e=a(this);if(b.ctrlKey&&b.keyCode==d.keyCode.RIGHT){var f=new Date;e.val(f.getFullYear().toString()+(f.getMonth()+1).toString()+f.getDate().toString())}},definitions:{2:{validator:function(a,b,c,d,e){var f=b.join('').substr(5,3),g=e.regex.val2(e.separator).test(f+a);if(!d&&!g&&(a.charAt(1)==e.separator||-1!="-./".indexOf(a.charAt(1)))&&(g=e.regex.val2(e.separator).test(f+"0"+a.charAt(0))))return b[c-1]="0",{pos:c,c:a.charAt(0)};if(g){var h=b.join('').substr(4,4)+a;if(h!=e.leapday)return!0;var i=parseInt(b.join('').substr(0,4),10);return i%4===0?i%100===0?i%400===0?!0:!1:!0:!1}return g},cardinality:2,prevalidator:[{validator:function(a,b,c,d,e){var f=b.join('').substr(5,3),g=e.regex.val2pre(e.separator).test(f+a);return d||g||!(g=e.regex.val2(e.separator).test(f+"0"+a))?g:(b[c]="0",c++,{pos:c})},cardinality:1}]}}},'dd.mm.yyyy':{mask:"1.2.y",placeholder:"dd.mm.yyyy",leapday:"29.02.",separator:'.',alias:"dd/mm/yyyy"},'dd-mm-yyyy':{mask:"1-2-y",placeholder:"dd-mm-yyyy",leapday:"29-02-",separator:'-',alias:"dd/mm/yyyy"},'mm.dd.yyyy':{mask:"1.2.y",placeholder:"mm.dd.yyyy",leapday:"02.29.",separator:'.',alias:"mm/dd/yyyy"},'mm-dd-yyyy':{mask:"1-2-y",placeholder:"mm-dd-yyyy",leapday:"02-29-",separator:'-',alias:"mm/dd/yyyy"},'yyyy.mm.dd':{mask:"y.1.2",placeholder:"yyyy.mm.dd",leapday:".02.29",separator:'.',alias:"yyyy/mm/dd"},'yyyy-mm-dd':{mask:"y-1-2",placeholder:"yyyy-mm-dd",leapday:"-02-29",separator:'-',alias:"yyyy/mm/dd"},datetime:{mask:"1/2/y h:s",placeholder:"dd/mm/yyyy hh:mm",alias:"dd/mm/yyyy",regex:{hrspre:new RegExp("[012]"),hrs24:new RegExp("2[0-9]|1[3-9]"),hrs:new RegExp("[01][0-9]|2[0-3]"),ampm:new RegExp("^[a|p|A|P][m|M]")},timeseparator:':',hourFormat:"24",definitions:{h:{validator:function(a,b,c,d,e){var f=e.regex.hrs.test(a);if(!d&&!f&&(a.charAt(1)==e.timeseparator||-1!="-.:".indexOf(a.charAt(1)))&&(f=e.regex.hrs.test("0"+a.charAt(0))))return b[c-1]="0",b[c]=a.charAt(0),c++,{pos:c};if(f&&"24"!==e.hourFormat&&e.regex.hrs24.test(a)){var g=parseInt(a,10);return 24==g?(b[c+5]="a",b[c+6]="m"):(b[c+5]="p",b[c+6]="m"),g-=12,10>g?(b[c]=g.toString(),b[c-1]="0"):(b[c]=g.toString().charAt(1),b[c-1]=g.toString().charAt(0)),{pos:c,c:b[c]}}return f},cardinality:2,prevalidator:[{validator:function(a,b,c,d,e){var f=e.regex.hrspre.test(a);return d||f||!(f=e.regex.hrs.test("0"+a))?f:(b[c]="0",c++,{pos:c})},cardinality:1}]},t:{validator:function(a,b,c,d,e){return e.regex.ampm.test(a+"m")},casing:"lower",cardinality:1}},insertMode:!1,autoUnmask:!1},datetime12:{mask:"1/2/y h:s t\\m",placeholder:"dd/mm/yyyy hh:mm xm",alias:"datetime",hourFormat:"12"},'hh:mm t':{mask:"h:s t\\m",placeholder:"hh:mm xm",alias:"datetime",hourFormat:"12"},'h:s t':{mask:"h:s t\\m",placeholder:"hh:mm xm",alias:"datetime",hourFormat:"12"},'hh:mm:ss':{mask:"h:s:s",autoUnmask:!1},'hh:mm':{mask:"h:s",autoUnmask:!1},date:{alias:"dd/mm/yyyy"}})}(jQuery),function(a){a.extend(a.inputmask.defaults.aliases,{decimal:{mask:"~",placeholder:"",repeat:"*",greedy:!1,numericInput:!1,isNumeric:!0,digits:"*",groupSeparator:"",radixPoint:".",groupSize:3,autoGroup:!1,allowPlus:!0,allowMinus:!0,getMaskLength:function(b,c,d,e,f){var g=b.length;c||("*"==d?g=e.length+1:d>1&&(g+=b.length*(d-1)));var h=a.inputmask.escapeRegex.call(this,f.groupSeparator),i=a.inputmask.escapeRegex.call(this,f.radixPoint),j=e.join(''),k=j.replace(new RegExp(h,"g"),"").replace(new RegExp(i),""),l=j.length-k.length;return g+l},postFormat:function(b,c,d,e){
if(""==e.groupSeparator)return c;var f=b.slice();a.inArray(e.radixPoint,b);d||f.splice(c,0,"?");var g=f.join('');if(e.autoGroup||d&&-1!=g.indexOf(e.groupSeparator)){var h=a.inputmask.escapeRegex.call(this,e.groupSeparator);g=g.replace(new RegExp(h,"g"),'');var i=g.split(e.radixPoint);g=i[0];for(var j=new RegExp('([-+]?[\\d?]+)([\\d?]{'+e.groupSize+'})');j.test(g);)g=g.replace(j,'$1'+e.groupSeparator+'$2'),g=g.replace(e.groupSeparator+e.groupSeparator,e.groupSeparator);i.length>1&&(g+=e.radixPoint+i[1])}b.length=g.length;for(var k=0,l=g.length;l>k;k++)b[k]=g.charAt(k);var m=a.inArray("?",b);return d||b.splice(m,1),d?c:m},regex:{number:function(b){var c=a.inputmask.escapeRegex.call(this,b.groupSeparator),d=a.inputmask.escapeRegex.call(this,b.radixPoint),e=isNaN(b.digits)?b.digits:'{0,'+b.digits+'}',f="["+(b.allowPlus?"+":"")+(b.allowMinus?"-":"")+"]?";return new RegExp("^"+f+"(\\d+|\\d{1,"+b.groupSize+"}(("+c+"\\d{"+b.groupSize+"})?)+)("+d+"\\d"+e+")?$")}},onKeyDown:function(b,c,d){var e=a(this),f=this;if(b.keyCode==d.keyCode.TAB){var g=a.inArray(d.radixPoint,c);if(-1!=g){for(var h=e.data('_inputmask').masksets,i=e.data('_inputmask').activeMasksetIndex,j=1;j<=d.digits&&j<d.getMaskLength(h[i]._buffer,h[i].greedy,h[i].repeat,c,d);j++)void 0==c[g+j]&&(c[g+j]="0");f._valueSet(c.join(''))}}else(b.keyCode==d.keyCode.DELETE||b.keyCode==d.keyCode.BACKSPACE)&&(d.postFormat(c,0,!0,d),f._valueSet(c.join('')))},definitions:{'~':{validator:function(b,c,d,e,f){if(""==b)return!1;if(!e&&1>=d&&'0'===c[0]&&new RegExp("[\\d-]").test(b)&&1==c.length)return c[0]="",{pos:0};var g=e?c.slice(0,d):c.slice();g.splice(d,0,b);var h=g.join(''),j=a.inputmask.escapeRegex.call(this,f.groupSeparator);h=h.replace(new RegExp(j,"g"),'');var k=f.regex.number(f).test(h);if(!k&&(h+="0",k=f.regex.number(f).test(h),!k)){var l=h.lastIndexOf(f.groupSeparator);for(i=h.length-l;i<=3;i++)h+="0";if(k=f.regex.number(f).test(h),!k&&!e&&b==f.radixPoint&&(k=f.regex.number(f).test("0"+h+"0")))return c[d]="0",d++,{pos:d}}if(0!=k&&!e&&b!=f.radixPoint){var m=f.postFormat(c,d,!1,f);return{pos:m}}return k},cardinality:1,prevalidator:null}},insertMode:!0,autoUnmask:!1},integer:{regex:{number:function(b){var c=a.inputmask.escapeRegex.call(this,b.groupSeparator),d="["+(b.allowPlus?"+":"")+(b.allowMinus?"-":"")+"]?";return new RegExp("^"+d+"(\\d+|\\d{1,"+b.groupSize+"}(("+c+"\\d{"+b.groupSize+"})?)+)$")}},alias:"decimal"}})}(jQuery),function(a){a.extend(a.inputmask.defaults.aliases,{Regex:{mask:"r",greedy:!1,repeat:"*",regex:null,regexTokens:null,tokenizer:/\[\^?]?(?:[^\\\]]+|\\[\S\s]?)*]?|\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9][0-9]*|x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4}|c[A-Za-z]|[\S\s]?)|\((?:\?[:=!]?)?|(?:[?*+]|\{[0-9]+(?:,[0-9]*)?\})\??|[^.?*+^${[()|\\]+|./g,quantifierFilter:/[0-9]+[^,]/,definitions:{r:{validator:function(a,b,c,d,e){function f(){var a,b,c={isQuantifier:!1,matches:[],isGroup:!1},d=[];for(e.regexTokens=[];a=e.tokenizer.exec(e.regex);)switch(b=a[0],b.charAt(0)){case"[":case"\\":c.isGroup!==!0&&(c={isQuantifier:!1,matches:[],isGroup:!1},e.regexTokens.push(c)),d.length>0?d[d.length-1].matches.push(b):c.matches.push(b);break;case"(":c={isQuantifier:!1,matches:[],isGroup:!0},d.push(c);break;case")":var f=d.pop();d.length>0?d[d.length-1].matches.push(f):(c=f,e.regexTokens.push(c));break;case"{":var g={isQuantifier:!0,matches:[b],isGroup:!1};d.length>0?d[d.length-1].matches.push(g):c.matches.push(g);break;default:d.length>0?d[d.length-1].matches.push(b):c.matches.push(b)}}function g(a,b){var c=!1;b&&(i+="(",k++);for(var d=0;d<a.matches.length;d++){var f=a.matches[d];if(1==f.isGroup)c=g(f,!0);else if(1==f.isQuantifier){f=f.matches[0];for(var h=e.quantifierFilter.exec(f)[0].replace("}",""),j=i+"{1,"+h+"}",m=0;k>m;m++)j+=")";var n=new RegExp("^"+j+"$");c=n.test(l),i+=f}else{i+=f;for(var j=i.replace(/\|$/,""),m=0;k>m;m++)j+=")";var n=new RegExp("^"+j+"$");c=n.test(l)}if(c)break}return b&&(i+=")",k--),c}null==e.regexTokens&&f();var h=b.slice(),i="",j=!1,k=0;h.splice(c,0,a);for(var l=h.join(''),m=0;m<e.regexTokens.length;m++){var n=e.regexTokens[m];if(j=g(n,i,n.isGroup))break}return j},cardinality:1}}}})}(jQuery);/*! 
* MD5 js implementation (RFC 1321) - v2.1 
* Copyright (c) 2002 Paul Johnston; Licensed BSD */
var hexcase=0,b64pad="",chrsz=8;/*! 
* qinoa-ui - v1.0.0
* https://github.com/cedricfrancoys/qinoa
* Copyright (c) 2015 Cedric Francoys; Licensed GPLv3 */
!function(a,b){a(document).bind('keydown',function(a){a.ctrlKey&&a.shiftKey&&a.altKey&&b.console.show()}),a.extend(!0,b,{conf:{dialog_width:700},schemas:[],i18n:[],views:[],fields:[],console:{stack:a('<p/>'),log:function(a){this.stack.append(a+"<br/>")},show:function(){'undefined'==typeof this.dia&&(this.dia=a('<div/>').append(a('<div/>').css({'font-size':'11px',height:'200px',overflow:'scroll',border:'solid 1px grey'}).append(this.stack)).dialog({modal:!1,title:'Qinoa console',width:700,height:'auto'})),this.dia.dialog('open')}},dialog:function(c){c=a.extend({content:a('<div/>'),modal:!0,title:'',width:b.conf.dialog_width,height:'auto',minHeight:100,buttons:[{text:"Ok",click:function(){a(this).dialog("destroy")}}],position:{my:"center top",at:"center top",of:window}},c);var d=a('<div/>').css({position:'absolute',left:'-10000px'}).append(c.content).appendTo(a('body')),e=d.height()+50,f=a(window).height();f>e&&(c.position={my:"center top",at:"center top+"+(f-e)/3,of:window}),c.content.detach(),d.remove();var g=a('<div/>').attr('title',c.title).append(c.content).dialog(c).on('dialogclose',function(b,c){a(window).scrollTop(0),g.dialog('destroy')});return e>f&&a(window).scrollTop(0),g},alert:function(c){var d={title:'Alert',message:''};!function(c){b.dialog({content:a('<div/>').css({padding:'10px'}).html(c.message),title:c.title,buttons:[{text:"Close",click:function(){a(this).dialog("destroy")}}]})}(a.extend(d,c))},confirm:function(c){var d={title:'Confirm',message:''};return function(c){var d=a.Deferred();return b.dialog({content:a('<div/>').css('padding','10px').html(c.message),title:c.title,buttons:[{text:"Yes",click:function(){a(this).dialog("destroy"),d.resolve()}},{text:"No",click:function(){a(this).dialog("destroy"),d.reject()}}]}),d.promise()}(a.extend(d,c))},loader:{show:function(b){b.prepend(a('<div/>').addClass('qLoader').append(a('<div/>').addClass('ui-overlay').append(a('<div/>').addClass('ui-widget-overlay')).append(a('<div/>').addClass('ui-widget-shadow ui-corner-all'))).append(a('<div/>').addClass('qinoa-ui-loader ui-corner-all')))},hide:function(b){a('.qLoader',b).remove()}},find:function(c,d,e,f,g,h,i,j){var k=a.Deferred();return a.when(b.search(c,e,f,g,h,i,j)).done(function(e){a.when(b.read(c,e,d,j)).done(function(b){var c={};a.each(e,function(a,d){b[d].id=d,c[a]=b[d]}),k.resolve(c)}).fail(function(a){k.reject(a)})}).fail(function(){k.reject(b.conf.UNKNOWN_ERROR)}),k.promise()},getObjectPackageName:function(a){return a.substr(0,a.indexOf('\\'))},getObjectName:function(a){return a.substr(a.indexOf('\\')+1)},get_schema:function(c){var d=a.Deferred(),e=b.getObjectPackageName(c),f=this.getObjectName(c);return'undefined'==typeof b.schemas[e]&&(b.schemas[e]=[]),'undefined'==typeof b.schemas[e][f]?a.ajax({type:'GET',url:'index.php?get=core_objects_schema&class_name='+c,async:!0,dataType:'json',contentType:'application/json; charset=utf-8',success:function(a){var g=!1;'number'==typeof a.result?b.console.log('Error raised by qinoa.get_schema('+c+'): '+b.error_codes[a.result]):'object'==typeof a.result&&(g=a.result),b.schemas[e][f]=g,d.resolve(g)},error:function(a){b.schemas[e][f]=!1,d.resolve(!1)}}):d.resolve(b.schemas[e][f]),d.promise()},get_lang:function(c,d){var e=a.Deferred(),f=this.getObjectPackageName(c);return'undefined'==typeof b.i18n[f]&&(b.i18n[f]=[]),'undefined'==typeof b.i18n[f][c]?a.ajax({type:'GET',url:'index.php?get=core_i18n_lang&class_name='+c+'&lang='+d,async:!0,dataType:'json',contentType:'application/json; charset=utf-8',success:function(a){var g=!1;'number'==typeof a.result?b.console.log('Error raised by qinoa.get_lang('+c+', '+d+'): '+b.error_codes[a.result]):'object'==typeof a.result&&(g=a.result),b.i18n[f][c]=g,e.resolve(g)},error:function(a){b.i18n[f][c]=!1,e.resolve(!1)}}):e.resolve(b.i18n[f][c]),e.promise()},get_view:function(c,d){var e=a.Deferred();if(null===c||null===d)e.reject(b.conf.MISSING_PARAM);else{var f=b.getObjectPackageName(c),g=b.getObjectName(c);'undefined'==typeof b.views[f]&&(b.views[f]=[]),'undefined'==typeof b.views[f][g]&&(b.views[f][g]=[]),'undefined'==typeof b.views[f][g][d]?a.ajax({type:'GET',url:'index.php?get=core_objects_view&class_name='+c+'&view_name='+d,async:!0,dataType:'json',contentType:'application/json; charset=utf-8'}).done(function(a){try{if('object'!=typeof a)throw Error(b.conf.UNKNOWN_ERROR);if('number'==typeof a.result)throw Error(a.result);if('string'!=typeof a.result)throw Error(b.conf.UNKNOWN_OBJECT);b.views[f][g][d]=a.result,e.resolve(a.result)}catch(c){e.reject(c.message)}}).fail(function(){b.views[f][g][d]=!1,e.reject(b.conf.UNKNOWN_ERROR)}):e.resolve(b.views[f][g][d])}return e.promise()},get_fields:function(c,d){var e=a.Deferred();if(null===c||null===d)e.reject(b.conf.MISSING_PARAM);else{var f=this.getObjectPackageName(c),g=this.getObjectName(c);if('undefined'==typeof b.fields[f]&&(b.fields[f]=[]),'undefined'==typeof b.fields[f][g]&&(b.fields[f][g]=[]),'undefined'==typeof b.fields[f][g][d]){b.fields[f][g][d]={};var h;switch(d.split('.')[0]){case'form':h='var';break;case'report':case'list':h='li'}a.when(b.get_view(c,d)).done(function(i){if(i){var j=a({});a('<div/>').append(i).find(h).each(function(){var e=this,h=a(this).attr('id');j.queue(function(i){var j={};a.each(e.attributes,function(a,b){j[b.name]=b.value}),b.fields[f][g][d][h]=j;var k=h.split('.');if(k.length>1){var l=a({});l.sub_class_name=c,l.sub_package_name=f,l.sub_object_name=g,a.each(k,function(c,d){l.queue(function(c){a.when(b.get_schema(l.sub_class_name)).done(function(a){var e=b.schemas[l.sub_package_name][l.sub_object_name][d].type;b.schemas[f][g][h]={},b.schemas[f][g][h].type=e,'undefined'!=typeof b.schemas[l.sub_package_name][l.sub_object_name][d].foreign_object&&(l.sub_class_name=b.schemas[l.sub_package_name][l.sub_object_name][d].foreign_object,l.sub_package_name=b.getObjectPackageName(l.sub_class_name),l.sub_object_name=b.getObjectName(l.sub_class_name)),c()}).fail(function(a){c()})})}),l.queue(function(a){i()})}else i()})}),j.queue(function(a){e.resolve(b.fields[f][g][d])})}else e.reject(b.conf.UNKNOWN_ERROR)}).fail(function(a){b.console.log('Error in qinoa-ui raised by qinoa.get_view('+c+','+d+'): '+b.error_codes[a])})}else e.resolve(b.fields[f][g][d])}return e.promise()}})}(jQuery,qinoa),function(a){qinoa.GridCells={string:function(b,c){var d;return'view'==c.mode?d=a('<span/>').text(c.value[c.id]):'edit'==c.mode&&(d=a('<input type="text"/>').attr({name:c.name}).uniqueId().css({'box-sizing':'border-box',width:'100%','text-align':c.align}).val(c.value[c.id]).data('value',function(){return a(this).val()}),c.readonly&&d.attr('disabled','disabled').addClass('ui-state-disabled'),c.required&&d.addClass('required')),d},'boolean':function(a,b){return qinoa.GridCells.string(a,b)},integer:function(a,b){return qinoa.GridCells.string(a,b)},'float':function(a,b){return qinoa.GridCells.string(a,b)},date:function(b,c){var d,e=a.datepicker.formatDate(qinoa.conf.QN_DATE_FORMAT,Date.parse(c.value[c.id]));return'view'==c.mode?d=a('<span/>').text(e):'edit'==c.mode&&(d=a('<input type="text"/>').attr({name:c.name}).uniqueId().css({'box-sizing':'border-box',width:'100%','text-align':c.align}).val(c.value[c.id]).data('value',function(){return a(this).val()}),c.readonly&&d.attr('disabled','disabled').addClass('ui-state-disabled'),c.required&&d.addClass('required')),d},datetime:function(b,c){var d,e=c.value[c.id];return'view'==c.mode?d=a('<span/>').text(e):'edit'==c.mode&&(d=a('<input type="text"/>').attr({name:c.name}).uniqueId().css({'box-sizing':'border-box',width:'100%','text-align':c.align}).val(c.value[c.id]).data('value',function(){return a(this).val()}),c.readonly&&d.attr('disabled','disabled').addClass('ui-state-disabled'),c.required&&d.addClass('required')),d},many2one:function(b,c){var d=a('<a/>').addClass('ui-state-default').attr('href','#');return a.each(c.fields,function(a,b){a>0&&d.append(a>1?', '+c.value[b]:c.value[b])}),d.on('click',function(){var d=c.value[c.id],e='form.default',f=a('<form/>').qForm(a.extend(!0,c,{view:e,object_id:d,predefined:{class_name:c.class_name,ids:d,lang:c.lang}})).on('ready',function(){$dia=qinoa.dialog({content:f,title:'Object edition: '+c.class_name+' ('+d+') - '+e,buttons:[]}).on('formclose',function(a,c){'undefined'!=typeof c&&'cancel'!=c&&b.closest('.ui-grid').trigger('reload'),$dia.trigger('dialogclose')})})}),d}},a.fn.qGridCell=function(b){var c={mode:'view',type:'string'};return this.each(function(){return function(a,b){try{if('undefined'==typeof qinoa.GridCells[b.type])throw Error('Error raised in qinoa-ui.qGridCell : unknown type '+b.type);var c=qinoa.GridCells[b.type](a,b);return a.data('widget',c.appendTo(a))}catch(d){qinoa.console.log(b.type+' '+b.name+d.message)}}(a(this),a.extend(!0,c,b))})}}(jQuery),function(a,b){a.fn.qGrid=function(c){var d={columns:[],fields:[],more:[],less:[],selection:{},class_name:'',view:'list.default',multiple:!0,rp:20,rp_choices:[5,10,20,40,80,160],page:1,total:0,records:0,sortname:'id',sortorder:'asc',domain:[[]],lang:b.conf.content_lang,ui:b.conf.user_lang,views:{edit:'form.default',add:'list.default'},buttons:{edit:{text:'edit',icon:'fa fa-pencil'},del:{text:'delete',icon:'fa fa-trash'},add:{text:'create new',icon:'fa fa-file-o'}},actions:{}};return load_view=function(c,d){var e=a.Deferred();d.columns=[],d.fields=[],d.more=[],d.less=[],d.selection={};var f,g,h;return a({}).queue(function(c){a.when(b.get_schema(d.class_name)).done(function(a){f=a,c()}).fail(function(a){e.reject(a)})}).queue(function(c){a.when(b.get_view(d.class_name,d.view)).done(function(b){h=a(b),c()}).fail(function(a){e.reject(a)})}).queue(function(c){a.when(b.get_fields(d.class_name,d.view)).done(function(a){g=a,c()}).fail(function(a){e.reject(a)})}).queue(function(c){a.each(h[0].attributes,function(a,c){switch(c.name){case'domain':try{d.domain=JSON.parse(c.value.replace(/\'/g,'"'))}catch(e){b.console.log("Error raised in qinoa-ui.qGrid::load_view ("+d.view+"): attribute 'domain' has invalid syntax")}break;case'views':try{d.views=JSON.parse(c.value.replace(/\'/g,'"'))}catch(e){b.console.log("Error raised in qinoa-ui.qGrid::load_view ("+d.view+"): attribute 'views' has invalid syntax")}break;default:d[c.name]=c.value}});var i=a({});a.each(g,function(c,e){i.queue(function(g){var h=c,i=e.width;if(parseInt(i)>0){var j=a.extend({name:h,fields:[]},e);j.fields.push(c),d.fields.push(c),'undefined'!=typeof f[c].foreign_object&&void 0!=e.view?a.when(b.get_fields(f[c].foreign_object,e.view)).done(function(b){a.each(b,function(a,b){var c=h+'.'+a;d.fields.push(c),j.fields.push(c)}),d.columns.push(j),g()}).fail(function(a){console.log('failed')}):(d.columns.push(j),g())}})}),i.queue(function(a){e.resolve()})}),e.promise()},render=function(b,c){var d=a.Deferred(),e=a('<table/>').addClass('grid_table ui-widget-content'),f=a('<thead/>').addClass('grid_table_head ui-widget-content'),g=a('<tbody/>').addClass('grid_table_body ui-widget-content'),h=a('<tr/>').addClass('grid_table_head_row'),i=a('<th/>').addClass('ui-state-default').css({width:'30px'}).append(a('<div/>').css({width:'30px'}).append(a('<input type="checkbox" />').addClass('checkbox').css({width:'20px'}).on('click',function(){var b=this.checked;a("input:checkbox",g).each(function(d,e){var f=a(this).parents('tr.grid_table_body_row').first(),g=f.attr('id');b?(f.addClass('ui-state-active'),e.checked=!0,c.selection[g]=!0):(f.removeClass('ui-state-active'),e.checked=!1,delete c.selection[g])})}))).appendTo(h);return c.multiple||a('input',i).attr('disabled','disabled'),a.each(c.columns,function(d,e){i=a('<th/>').attr('name',e.id).addClass('ui-state-default').css({width:e.width,'text-align':'left'}).append(a('<div/>').append(a('<label/>').attr('for',e.id))).append(a('<span/>').addClass('ui-icon')).hover(function(){$this=a(this).addClass('ui-state-hover'),$div=a('div',$this),$span=a('span',$this),a('.sorted',f).attr('name')==$this.attr('name')&&'asc'==c.sortorder?($div.removeClass('asc').addClass('desc'),$span.removeClass('ui-icon-triangle-1-n').addClass('ui-icon-triangle-1-s')):($div.removeClass('desc').addClass('asc'),$span.removeClass('ui-icon-triangle-1-s').addClass('ui-icon-triangle-1-n'))},function(){$this=a(this).removeClass('ui-state-hover'),$div=a('div',$this),$span=a('span',$this),$div.removeClass('asc').removeClass('desc'),$span.removeClass('ui-icon-triangle-1-n').removeClass('ui-icon-triangle-1-s'),a('.sorted',f).attr('name')==$this.attr('name')&&($this.hasClass('asc')?($div.addClass('asc'),$span.addClass('ui-icon-triangle-1-n')):($div.addClass('desc'),$span.addClass('ui-icon-triangle-1-s')))}).on('click',function(){$this=a(this),$sorted=a('.sorted',f),$div=a('div',$this),$span=a('span',$this),$sorted.attr('name')==$this.attr('name')?$div.hasClass('asc')?($div.removeClass('asc').addClass('desc'),$span.removeClass('ui-icon-triangle-1-n').addClass('ui-icon-triangle-1-s'),$this.removeClass('desc').addClass('asc'),c.sortorder='asc'):($div.removeClass('desc').addClass('asc'),$span.removeClass('ui-icon-triangle-1-s').addClass('ui-icon-triangle-1-n'),$this.removeClass('asc').addClass('desc'),c.sortorder='desc'):($this.addClass('sorted').addClass('asc'),$div.removeClass('asc').addClass('desc'),$span.removeClass('ui-icon-triangle-1-n').addClass('ui-icon-triangle-1-s'),$sorted.removeClass('sorted asc desc'),a('div',$sorted).removeClass('asc desc'),a('span',$sorted).removeClass('ui-icon-triangle-1-n ui-icon-triangle-1-s'),c.sortorder='asc'),c.sortname=$this.attr('name'),a("input:checkbox",f)[0].checked=!1,feed(b,c)}),e.id==c.sortname&&(i.addClass('sorted').addClass(c.sortorder),a('div',i).addClass(c.sortorder)),h.append(i)}),b.addClass('ui-grid ui-front ui-widget ui-widget-content ui-corner-all').append(e.append(f.append(h)).append(g)),d.resolve(),d.promise()},translate=function(c,d){var e,f,g=a.Deferred();return a({}).queue(function(c){a.when(b.get_schema(d.class_name)).done(function(a){e=a,c()})}).queue(function(c){a.when(b.get_lang(d.class_name,d.ui)).done(function(a){f=a,c()})}).queue(function(b){'object'!=typeof f||a.isEmptyObject(f)?(a('label[name],legend[name],button[name]',c).each(function(){a(this).text(ucfirst(a(this).attr('name')))}),a('label[for]',c).each(function(){a(this).text(ucfirst(a(this).attr('for')))})):(a('label[name],legend[name],button[name]',c).each(function(){var b=a(this).attr('name');if('undefined'!=typeof b)if('undefined'!=typeof f.view[b]){var c=f.view[b].label;a(this).text(c)}else a(this).text(ucfirst(b))}),a('label[for]',c).each(function(){var b=a(this).attr('for');void 0!=b&&('undefined'!=typeof f.model[b]&&'undefined'!=typeof f.model[b].label?(a(this).text(f.model[b].label),'undefined'!=typeof f.model[b].help&&a(this).append(a('<sup/>').attr('title',f.model[b].help.replace(/\n/g,'<br />')).addClass('help').text('?').tooltip())):a(this).text(ucfirst(b)))})),g.resolve()}),g.promise()},init=function(c,d){var e=a.Deferred();return a.when(b.search(d.class_name,d.domain,d.sortname,d.sortorder,0,0,d.lang)).done(function(b){d.records=Object.keys(b).length,d.total=Math.ceil(d.records/d.rp),a.when(feed(c,d)).done(function(){e.resolve()}).fail(function(a){console.log('feed failed')})}).fail(function(a){b.console.log('Error raised in qinoa-ui.qGrid::init by qinoa.search(): '+b.error_codes[a]),e.reject(a)}),e.promise()},feed=function(c,d){var e=a.Deferred();$tbody=a('.grid_table_body',c),b.loader.show(c);var f=a.extend(!0,[],d.domain);d.more.length&&f.push([['id','in',d.more]]),d.less.length&&f[0].push(['id','not in',d.less]);var g,h=(d.page-1)*d.rp;return a({}).queue(function(c){a.when(b.get_schema(d.class_name)).done(function(a){g=a,c()})}).queue(function(i){a.when(b.find(d.class_name,d.fields,f,d.sortname,d.sortorder,h,d.rp,d.lang)).done(function(f){$tbody.empty(),a.each(f,function(b,e){var f=e.id;$row=a('<tr/>').addClass('grid_table_body_row ui-state-default').attr('id',f).append(a('<td/>').addClass('grid_table_body_row_checkbox').append(a('<input type="checkbox" />').addClass('checkbox').css({width:'20px'}).on('click',function(){var b=a(this).parents('tr.grid_table_body_row').first(),e=b.attr('id');this.checked?(d.multiple||(a('.grid_table_body_row_checkbox > input',c).prop('checked',!1),a('.grid_table_body_row',c).removeClass('ui-state-active'),d.selection={}),this.checked=!0,d.selection[e]=!0):delete d.selection[e],b.toggleClass('ui-state-active')}))).toggleClass('erow',b%2==1),a.each(d.columns,function(b,c){var f={};a.each(c.fields,function(a,b){f[b]=e[b]});var h='function'==g[c.id].type?g[c.id].result_type:g[c.id].type,i=a.extend({mode:'view',type:'undefined'!=typeof c.widget?c.widget:h,value:f,lang:d.lang},c);void 0!=i.widget&&(i.type=i.widget),'undefined'!=typeof g[c.id].foreign_object&&(i.class_name=g[c.id].foreign_object),$row.append(a('<td/>').append(a('<div/>').qGridCell(i)))}),'undefined'!=typeof d.selection[f]&&(a('.checkbox',$row).prop('checked',!0),$row.toggleClass('ui-state-focus')),$tbody.append($row)}),a('.ui-grid-pager',c).remove(),a('.ui-grid-footer',c).remove(),c.prepend(pager(c,d).addClass('ui-corner-top')),c.append(pager(c,d)),c.append(footer(c,d).addClass('ui-corner-bottom')),b.loader.hide(c),e.resolve()}).fail(function(a){b.console.log('Error raised in qinoa-ui.qGrid::feed by qinoa.find(): '+b.error_codes[a])})}),e.promise()},pager=function(b,c){var d=a('<span/>').addClass('separator').text(' | '),e=a('<div/>').css({left:'5px'});a.each(c.buttons,function(d,f){a.isEmptyObject(f)||a('<span/>').attr('title',f.text).button({icons:{primary:f.icon},text:!1}).on('click',function(){'function'==typeof c.actions[d]&&c.actions[d](b,c)}).appendTo(e)});var f=a('<div/>').addClass('ui-front').css('right','10px').append(a('<span/>').append(function(a,b){var d=(c.page-1)*c.rp;d>0&&d++;var e=Math.min(d+parseInt(c.rp)-1,c.records);return'Results '+d+' - '+e+' of '+c.records})).append(d.clone()).append(a('<span/>').html('Show&nbsp;&nbsp;'));$select=a('<select/>').css('width','45px'),a.each(c.rp_choices,function(b,d){$option=a('<option/>').attr({value:d}).html(d),c.rp==d&&$option.prop('selected',!0),$option.appendTo($select)}),$select.appendTo(f).selectmenu({change:function(a,d){c.rp=this.value,c.page=1,c.total=Math.ceil(c.records/c.rp),b.trigger('reload')}});var g=a('<div/>').css({left:'50%','margin-left':'-190px'}).append(a('<span/>').attr('title','first').button({icons:{primary:'ui-icon-seek-start'},text:!1}).on('click',function(){var a=1;c.page!=a&&(c.page=a,b.trigger('reload'))})).append(a('<span/>').attr('title','prev').button({icons:{primary:'ui-icon-seek-prev'},text:!1}).on('click',function(){var a=Math.max(parseInt(c.page)-1,1);c.page!=a&&(c.page=a,b.trigger('reload'))})).append(d.clone()).append(a('<span/>').append('Page '+c.page+' of '+c.total)).append(d.clone()).append(a('<span/>').attr('title','next').button({icons:{primary:'ui-icon-seek-next'},text:!1}).on('click',function(){var a=Math.min(parseInt(c.page)+1,c.total);c.page!=a&&(c.page=a,b.trigger('reload'))})).append(a('<span/>').attr('title','last').button({icons:{primary:'ui-icon-seek-end'},text:!1}).on('click',function(){var a=c.total;c.page!=a&&(c.page=a,b.trigger('reload'))}));return a('<div/>').addClass('ui-grid-pager ui-widget-header ui-front').append(e).append(f).append(g)},footer=function(b,c){var d={show:'core_objects_view',view:c.view_name,object_class:c.class_name,domain:c.domain,rp:c.rp,page:c.page,sortname:c.sortname,sortorder:c.sortorder,fields:c.fields};return a('<div/>').addClass('ui-grid-footer ui-state-default').append(a('<div/>').css('margin-left','7px').append(a('<span/>').text('Export:')).append(a('<a/>').css({margin:'0px 5px'}).attr('href','?index.php&'+a.param(a.extend(d,{output:'pdf'}))).attr('target','_blank').append('pdf')).append(a('<span/>').text('|')).append(a('<a/>').css({margin:'0px 5px'}).attr('href','?index.php&'+a.param(a.extend(d,{output:'xls'}))).attr('target','_blank').append('xls')).append(a('<span/>').text('|')).append(a('<a/>').css({margin:'0px 5px'}).attr('href','?index.php&'+a.param(a.extend(d,{output:'csv'}))).attr('target','_blank').append('csv')))},listen=function(c,d){'undefined'==typeof d.actions.edit&&(d.actions.edit=function(c,d){if(Object.keys(d.selection).length<=0)return b.alert({message:"<p><b>No item selected.</b></p><p>To edit an object, click its checkbox prior to the 'edit' button.</p>"}),!1;var e=Object.keys(d.selection)[0],f=b.form(a.extend(!0,d,{view:d.views.edit,object_id:e,predefined:{class_name:d.class_name,ids:e,lang:d.lang}})).on('ready',function(){$dia=b.dialog({content:f,title:'Object edition: '+d.class_name+' ('+e+') - '+d.views.edit,buttons:[]}).on('formclose',function(a,b){'undefined'!=typeof b&&'cancel'!=b&&c.trigger('reload'),$dia.trigger('dialogclose')})})}),'undefined'==typeof d.actions.del&&(d.actions.del=function(c,d){var e=Object.keys(d.selection);return e.length<=0?(b.alert({message:"<p><b>No item selected.</b></p><p>To delete an object, click its checkbox prior to the 'delete' button.</p>"}),!1):void a.when(b.confirm({message:'<p><b>'+e.length+" items selected.</b></p>Do you confirm deletion for selected item(s) ?",title:'Deletion'})).done(function(){a.when(b.remove(d.class_name,e,!1)).done(function(){c.trigger('reload')})})}),'undefined'==typeof d.actions.add&&(d.actions.add=function(c,d){var e=0;a.when(b.create(d.class_name,{},d.lang)).done(function(f){e=f;var g=b.form(a.extend(!0,d,{view:d.views.edit,object_id:e,predefined:{class_name:d.class_name,ids:e,lang:d.lang}})).on('ready',function(){$dia=b.dialog({content:g,title:'New object: '+d.class_name+' - '+d.views.edit,buttons:[]}).on('formclose',function(a,b){'undefined'!=typeof b&&'cancel'!=b&&c.trigger('reload'),$dia.trigger('dialogclose')})})}).fail(function(a){b.console.log('Error raised by qinoa.create(): '+b.error_codes[a])})})},this.each(function(){return function(b,c){return b.hide(),a.when(load_view(b,c)).then(function(){return render(b,c)}).then(function(){return translate(b,c)}).then(function(){return init(b,c)}).then(function(){listen(b,c),b.trigger('ready')}),b.on('reload',function(){feed(b,c)}).on('ready',function(){b.data('conf',c),b.show()})}(a(this),a.extend(!0,d,c))})}}(jQuery,qinoa),function(a,b){b.FormWidgets={string:function(b,c){var d=a('<input type="text"/>').attr({id:c.id,name:c.name}).addClass('ui-widget').css({'box-sizing':'border-box',width:'100%','text-align':c.align}).val(c.value).on('ready',function(){b.trigger('ready')}).data('value',function(){return d.val()});return c.readonly&&d.attr('disabled','disabled').addClass('ui-state-disabled'),c.required&&(d.attr('aria-required','true'),d.addClass('required')),d.trigger('ready')},integer:function(a,c){var d=b.FormWidgets.string(a,c);return d.inputmask('integer',{allowMinus:!0})},'float':function(a,c){var d=b.FormWidgets.string(a,c);return d.inputmask('decimal',{radixPoint:b.conf.QN_NUMERIC_DECIMAL_POINT,digits:b.conf.QN_NUMERIC_DECIMAL_PRECISION,autoGroup:!1})},date:function(a,c){var d=b.FormWidgets.string(a,c);return d.datepicker({dateFormat:b.conf.QN_DATE_FORMAT,yearRange:'c-70:c+20',changeMonth:!0,changeYear:!0})},datetime:function(a,c){var d=b.FormWidgets.string(a,c);return d.datetimepicker({dateFormat:b.conf.QN_DATE_FORMAT,timeFormat:b.conf.QN_TIME_FORMAT,yearRange:'c-70:c+20',changeMonth:!0,changeYear:!0})},time:function(a,c){var d=b.FormWidgets.string(a,c);return d.timepicker({timeFormat:b.conf.QN_TIME_FORMAT})},timestamp:function(a,b){},'boolean':function(b,c){if('edit'==c.mode){var d=a('<input type="checkbox" value="1" />').attr({id:c.id,name:c.name}).prop('checked',parseInt(c.value)>0).val(parseInt(c.value)>0?1:0).on('change',function(){this.value=+this.checked}).on('ready',function(){b.trigger('ready')}).data('value',function(){return d.val()});return c.readonly&&d.attr('disabled','disabled').addClass('ui-state-disabled'),c.required&&d.addClass('required'),d.trigger('ready')}'view'==c.mode},password:function(b,c){var d=a('<input type="password"/>').attr({id:c.id,name:c.name}).css({'box-sizing':'border-box',width:'100%','text-align':c.align}).val(c.value).on('ready',function(){b.trigger('ready')}).data('value',function(){return d.val()});return c.readonly&&d.attr("disabled","disabled").addClass('ui-state-disabled'),c.required&&d.addClass('required'),d.trigger('ready')},short_text:function(b,c){var d=a('<textarea/>').attr({id:c.id,name:c.name}).addClass('ui-widget').css({'box-sizing':'border-box',width:'100%','text-align':c.align}).html(c.value).on('ready',function(){b.trigger('ready')}).data('value',function(){return d.val()});return c.readonly&&d.attr("disabled","disabled").addClass('ui-state-disabled'),c.required&&d.addClass('required'),d.trigger('ready')},text:function(b,c){var d=a('<textarea/>').hide().attr({id:c.id,name:c.name}).html(c.value).on('ready',function(){b.trigger('ready')}).data('value',function(){return d.val()}),e=a('<div/>').html(c.value).richtext({toolbar:[['Maximize'],['Source'],['Undo','Redo'],['Cut','Copy','Paste'],['Bold','Italic','Underline','Strike','-','Subscript','Superscript','-','RemoveFormat'],'/',['TextColor'],['JustifyLeft','JustifyCenter','JustifyRight','JustifyBlock'],['NumberedList','BulletedList','-','Outdent','Indent','-','Blockquote'],['Anchor','Link','Image','Table']]}).on('change',function(){d.val(e.richtext('value')).trigger('change')}).appendTo(b);return c.required&&d.addClass('required'),d.trigger('ready')}},a.fn.qFormWidget=function(c){var d={mode:'edit',name:'',value:'',type:'string',format:'',align:'left',readonly:!1,required:!1};return this.each(function(){return function(a,c){try{if('undefined'==typeof b.FormWidgets[c.type])throw Error('Error raised in qinoa-ui.qFormWidget : unknown type '+c.type);var d=b.FormWidgets[c.type](a,c);return a.data('widget',d.appendTo(a))}catch(e){b.console.log(c.type+' '+c.name+e.message)}}(a(this),a.extend(!0,d,c))})}}(jQuery,qinoa),function(a,b){b.FormWidgets.many2one=function(c,d){var e={view:'list.default'};return function(c,d){var e=a('<input type="hidden"/>').attr({id:d.id,name:d.name}).val(d.value).data('value',function(){return e.val()});return a.when(b.get_fields(d.class_name,d.view)).done(function(f){d.fields=Object.keys(f),a('<div/>').css({position:'relative'}).addClass('ui-widget').append(a('<input/>').addClass('choice_input').css({'box-sizing':'border-box',width:'calc(100% - 5em)','text-align':d.align}).autocomplete({minLength:4,delay:500,source:function(c,e){a.when(b.search(d.class_name,[[[d.fields[0],'ilike','%'+c.term+'%']]],d.fields[0],'asc',0,25,d.lang)).done(function(c){var f=[];Object.keys(c).length>0&&a.when(b.read(d.class_name,c,d.fields[0],d.lang)).done(function(b){a.each(c,function(a,c){f.push({label:b[c][d.fields[0]],value:c})}),e(f)}).fail(function(a){b.console.log('Error raised by qinoa.read('+d.class_name+') in qinoa.FormWidgets.many2one: '+b.error_codes[a])})}).fail(function(a){b.console.log('Error raised by qinoa.search('+d.class_name+','+d.fields[0]+') in qinoa.FormWidgets.many2one: '+b.error_codes[a])})},select:function(b,c){return e.val(c.item.value).trigger('change'),a(b.target).val(c.item.label).trigger('feed'),!1}}).on('feed',function(){var f=e.val();0>=f?c.trigger('ready'):a.when(b.read(d.class_name,f,d.fields,d.lang)).done(function(b){var e='';a.each(d.fields,function(a,c){e.length&&(e+=', '),e+=b[f][c]}),a('.choice_input',c).val(e).blur(),c.trigger('ready')})}).trigger('feed')).append(a('<button type="button"/>').button({icons:{primary:'ui-icon-pencil'},text:!1}).attr('title','edit').css({position:'absolute',right:'2.5em',top:'0',margin:'0',height:'100%'}).on('click',function(){var f=e.val(),g='form.default',h=a('<form/>').qForm(a.extend(!0,d,{view:g,object_id:f,predefined:{class_name:d.class_name,ids:f,lang:d.lang}})).on('ready',function(){$dia=b.dialog({content:h,title:'Object edition: '+d.class_name+' ('+f+') - '+g,buttons:[]}).on('formclose',function(b,d){'undefined'!=typeof d&&'cancel'!=d&&a('.choice_input',c).trigger('feed'),$dia.trigger('dialogclose')})})})).append(a('<button type="button"/>').button({icons:{primary:'ui-icon-search'},text:!1}).attr('title','search').css({position:'absolute',right:'0',top:'0',margin:'0',height:'100%'}).on('click',function(){var f=a.extend(!0,{multiple:!1},d),g=a('<div/>').qSearchGrid(f).on('ready',function(){b.dialog({content:g,title:'Choose item',buttons:[{text:"Ok",click:function(){a.each(g.data('conf').selection,function(b,d){e.val(b),c.trigger('change'),a('.choice_input',c).trigger('feed')}),a(this).trigger('dialogclose')}}]})})})).appendTo(c)}),e}(c,a.extend(!0,e,d))},b.FormWidgets.one2many=function(c,d){var e=a('<input type="hidden"/>').attr({id:d.id,name:d.name}).val(d.value).data('value',function(){return e.val()});return function(c,d){a.when(b.get_schema(d.parent_class)).done(function(f){var g=[[[f[d.name].foreign_field,'=',d.parent_id]]];void 0!=d.domain&&(g=merge_domains(g,d.domain));var h=a.extend(!0,d,{domain:g,buttons:{edit:{text:'edit',icon:'ui-icon-pencil'},del:{text:'delete relation',icon:'ui-icon-minus'},add:{text:'add relation',icon:'ui-icon-plus'}},actions:{add:function(c,d){var e={class_name:d.class_name,view:d.views.add,lang:d.lang};e.domain=[[[f[d.name].foreign_field,'<>',d.parent_id]]];var g=a('<div/>').qSearchGrid(e).on('ready',function(){b.dialog({content:g,title:'Add relation',buttons:[{text:"Ok",click:function(){a.each(g.data('conf').selection,function(a,b){d.more=add_value(d.more,a),d.less=remove_value(d.less,a)}),c.trigger('reload'),c.trigger('change'),a(this).trigger('dialogclose')}}]})})},del:function(c,d){var e=Object.keys(d.selection);a.when(b.confirm({message:'<p><b>'+e.length+" item(s) selected.</b></p>Do you confirm deletion for selected relations(s) ?",title:'Deletion'})).done(function(){a.each(d.selection,function(a,b){d.less=add_value(d.less,a),d.more=remove_value(d.more,a)}),c.trigger('reload'),c.trigger('change')})}}}),j=a('<div/>').qGrid(h).on('ready',function(){c.trigger('ready')}).on('change',function(){var b=j.data('conf').more.toString();a.each(j.data('conf').less,function(){b.length>0&&(b+=','),b+='-'+d.less[i]}),e.val(b),c.trigger('change')}).appendTo(c)})}(c,d),e},b.FormWidgets.many2many=function(c,d){var e=a('<input type="hidden"/>').attr({id:d.id,name:d.name}).val(d.value).on('change',function(){c.trigger('change')}).data('value',function(){return e.val()});return function(c,d){a.when(b.get_schema(d.parent_class)).done(function(f){var g=[[[f[d.name].foreign_field,'contains',d.parent_id]]];void 0!=d.domain&&(g=merge_domains(g,d.domain));var h=a.extend(!0,d,{domain:g,buttons:{edit:{text:'edit',icon:'ui-icon-pencil'},del:{text:'delete relation',icon:'ui-icon-minus'},add:{text:'add relation',icon:'ui-icon-plus'}},actions:{add:function(c,d){var e={class_name:d.class_name,view:d.views.add,lang:d.lang},f=a('<div/>').qSearchGrid(e).on('ready',function(){b.dialog({content:f,title:'Add relation',buttons:[{text:"Ok",click:function(){a.each(f.data('conf').selection,function(a,b){d.more=add_value(d.more,a),d.less=remove_value(d.less,a)}),c.trigger('reload'),c.trigger('change'),a(this).trigger('dialogclose')}}]})})},del:function(c,d){var e=Object.keys(d.selection);a.when(b.confirm({message:'<p><b>'+e.length+" item(s) selected.</b></p>Do you confirm deletion for selected relations(s) ?",title:'Deletion'})).done(function(){a.each(d.selection,function(a,b){d.less=add_value(d.less,a),d.more=remove_value(d.more,a)}),c.trigger('reload'),c.trigger('change')})}}}),j=a('<div/>').qGrid(h).on('ready',function(){c.trigger('ready')}).on('change',function(){var b=j.data('conf').more.toString();a.each(j.data('conf').less,function(){b.length>0&&(b+=','),b+='-'+d.less[i]}),e.val(b).trigger('change')}).appendTo(c)})}(c,d),e},b.FormWidgets.binary=function(b,c){var d=a('<input type="file" />').attr({id:c.name,name:c.name}).addClass('ui-widget').css({'box-sizing':'border-box',width:'100%','text-align':c.align}).on('ready',function(){b.trigger('ready')}).data('value',function(){return d.val()});return d.trigger('ready')},b.FormWidgets.image=function(b,c){var d=a('<input type="hidden"/>').attr({id:c.id,name:c.name}).val(c.value).on('change ready',function(a){b.trigger(a.type)}).data('value',function(){
return d.val()});return d.trigger('ready')}}(jQuery,qinoa),/*! 
* qinoa-ui.qForm - v1.0.0
* https://github.com/cedricfrancoys/qinoa
* Copyright (c) 2015 Cedric Francoys; Licensed GPLv3 */
function($,qinoa){"use strict";$.fn.qForm=function(conf){var default_conf={class_name:'',object_id:0,view:'form.default',lang:qinoa.conf.content_lang,ui:qinoa.conf.user_lang,predefined:{},autosave:!0,success_handler:null,modified:!1},methods={load_view:function(a,b){var c=$.Deferred();return $.when(qinoa.get_view(b.class_name,b.view)).done(function(d){var e=$(d);$.each(e[0].attributes,function(a,c){b[c.name]=c.value}),e.attr('id',a.attr('id'));var f=methods.adapt_view(e);void 0!==b.action&&f.append($('<div/>').attr('align','right').attr('width','100%').append($('<button type="button" />').attr('name','save').attr('action',b.action).attr('default','true')).append($('<button type="button" />').attr('name','cancel').attr('action','cancel'))),a.addClass('ui-form ui-front').append(f.addClass('qView').hide()),c.resolve()}),c.promise()},adapt_view:function(a){var b=function(a){var b=a.html();return b=b.replace(/(<label[^>]*>[^<]*<\/label>)/gi,'<td class="label">$1</td>'),b=b.replace(/(<var[^>]*>[^<]*<\/var>)/gi,'<td class="field">$1</td>'),b='<table><tr>'+b.replace(/<br[^\/>]*>/gi,'</tr><tr>')+'</tr></table>',a.html(b),a.find('label,var').each(function(){var b=a.attr('colspan');'undefined'!=typeof b&&a.parent().attr('colspan',b)}),a.html()},c=function(d){var e=$('<div/>'),f=!1,g=$('<ul/>'),h=$('<div/>').attr('id',a.attr('id')+'_tabs').addClass('qtab');d.children('section').each(function(){var a=$(this).attr('name'),b=$('<li/>').append($('<a/>').attr('href','#'+a+'_tab').append($('<label/>').attr('name',a))),d=c($(this)),e=$('<div/>').attr('id',a+'_tab');e.append($('<table/>').append($('<tr/>').append($('<td/>').addClass('field').append(d)))),g.append(b),h.append(e)});return h.prepend(g),d.children().each(function(){switch($(this).prop('nodeName').toLowerCase()){case'fieldset':var a=$('<fieldset/>'),d=$(this).attr('title');void 0!==d&&a.append($('<legend/>').attr('name',d)),e.append(a.append(c($(this))));break;case'span':var g=$('<div/>'),i=$(this).attr('width'),j=$(this).attr('align');i=void 0===i?100:parseInt(i),j=void 0===j?'left':j,g.css('float','left').css('text-align',j).css('width',i-2+'%').css('padding-left','1%').css('padding-right','1%'),e.append(g.append(b($(this))));break;case'div':var g=$('<div/>'),i=$(this).attr('width'),j=$(this).attr('align'),k=$(this).attr('id');i=void 0===i?100:parseInt(i),j=void 0===j?'left':j,void 0!==k&&g.attr('id',k),g.css('float','left').css('text-align',j).css('width',i+'%'),e.append(g.append(c($(this))));break;case'section':if(f)break;e.append(h),f=!0;break;default:e.append($(this))}}),e.children()};return c(a)},feed:function(a,b){var c,d,e=$.Deferred();return $({}).queue(function(a){$.when(qinoa.get_schema(b.class_name)).done(function(b){c=b,a()})}).queue(function(a){$.when(qinoa.get_fields(b.class_name,b.view)).done(function(b){d=b,a()})}).queue(function(f){var g=[];$.each(d,function(a,b){$.inArray(c[a].type,qinoa.simple_types)>=0&&g.push(a)}),$.when(qinoa.read(b.class_name,b.object_id,g,b.lang)).done(function(c){'undefined'!=typeof c[b.object_id]&&$.each(c[b.object_id],function(b,c){$('#'+b,a).data('value',c)}),e.resolve(),f()})}),e.promise()},render:function($form,conf){var deferred=$.Deferred();$('var,label,button,section,div,span',$form).each(function(){var attr_visible=$(this).attr('visible');void 0===attr_visible||eval(attr_visible)||$(this).hide()}),$('.qtab',$form).tabs(),$('button[action],button[show]',$form).each(function(){var a=$(this).button();if(void 0!==a.attr('action')&&a.on('click',function(){$form.trigger('submit',a.attr('action'))}),void 0!==a.attr('show')){var b=void 0===a.attr('view')?'form.default':a.attr('view'),c=void 0===a.attr('output')?'html':a.attr('output');a.on('click',function(){window.open('index.php?show='+a.attr('show')+'&'+$.param({view:b,id:conf.object_id,object_class:conf.class_name,output:c}))})}'true'==a.attr('default')&&a.focus()});var schema,fields;return $({}).queue(function(a){$.when(qinoa.get_schema(conf.class_name)).done(function(b){schema=b,a()})}).queue(function(a){$.when(qinoa.get_fields(conf.class_name,conf.view)).done(function(b){fields=b,a()})}).queue(function(next){conf.onSubmitCallbacks=$.Callbacks(),conf.onSubmitResult=!0,'object'==typeof conf.predefined&&$.each(conf.predefined,function(a,b){$.inArray(a,Object.keys(fields))<0&&('object'==typeof b&&(a+='[]'),$form.append($('<input type="hidden"/>').attr({id:a+(new Date).getTime(),name:a,value:b})))}),conf.ready={},$.each(fields,function(field,attributes){var config=$.extend({},attributes),$item=$('#'+field,$form).on('ready',function(a){return'undefined'!=typeof conf.ready[field]?!1:(conf.ready[field]=!0,Object.keys(conf.ready).length<Object.keys(fields).length?!1:void 0)});'undefined'!=typeof schema[field].foreign_object&&(config.class_name=schema[field].foreign_object),$item.qFormWidget($.extend(config,{id:field+(new Date).getTime(),name:field,type:'undefined'!=typeof attributes.widget?attributes.widget:schema[field].type,value:$item.data('value'),parent_class:conf.class_name,parent_id:conf.object_id,lang:conf.lang,ui:conf.ui})).one('change',function(){conf.modified=!0,qinoa.console.log('Change made to edited object ('+conf.class_name+', '+conf.object_id+') on field '+field),'undefined'!=typeof attributes.onchange&&eval(attributes.onchange)}),'binary'==schema[field].type&&conf.onSubmitCallbacks.add(function(){0===$item.data('widget').val().length&&$item.data('widget').attr({id:'',name:''})}),attributes.onsubmit&&conf.onSubmitCallbacks.add(function(){eval(attributes.onsubmit)}),attributes.required&&conf.onSubmitCallbacks.add(function(){$item.data('widget').data('value')().length<=0?($item.data('widget').addClass('invalid'),conf.onSubmitResult=!1):$item.data('widget').removeClass('invalid')}),$item.removeAttr('onsubmit'),$item.removeAttr('onchange'),$item.removeAttr('id')}),deferred.resolve(),next()}),deferred.promise()},translate:function(a,b){var c=$.Deferred();return $.when(qinoa.get_lang(b.class_name,b.ui)).done(function(b){'object'!=typeof b||$.isEmptyObject(b)?($('label[name],legend[name],button[name]',a).each(function(){$(this).text(ucfirst($(this).attr('name')))}),$('label[for]',a).each(function(){$(this).text(ucfirst($(this).attr('for')))})):($('label[name],legend[name],button[name]',a).each(function(){var a=$(this).attr('name');'undefined'!=typeof a&&$(this).text('undefined'!=typeof b.view[a]?b.view[a].label:ucfirst(a))}),$('label[for]',a).each(function(){var a=$(this).attr('for');void 0!==a&&('undefined'!=typeof b.model[a]&&'undefined'!=typeof b.model[a].label?($(this).text(b.model[a].label),'undefined'!=typeof b.model[a].help&&$(this).append($('<sup/>').attr('title',b.model[a].help.replace(/\n/g,'<br />')).addClass('help').text('?').tooltip())):$(this).text(ucfirst(a)))})),c.resolve()}),c.promise()},listen:function(a,b){var c=$.Deferred();return a.on('submit',function(c,d){var e=!1,f=function(b,c){return a.parent().parent().hasClass('ui-dialog')?(a.parent().trigger('formclose',b),a.remove(),$('html, body').animate({scrollTop:0},0)):'undefined'!=typeof c&&qinoa.console.log(c),!1};switch(d){case'apply':case'core_draft_save':e=!0;break;case'core_objects_write':case'core_objects_update':e=!1;break;case'cancel':return f('cancel');default:return alert('No action is attached to this button.'),!1}return b.onSubmitResult=!0,b.onSubmitCallbacks.fire(),b.onSubmitResult?(a.serialize(),$.ajax({url:'index.php?do='+d,type:'POST',async:!0,dataType:'json',data:new FormData(a[0]),cache:!1,contentType:!1,processData:!1}).done(function(a){'number'==typeof a.result?(qinoa.console.log('Error raised in qinoa-ui.qForm by action ('+d+'): '+qinoa.error_codes[a.result]),a.result==qinoa.conf.INVALID_PARAM&&$.when(qinoa.get_lang(b.class_name,b.ui)).done(function(b){var c=qinoa.error_codes[a.result];$.each(a.error_message_ids,function(a,d){c+='object'==typeof b&&'undefined'!=typeof b.view[d]?b.view[d].label+"\n":d+"\n"}),qinoa.alert(c,'Validation error')})):'function'==typeof b.success_handler?b.success_handler(a):e?qinoa.console.log('Action '+d+' successfuly executed'):'undefined'!=typeof a.url&&a.url.length>0?window.location.href=a.url:f(d,'Action '+d+' successfuly executed')}).fail(function(a){qinoa.console.log('Error raised by action ('+d+'): '+qinoa.error_codes[a.result])}),!1):(alert('A mandatory field is left blank.'),qinoa.console.log('One of the submission callbacks failed'),!1)}),c.resolve(),c.promise()}};return this.each(function(){return function(a,b){return $.when(methods.load_view(a,b)).done(function(){return methods.translate(a,b)}).then(function(){return methods.feed(a,b)}).then(function(){return methods.render(a,b)}).then(function(){return methods.listen(a,b)}),a.on('ready',function(){$('.qView',a).show()})}($(this),$.extend(!0,default_conf,conf))})},$.extend(!0,qinoa,{form:function(a){qinoa.loader.show($('body'));var b=$('<form/>').qForm(a).on('ready',function(){qinoa.loader.hide()});return b}})}(jQuery,qinoa),/*! 
* rangy-core.js - v1.3.0-beta.2
* https://github.com/timdown/rangy
* Copyright (c) 2015 - Tim Down; Licensed MIT licence */
function(a,b){"function"==typeof define&&define.amd?define(a):"undefined"!=typeof module&&"object"==typeof exports?module.exports=a():b.rangy=a()}(function(){function a(a,b){var c=typeof a[b];return c==s||!(c!=r||!a[b])||"unknown"==c}function b(a,b){return!(typeof a[b]!=r||!a[b])}function c(a,b){return typeof a[b]!=t}function d(a){return function(b,c){for(var d=c.length;d--;)if(!a(b,c[d]))return!1;return!0}}function e(a){return a&&y(a,x)&&A(a,w)}function f(a){return b(a,"body")?a.body:a.getElementsByTagName("body")[0]}function g(b){typeof console!=t&&a(console,"log")&&console.log(b)}function h(a,b){D&&b?alert(a):g(a)}function i(a){F.initialized=!0,F.supported=!1,h("Rangy is not supported in this environment. Reason: "+a,F.config.alertOnFail)}function j(a){h("Rangy warning: "+a,F.config.alertOnWarn)}function k(a){return a.message||a.description||String(a)}function l(){if(D&&!F.initialized){var b,c=!1,d=!1;a(document,"createRange")&&(b=document.createRange(),y(b,v)&&A(b,u)&&(c=!0));var h=f(document);if(!h||"body"!=h.nodeName.toLowerCase())return void i("No body element found");if(h&&a(h,"createTextRange")&&(b=h.createTextRange(),e(b)&&(d=!0)),!c&&!d)return void i("Neither Range nor TextRange are available");F.initialized=!0,F.features={implementsDomRange:c,implementsTextRange:d};var j,l;for(var m in C)(j=C[m])instanceof n&&j.init(j,F);for(var o=0,p=I.length;p>o;++o)try{I[o](F)}catch(q){l="Rangy init listener threw an exception. Continuing. Detail: "+k(q),g(l)}}}function m(a){a=a||window,l();for(var b=0,c=J.length;c>b;++b)J[b](a)}function n(a,b,c){this.name=a,this.dependencies=b,this.initialized=!1,this.supported=!1,this.initializer=c}function o(a,b,c){var d=new n(a,b,function(b){if(!b.initialized){b.initialized=!0;try{c(F,b),b.supported=!0}catch(d){var e="Module '"+a+"' failed to load: "+k(d);g(e),d.stack&&g(d.stack)}}});return C[a]=d,d}function p(){}function q(){}var r="object",s="function",t="undefined",u=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],v=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],w=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],x=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"],y=d(a),z=d(b),A=d(c),B=[].forEach?function(a,b){a.forEach(b)}:function(a,b){for(var c=0,d=a.length;d>c;++c)b(a[c],c)},C={},D=typeof window!=t&&typeof document!=t,E={isHostMethod:a,isHostObject:b,isHostProperty:c,areHostMethods:y,areHostObjects:z,areHostProperties:A,isTextRange:e,getBody:f,forEach:B},F={version:"1.3.0-beta.2",initialized:!1,isBrowser:D,supported:!0,util:E,features:{},modules:C,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==t?!0:rangyAutoInitialize}};F.fail=i,F.warn=j;var G;({}).hasOwnProperty?(E.extend=G=function(a,b,c){var d,e;for(var f in b)b.hasOwnProperty(f)&&(d=a[f],e=b[f],c&&null!==d&&"object"==typeof d&&null!==e&&"object"==typeof e&&G(d,e,!0),a[f]=e);return b.hasOwnProperty("toString")&&(a.toString=b.toString),a},E.createOptions=function(a,b){var c={};return G(c,b),a&&G(c,a),c}):i("hasOwnProperty not supported"),D||i("Rangy can only run in a browser"),function(){var a;if(D){var b=document.createElement("div");b.appendChild(document.createElement("span"));var c=[].slice;try{1==c.call(b.childNodes,0)[0].nodeType&&(a=function(a){return c.call(a,0)})}catch(d){}}a||(a=function(a){for(var b=[],c=0,d=a.length;d>c;++c)b[c]=a[c];return b}),E.toArray=a}();var H;D&&(a(document,"addEventListener")?H=function(a,b,c){a.addEventListener(b,c,!1)}:a(document,"attachEvent")?H=function(a,b,c){a.attachEvent("on"+b,c)}:i("Document does not have required addEventListener or attachEvent method"),E.addListener=H);var I=[];F.init=l,F.addInitListener=function(a){F.initialized?a(F):I.push(a)};var J=[];F.addShimListener=function(a){J.push(a)},D&&(F.shim=F.createMissingNativeApi=m),n.prototype={init:function(){for(var a,b,c=this.dependencies||[],d=0,e=c.length;e>d;++d){if(b=c[d],a=C[b],!(a&&a instanceof n))throw new Error("required module '"+b+"' not found");if(a.init(),!a.supported)throw new Error("required module '"+b+"' not supported")}this.initializer(this)},fail:function(a){throw this.initialized=!0,this.supported=!1,new Error(a)},warn:function(a){F.warn("Module "+this.name+": "+a)},deprecationNotice:function(a,b){F.warn("DEPRECATED: "+a+" in module "+this.name+"is deprecated. Please use "+b+" instead")},createError:function(a){return new Error("Error in Rangy "+this.name+" module: "+a)}},F.createModule=function(a){var b,c;2==arguments.length?(b=arguments[1],c=[]):(b=arguments[2],c=arguments[1]);var d=o(a,c,b);F.initialized&&F.supported&&d.init()},F.createCoreModule=function(a,b,c){o(a,b,c)},F.RangePrototype=p,F.rangePrototype=new p,F.selectionPrototype=new q,F.createCoreModule("DomUtil",[],function(a,b){function c(a){var b;return typeof a.namespaceURI==F||null===(b=a.namespaceURI)||"http://www.w3.org/1999/xhtml"==b}function d(a){var b=a.parentNode;return 1==b.nodeType?b:null}function e(a){for(var b=0;a=a.previousSibling;)++b;return b}function f(a){switch(a.nodeType){case 7:case 10:return 0;case 3:case 8:return a.length;default:return a.childNodes.length}}function g(a,b){var c,d=[];for(c=a;c;c=c.parentNode)d.push(c);for(c=b;c;c=c.parentNode)if(K(d,c))return c;return null}function h(a,b,c){for(var d=c?b:b.parentNode;d;){if(d===a)return!0;d=d.parentNode}return!1}function i(a,b){return h(a,b,!0)}function j(a,b,c){for(var d,e=c?a:a.parentNode;e;){if(d=e.parentNode,d===b)return e;e=d}return null}function k(a){var b=a.nodeType;return 3==b||4==b||8==b}function l(a){if(!a)return!1;var b=a.nodeType;return 3==b||8==b}function m(a,b){var c=b.nextSibling,d=b.parentNode;return c?d.insertBefore(a,c):d.appendChild(a),a}function n(a,b,c){var d=a.cloneNode(!1);if(d.deleteData(0,b),a.deleteData(b,a.length-b),m(d,a),c)for(var f,g=0;f=c[g++];)f.node==a&&f.offset>b?(f.node=d,f.offset-=b):f.node==a.parentNode&&f.offset>e(a)&&++f.offset;return d}function o(a){if(9==a.nodeType)return a;if(typeof a.ownerDocument!=F)return a.ownerDocument;if(typeof a.document!=F)return a.document;if(a.parentNode)return o(a.parentNode);throw b.createError("getDocument: no document found for node")}function p(a){var c=o(a);if(typeof c.defaultView!=F)return c.defaultView;if(typeof c.parentWindow!=F)return c.parentWindow;throw b.createError("Cannot get a window object for node")}function q(a){if(typeof a.contentDocument!=F)return a.contentDocument;if(typeof a.contentWindow!=F)return a.contentWindow.document;throw b.createError("getIframeDocument: No Document object found for iframe element")}function r(a){if(typeof a.contentWindow!=F)return a.contentWindow;if(typeof a.contentDocument!=F)return a.contentDocument.defaultView;throw b.createError("getIframeWindow: No Window object found for iframe element")}function s(a){return a&&G.isHostMethod(a,"setTimeout")&&G.isHostObject(a,"document")}function t(a,b,c){var d;if(a?G.isHostProperty(a,"nodeType")?d=1==a.nodeType&&"iframe"==a.tagName.toLowerCase()?q(a):o(a):s(a)&&(d=a.document):d=document,!d)throw b.createError(c+"(): Parameter must be a Window object or DOM node");return d}function u(a){for(var b;b=a.parentNode;)a=b;return a}function v(a,c,d,f){var h,i,k,l,m;if(a==d)return c===f?0:f>c?-1:1;if(h=j(d,a,!0))return c<=e(h)?-1:1;if(h=j(a,d,!0))return e(h)<f?-1:1;if(i=g(a,d),!i)throw new Error("comparePoints error: nodes have no common ancestor");if(k=a===i?i:j(a,i,!0),l=d===i?i:j(d,i,!0),k===l)throw b.createError("comparePoints got to case 4 and childA and childB are the same!");for(m=i.firstChild;m;){if(m===k)return-1;if(m===l)return 1;m=m.nextSibling}}function w(a){var b;try{return b=a.parentNode,!1}catch(c){return!0}}function x(a){if(!a)return"[No node]";if(L&&w(a))return"[Broken node]";if(k(a))return'"'+a.data+'"';if(1==a.nodeType){var b=a.id?' id="'+a.id+'"':"";return"<"+a.nodeName+b+">[index:"+e(a)+",length:"+a.childNodes.length+"]["+(a.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return a.nodeName}function y(a){for(var b,c=o(a).createDocumentFragment();b=a.firstChild;)c.appendChild(b);return c}function z(a,b,c){var d=H(a),e=a.createElement("div");e.contentEditable=""+!!c,b&&(e.innerHTML=b);var f=d.firstChild;return f?d.insertBefore(e,f):d.appendChild(e),e}function A(a){return a.parentNode.removeChild(a)}function B(a){this.root=a,this._next=a}function C(a){return new B(a)}function D(a,b){this.node=a,this.offset=b}function E(a){this.code=this[a],this.codeName=a,this.message="DOMException: "+this.codeName}var F="undefined",G=a.util,H=G.getBody;G.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||b.fail("document missing a Node creation method"),G.isHostMethod(document,"getElementsByTagName")||b.fail("document missing getElementsByTagName method");var I=document.createElement("div");G.areHostMethods(I,["insertBefore","appendChild","cloneNode"]||!G.areHostObjects(I,["previousSibling","nextSibling","childNodes","parentNode"]))||b.fail("Incomplete Element implementation"),G.isHostProperty(I,"innerHTML")||b.fail("Element is missing innerHTML property");var J=document.createTextNode("test");G.areHostMethods(J,["splitText","deleteData","insertData","appendData","cloneNode"]||!G.areHostObjects(I,["previousSibling","nextSibling","childNodes","parentNode"])||!G.areHostProperties(J,["data"]))||b.fail("Incomplete Text Node implementation");var K=function(a,b){for(var c=a.length;c--;)if(a[c]===b)return!0;return!1},L=!1;!function(){var b=document.createElement("b");b.innerHTML="1";var c=b.firstChild;b.innerHTML="<br />",L=w(c),a.features.crashyTextNodes=L}();var M;typeof window.getComputedStyle!=F?M=function(a,b){return p(a).getComputedStyle(a,null)[b]}:typeof document.documentElement.currentStyle!=F?M=function(a,b){return a.currentStyle[b]}:b.fail("No means of obtaining computed style properties found"),B.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var a,b,c=this._current=this._next;if(this._current)if(a=c.firstChild)this._next=a;else{for(b=null;c!==this.root&&!(b=c.nextSibling);)c=c.parentNode;this._next=b}return this._current},detach:function(){this._current=this._next=this.root=null}},D.prototype={equals:function(a){return!!a&&this.node===a.node&&this.offset==a.offset},inspect:function(){return"[DomPosition("+x(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},E.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},E.prototype.toString=function(){return this.message},a.dom={arrayContains:K,isHtmlNamespace:c,parentElement:d,getNodeIndex:e,getNodeLength:f,getCommonAncestor:g,isAncestorOf:h,isOrIsAncestorOf:i,getClosestAncestorIn:j,isCharacterDataNode:k,isTextOrCommentNode:l,insertAfter:m,splitDataNode:n,getDocument:o,getWindow:p,getIframeWindow:r,getIframeDocument:q,getBody:H,isWindow:s,getContentDocument:t,getRootContainer:u,comparePoints:v,isBrokenNode:w,inspectNode:x,getComputedStyleProperty:M,createTestElement:z,removeNode:A,fragmentFromNodeChildren:y,createIterator:C,DomPosition:D},a.DOMException=E}),F.createCoreModule("DomRange",["DomUtil"],function(a,b){function c(a,b){return 3!=a.nodeType&&(P(a,b.startContainer)||P(a,b.endContainer))}function d(a){return a.document||Q(a.startContainer)}function e(a){return new L(a.parentNode,O(a))}function f(a){return new L(a.parentNode,O(a)+1)}function g(a,b,c){var d=11==a.nodeType?a.firstChild:a;return N(b)?c==b.length?J.insertAfter(a,b):b.parentNode.insertBefore(a,0==c?b:S(b,c)):c>=b.childNodes.length?b.appendChild(a):b.insertBefore(a,b.childNodes[c]),d}function h(a,b,c){if(z(a),z(b),d(b)!=d(a))throw new M("WRONG_DOCUMENT_ERR");var e=R(a.startContainer,a.startOffset,b.endContainer,b.endOffset),f=R(a.endContainer,a.endOffset,b.startContainer,b.startOffset);return c?0>=e&&f>=0:0>e&&f>0}function i(a){for(var b,c,e,f=d(a.range).createDocumentFragment();c=a.next();){if(b=a.isPartiallySelectedSubtree(),c=c.cloneNode(!b),b&&(e=a.getSubtreeIterator(),c.appendChild(i(e)),e.detach()),10==c.nodeType)throw new M("HIERARCHY_REQUEST_ERR");f.appendChild(c)}return f}function j(a,b,c){var d,e;c=c||{stop:!1};for(var f,g;f=a.next();)if(a.isPartiallySelectedSubtree()){if(b(f)===!1)return void(c.stop=!0);if(g=a.getSubtreeIterator(),j(g,b,c),g.detach(),c.stop)return}else for(d=J.createIterator(f);e=d.next();)if(b(e)===!1)return void(c.stop=!0)}function k(a){for(var b;a.next();)a.isPartiallySelectedSubtree()?(b=a.getSubtreeIterator(),k(b),b.detach()):a.remove()}function l(a){for(var b,c,e=d(a.range).createDocumentFragment();b=a.next();){if(a.isPartiallySelectedSubtree()?(b=b.cloneNode(!1),c=a.getSubtreeIterator(),b.appendChild(l(c)),c.detach()):a.remove(),10==b.nodeType)throw new M("HIERARCHY_REQUEST_ERR");e.appendChild(b)}return e}function m(a,b,c){var d,e=!(!b||!b.length),f=!!c;e&&(d=new RegExp("^("+b.join("|")+")$"));var g=[];return j(new o(a,!1),function(b){if(!(e&&!d.test(b.nodeType)||f&&!c(b))){var h=a.startContainer;if(b!=h||!N(h)||a.startOffset!=h.length){var i=a.endContainer;b==i&&N(i)&&0==a.endOffset||g.push(b)}}}),g}function n(a){var b="undefined"==typeof a.getName?"Range":a.getName();return"["+b+"("+J.inspectNode(a.startContainer)+":"+a.startOffset+", "+J.inspectNode(a.endContainer)+":"+a.endOffset+")]"}function o(a,b){if(this.range=a,this.clonePartiallySelectedTextNodes=b,!a.collapsed){this.sc=a.startContainer,this.so=a.startOffset,this.ec=a.endContainer,this.eo=a.endOffset;var c=a.commonAncestorContainer;this.sc===this.ec&&N(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==c||N(this.sc)?T(this.sc,c,!0):this.sc.childNodes[this.so],this._last=this.ec!==c||N(this.ec)?T(this.ec,c,!0):this.ec.childNodes[this.eo-1])}}function p(a){return function(b,c){for(var d,e=c?b:b.parentNode;e;){if(d=e.nodeType,V(a,d))return e;e=e.parentNode}return null}}function q(a,b){if(ea(a,b))throw new M("INVALID_NODE_TYPE_ERR")}function r(a,b){if(!V(b,a.nodeType))throw new M("INVALID_NODE_TYPE_ERR")}function s(a,b){if(0>b||b>(N(a)?a.length:a.childNodes.length))throw new M("INDEX_SIZE_ERR")}function t(a,b){if(ca(a,!0)!==ca(b,!0))throw new M("WRONG_DOCUMENT_ERR")}function u(a){if(da(a,!0))throw new M("NO_MODIFICATION_ALLOWED_ERR")}function v(a,b){if(!a)throw new M(b)}function w(a){return X&&J.isBrokenNode(a)||!V($,a.nodeType)&&!ca(a,!0)}function x(a,b){return b<=(N(a)?a.length:a.childNodes.length)}function y(a){return!!a.startContainer&&!!a.endContainer&&!w(a.startContainer)&&!w(a.endContainer)&&x(a.startContainer,a.startOffset)&&x(a.endContainer,a.endOffset)}function z(a){if(!y(a))throw new Error("Range error: Range is no longer valid after DOM mutation ("+a.inspect()+")")}function A(a,b){z(a);var c=a.startContainer,d=a.startOffset,e=a.endContainer,f=a.endOffset,g=c===e;N(e)&&f>0&&f<e.length&&S(e,f,b),N(c)&&d>0&&d<c.length&&(c=S(c,d,b),g?(f-=d,e=c):e==c.parentNode&&f>=O(c)&&f++,d=0),a.setStartAndEnd(c,d,e,f)}function B(a){z(a);var b=a.commonAncestorContainer.parentNode.cloneNode(!1);return b.appendChild(a.cloneContents()),b.innerHTML}function C(a){a.START_TO_START=ka,a.START_TO_END=la,a.END_TO_END=ma,a.END_TO_START=na,a.NODE_BEFORE=oa,a.NODE_AFTER=pa,a.NODE_BEFORE_AND_AFTER=qa,a.NODE_INSIDE=ra}function D(a){C(a),C(a.prototype)}function E(a,b){return function(){z(this);var c,d,e=this.startContainer,g=this.startOffset,h=this.commonAncestorContainer,i=new o(this,!0);e!==h&&(c=T(e,h,!0),d=f(c),e=d.node,g=d.offset),j(i,u),i.reset();var k=a(i);return i.detach(),b(this,e,g,e,g),k}}function F(b,d){function g(a,b){return function(c){r(c,Z),r(W(c),$);var d=(a?e:f)(c);(b?h:i)(this,d.node,d.offset)}}function h(a,b,c){var e=a.endContainer,f=a.endOffset;(b!==a.startContainer||c!==a.startOffset)&&((W(b)!=W(e)||1==R(b,c,e,f))&&(e=b,f=c),d(a,b,c,e,f))}function i(a,b,c){var e=a.startContainer,f=a.startOffset;(b!==a.endContainer||c!==a.endOffset)&&((W(b)!=W(e)||-1==R(b,c,e,f))&&(e=b,f=c),d(a,e,f,b,c))}var j=function(){};j.prototype=a.rangePrototype,b.prototype=new j,K.extend(b.prototype,{setStart:function(a,b){q(a,!0),s(a,b),h(this,a,b)},setEnd:function(a,b){q(a,!0),s(a,b),i(this,a,b)},setStartAndEnd:function(){var a=arguments,b=a[0],c=a[1],e=b,f=c;switch(a.length){case 3:f=a[2];break;case 4:e=a[2],f=a[3]}d(this,b,c,e,f)},setBoundary:function(a,b,c){this["set"+(c?"Start":"End")](a,b)},setStartBefore:g(!0,!0),setStartAfter:g(!1,!0),setEndBefore:g(!0,!1),setEndAfter:g(!1,!1),collapse:function(a){z(this),a?d(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):d(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){q(a,!0),d(this,a,0,a,U(a))},selectNode:function(a){q(a,!1),r(a,Z);var b=e(a),c=f(a);d(this,b.node,b.offset,c.node,c.offset)},extractContents:E(l,d),deleteContents:E(k,d),canSurroundContents:function(){z(this),u(this.startContainer),u(this.endContainer);var a=new o(this,!0),b=a._first&&c(a._first,this)||a._last&&c(a._last,this);return a.detach(),!b},splitBoundaries:function(){A(this)},splitBoundariesPreservingPositions:function(a){A(this,a)},normalizeBoundaries:function(){z(this);var a=this.startContainer,b=this.startOffset,c=this.endContainer,e=this.endOffset,f=function(a){var b=a.nextSibling;b&&b.nodeType==a.nodeType&&(c=a,e=a.length,a.appendData(b.data),Y(b))},g=function(d){var f=d.previousSibling;if(f&&f.nodeType==d.nodeType){a=d;var g=d.length;if(b=f.length,d.insertData(0,f.data),Y(f),a==c)e+=b,c=a;else if(c==d.parentNode){var h=O(d);e==h?(c=d,e=g):e>h&&e--}}},h=!0;if(N(c))c.length==e&&f(c);else{if(e>0){var i=c.childNodes[e-1];i&&N(i)&&f(i)}h=!this.collapsed}if(h){if(N(a))0==b&&g(a);else if(b<a.childNodes.length){var j=a.childNodes[b];j&&N(j)&&g(j)}}else a=c,b=e;d(this,a,b,c,e)},collapseToPoint:function(a,b){q(a,!0),s(a,b),this.setStartAndEnd(a,b)}}),D(b)}function G(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset,a.commonAncestorContainer=a.collapsed?a.startContainer:J.getCommonAncestor(a.startContainer,a.endContainer)}function H(a,b,c,d,e){a.startContainer=b,a.startOffset=c,a.endContainer=d,a.endOffset=e,a.document=J.getDocument(b),G(a)}function I(a){this.startContainer=a,this.startOffset=0,this.endContainer=a,this.endOffset=0,this.document=a,G(this)}var J=a.dom,K=a.util,L=J.DomPosition,M=a.DOMException,N=J.isCharacterDataNode,O=J.getNodeIndex,P=J.isOrIsAncestorOf,Q=J.getDocument,R=J.comparePoints,S=J.splitDataNode,T=J.getClosestAncestorIn,U=J.getNodeLength,V=J.arrayContains,W=J.getRootContainer,X=a.features.crashyTextNodes,Y=J.removeNode;o.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next;return a&&(this._next=a!==this._last?a.nextSibling:null,N(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so))),a},remove:function(){var a,b,c=this._current;!N(c)||c!==this.sc&&c!==this.ec?c.parentNode&&Y(c):(a=c===this.sc?this.so:0,b=c===this.ec?this.eo:c.length,a!=b&&c.deleteData(a,b-a))},isPartiallySelectedSubtree:function(){var a=this._current;return c(a,this.range)},getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse(!1);else{a=new I(d(this.range));var b=this._current,c=b,e=0,f=b,g=U(b);P(b,this.sc)&&(c=this.sc,e=this.so),P(b,this.ec)&&(f=this.ec,g=this.eo),H(a,c,e,f,g)}return new o(a,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var Z=[1,3,4,5,7,8,10],$=[2,9,11],_=[5,6,10,12],aa=[1,3,4,5,7,8,10,11],ba=[1,3,4,5,7,8],ca=p([9,11]),da=p(_),ea=p([6,10,12]),fa=document.createElement("style"),ga=!1;try{fa.innerHTML="<b>x</b>",ga=3==fa.firstChild.nodeType}catch(ha){}a.features.htmlParsingConforms=ga;var ia=ga?function(a){var b=this.startContainer,c=Q(b);if(!b)throw new M("INVALID_STATE_ERR");var d=null;return 1==b.nodeType?d=b:N(b)&&(d=J.parentElement(b)),d=null===d||"HTML"==d.nodeName&&J.isHtmlNamespace(Q(d).documentElement)&&J.isHtmlNamespace(d)?c.createElement("body"):d.cloneNode(!1),d.innerHTML=a,J.fragmentFromNodeChildren(d)}:function(a){var b=d(this),c=b.createElement("body");return c.innerHTML=a,J.fragmentFromNodeChildren(c)},ja=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],ka=0,la=1,ma=2,na=3,oa=0,pa=1,qa=2,ra=3;K.extend(a.rangePrototype,{compareBoundaryPoints:function(a,b){z(this),t(this.startContainer,b.startContainer);var c,d,e,f,g=a==na||a==ka?"start":"end",h=a==la||a==ka?"start":"end";return c=this[g+"Container"],d=this[g+"Offset"],e=b[h+"Container"],f=b[h+"Offset"],R(c,d,e,f)},insertNode:function(a){if(z(this),r(a,aa),u(this.startContainer),P(a,this.startContainer))throw new M("HIERARCHY_REQUEST_ERR");var b=g(a,this.startContainer,this.startOffset);this.setStartBefore(b)},cloneContents:function(){z(this);var a,b;if(this.collapsed)return d(this).createDocumentFragment();if(this.startContainer===this.endContainer&&N(this.startContainer))return a=this.startContainer.cloneNode(!0),a.data=a.data.slice(this.startOffset,this.endOffset),b=d(this).createDocumentFragment(),b.appendChild(a),b;var c=new o(this,!0);return a=i(c),c.detach(),a},canSurroundContents:function(){z(this),u(this.startContainer),u(this.endContainer);var a=new o(this,!0),b=a._first&&c(a._first,this)||a._last&&c(a._last,this);return a.detach(),!b},surroundContents:function(a){if(r(a,ba),!this.canSurroundContents())throw new M("INVALID_STATE_ERR");var b=this.extractContents();if(a.hasChildNodes())for(;a.lastChild;)a.removeChild(a.lastChild);g(a,this.startContainer,this.startOffset),a.appendChild(b),this.selectNode(a)},cloneRange:function(){z(this);for(var a,b=new I(d(this)),c=ja.length;c--;)a=ja[c],b[a]=this[a];return b},toString:function(){z(this);var a=this.startContainer;if(a===this.endContainer&&N(a))return 3==a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var b=[],c=new o(this,!0);return j(c,function(a){(3==a.nodeType||4==a.nodeType)&&b.push(a.data)}),c.detach(),b.join("")},compareNode:function(a){z(this);var b=a.parentNode,c=O(a);if(!b)throw new M("NOT_FOUND_ERR");var d=this.comparePoint(b,c),e=this.comparePoint(b,c+1);return 0>d?e>0?qa:oa:e>0?pa:ra},comparePoint:function(a,b){return z(this),v(a,"HIERARCHY_REQUEST_ERR"),t(a,this.startContainer),R(a,b,this.startContainer,this.startOffset)<0?-1:R(a,b,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:ia,toHtml:function(){return B(this)},intersectsNode:function(a,b){if(z(this),v(a,"NOT_FOUND_ERR"),Q(a)!==d(this))return!1;var c=a.parentNode,e=O(a);v(c,"NOT_FOUND_ERR");var f=R(c,e,this.endContainer,this.endOffset),g=R(c,e+1,this.startContainer,this.startOffset);return b?0>=f&&g>=0:0>f&&g>0},isPointInRange:function(a,b){return z(this),v(a,"HIERARCHY_REQUEST_ERR"),t(a,this.startContainer),R(a,b,this.startContainer,this.startOffset)>=0&&R(a,b,this.endContainer,this.endOffset)<=0},intersectsRange:function(a){return h(this,a,!1)},intersectsOrTouchesRange:function(a){return h(this,a,!0)},intersection:function(a){if(this.intersectsRange(a)){var b=R(this.startContainer,this.startOffset,a.startContainer,a.startOffset),c=R(this.endContainer,this.endOffset,a.endContainer,a.endOffset),d=this.cloneRange();return-1==b&&d.setStart(a.startContainer,a.startOffset),1==c&&d.setEnd(a.endContainer,a.endOffset),d}return null},union:function(a){if(this.intersectsOrTouchesRange(a)){var b=this.cloneRange();return-1==R(a.startContainer,a.startOffset,this.startContainer,this.startOffset)&&b.setStart(a.startContainer,a.startOffset),1==R(a.endContainer,a.endOffset,this.endContainer,this.endOffset)&&b.setEnd(a.endContainer,a.endOffset),b}throw new M("Ranges do not intersect")},containsNode:function(a,b){return b?this.intersectsNode(a,!1):this.compareNode(a)==ra},containsNodeContents:function(a){return this.comparePoint(a,0)>=0&&this.comparePoint(a,U(a))<=0},containsRange:function(a){var b=this.intersection(a);return null!==b&&a.equals(b)},containsNodeText:function(a){var b=this.cloneRange();b.selectNode(a);var c=b.getNodes([3]);if(c.length>0){b.setStart(c[0],0);var d=c.pop();return b.setEnd(d,d.length),this.containsRange(b)}return this.containsNodeContents(a)},getNodes:function(a,b){return z(this),m(this,a,b)},getDocument:function(){return d(this)},collapseBefore:function(a){this.setEndBefore(a),this.collapse(!1)},collapseAfter:function(a){this.setStartAfter(a),this.collapse(!0)},getBookmark:function(b){var c=d(this),e=a.createRange(c);b=b||J.getBody(c),e.selectNodeContents(b);var f=this.intersection(e),g=0,h=0;return f&&(e.setEnd(f.startContainer,f.startOffset),g=e.toString().length,h=g+f.toString().length),{start:g,end:h,containerNode:b}},moveToBookmark:function(a){var b=a.containerNode,c=0;this.setStart(b,0),this.collapse(!0);for(var d,e,f,g,h=[b],i=!1,j=!1;!j&&(d=h.pop());)if(3==d.nodeType)e=c+d.length,!i&&a.start>=c&&a.start<=e&&(this.setStart(d,a.start-c),i=!0),i&&a.end>=c&&a.end<=e&&(this.setEnd(d,a.end-c),j=!0),c=e;else for(g=d.childNodes,f=g.length;f--;)h.push(g[f])},getName:function(){return"DomRange"},equals:function(a){return I.rangesEqual(this,a)},isValid:function(){return y(this)},inspect:function(){return n(this)},detach:function(){}}),F(I,H),K.extend(I,{rangeProperties:ja,RangeIterator:o,copyComparisonConstants:D,createPrototypeRange:F,inspect:n,toHtml:B,getRangeDocument:d,rangesEqual:function(a,b){return a.startContainer===b.startContainer&&a.startOffset===b.startOffset&&a.endContainer===b.endContainer&&a.endOffset===b.endOffset}}),a.DomRange=I}),F.createCoreModule("WrappedRange",["DomRange"],function(a,b){var c,d,e=a.dom,f=a.util,g=e.DomPosition,h=a.DomRange,i=e.getBody,j=e.getContentDocument,k=e.isCharacterDataNode;if(a.features.implementsDomRange&&!function(){function d(a){for(var b,c=m.length;c--;)b=m[c],a[b]=a.nativeRange[b];a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset}function g(a,b,c,d,e){var f=a.startContainer!==b||a.startOffset!=c,g=a.endContainer!==d||a.endOffset!=e,h=!a.equals(a.nativeRange);(f||g||h)&&(a.setEnd(d,e),a.setStart(b,c))}var k,l,m=h.rangeProperties;c=function(a){if(!a)throw b.createError("WrappedRange: Range must be specified");this.nativeRange=a,d(this)},h.createPrototypeRange(c,g),k=c.prototype,k.selectNode=function(a){this.nativeRange.selectNode(a),d(this)},k.cloneContents=function(){return this.nativeRange.cloneContents()},k.surroundContents=function(a){this.nativeRange.surroundContents(a),d(this)},k.collapse=function(a){this.nativeRange.collapse(a),d(this)},k.cloneRange=function(){return new c(this.nativeRange.cloneRange())},k.refresh=function(){d(this)},k.toString=function(){return this.nativeRange.toString()};var n=document.createTextNode("test");i(document).appendChild(n);var o=document.createRange();o.setStart(n,0),o.setEnd(n,0);try{o.setStart(n,1),k.setStart=function(a,b){this.nativeRange.setStart(a,b),d(this)},k.setEnd=function(a,b){this.nativeRange.setEnd(a,b),d(this)},l=function(a){return function(b){this.nativeRange[a](b),d(this)}}}catch(p){k.setStart=function(a,b){try{this.nativeRange.setStart(a,b)}catch(c){this.nativeRange.setEnd(a,b),this.nativeRange.setStart(a,b)}d(this)},k.setEnd=function(a,b){try{this.nativeRange.setEnd(a,b)}catch(c){this.nativeRange.setStart(a,b),this.nativeRange.setEnd(a,b)}d(this)},l=function(a,b){return function(c){try{this.nativeRange[a](c)}catch(e){this.nativeRange[b](c),this.nativeRange[a](c)}d(this)}}}k.setStartBefore=l("setStartBefore","setEndBefore"),k.setStartAfter=l("setStartAfter","setEndAfter"),k.setEndBefore=l("setEndBefore","setStartBefore"),k.setEndAfter=l("setEndAfter","setStartAfter"),k.selectNodeContents=function(a){this.setStartAndEnd(a,0,e.getNodeLength(a))},o.selectNodeContents(n),o.setEnd(n,3);var q=document.createRange();q.selectNodeContents(n),q.setEnd(n,4),q.setStart(n,2),-1==o.compareBoundaryPoints(o.START_TO_END,q)&&1==o.compareBoundaryPoints(o.END_TO_START,q)?k.compareBoundaryPoints=function(a,b){return b=b.nativeRange||b,a==b.START_TO_END?a=b.END_TO_START:a==b.END_TO_START&&(a=b.START_TO_END),this.nativeRange.compareBoundaryPoints(a,b)}:k.compareBoundaryPoints=function(a,b){return this.nativeRange.compareBoundaryPoints(a,b.nativeRange||b)};var r=document.createElement("div");r.innerHTML="123";var s=r.firstChild,t=i(document);t.appendChild(r),o.setStart(s,1),o.setEnd(s,2),o.deleteContents(),"13"==s.data&&(k.deleteContents=function(){this.nativeRange.deleteContents(),d(this)},k.extractContents=function(){var a=this.nativeRange.extractContents();return d(this),a}),t.removeChild(r),t=null,f.isHostMethod(o,"createContextualFragment")&&(k.createContextualFragment=function(a){return this.nativeRange.createContextualFragment(a)}),i(document).removeChild(n),k.getName=function(){return"WrappedRange"},a.WrappedRange=c,a.createNativeRange=function(a){return a=j(a,b,"createNativeRange"),a.createRange()}}(),a.features.implementsTextRange){var l=function(a){var b=a.parentElement(),c=a.duplicate();c.collapse(!0);var d=c.parentElement();c=a.duplicate(),c.collapse(!1);var f=c.parentElement(),g=d==f?d:e.getCommonAncestor(d,f);return g==b?g:e.getCommonAncestor(b,g)},m=function(a){return 0==a.compareEndPoints("StartToEnd",a)},n=function(a,b,c,d,f){var h=a.duplicate();h.collapse(c);var i=h.parentElement();if(e.isOrIsAncestorOf(b,i)||(i=b),!i.canHaveHTML){var j=new g(i.parentNode,e.getNodeIndex(i));return{boundaryPosition:j,nodeInfo:{nodeIndex:j.offset,containerElement:j.node}}}var l=e.getDocument(i).createElement("span");l.parentNode&&e.removeNode(l);for(var m,n,o,p,q,r=c?"StartToStart":"StartToEnd",s=f&&f.containerElement==i?f.nodeIndex:0,t=i.childNodes.length,u=t,v=u;;){if(v==t?i.appendChild(l):i.insertBefore(l,i.childNodes[v]),h.moveToElementText(l),m=h.compareEndPoints(r,a),0==m||s==u)break;if(-1==m){if(u==s+1)break;s=v}else u=u==s+1?s:v;v=Math.floor((s+u)/2),i.removeChild(l)}if(q=l.nextSibling,-1==m&&q&&k(q)){h.setEndPoint(c?"EndToStart":"EndToEnd",a);var w;if(/[\r\n]/.test(q.data)){var x=h.duplicate(),y=x.text.replace(/\r\n/g,"\r").length;for(w=x.moveStart("character",y);-1==(m=x.compareEndPoints("StartToEnd",x));)w++,x.moveStart("character",1)}else w=h.text.length;p=new g(q,w)}else n=(d||!c)&&l.previousSibling,o=(d||c)&&l.nextSibling,p=o&&k(o)?new g(o,0):n&&k(n)?new g(n,n.data.length):new g(i,e.getNodeIndex(l));return e.removeNode(l),{boundaryPosition:p,nodeInfo:{nodeIndex:v,containerElement:i}}},o=function(a,b){var c,d,f,g,h=a.offset,j=e.getDocument(a.node),l=i(j).createTextRange(),m=k(a.node);return m?(c=a.node,d=c.parentNode):(g=a.node.childNodes,c=h<g.length?g[h]:null,d=a.node),f=j.createElement("span"),f.innerHTML="&#feff;",c?d.insertBefore(f,c):d.appendChild(f),l.moveToElementText(f),l.collapse(!b),d.removeChild(f),m&&l[b?"moveStart":"moveEnd"]("character",h),l};d=function(a){this.textRange=a,this.refresh()},d.prototype=new h(document),d.prototype.refresh=function(){var a,b,c,d=l(this.textRange);m(this.textRange)?b=a=n(this.textRange,d,!0,!0).boundaryPosition:(c=n(this.textRange,d,!0,!1),a=c.boundaryPosition,b=n(this.textRange,d,!1,!1,c.nodeInfo).boundaryPosition),this.setStart(a.node,a.offset),this.setEnd(b.node,b.offset)},d.prototype.getName=function(){return"WrappedTextRange"},h.copyComparisonConstants(d);var p=function(a){if(a.collapsed)return o(new g(a.startContainer,a.startOffset),!0);var b=o(new g(a.startContainer,a.startOffset),!0),c=o(new g(a.endContainer,a.endOffset),!1),d=i(h.getRangeDocument(a)).createTextRange();
return d.setEndPoint("StartToStart",b),d.setEndPoint("EndToEnd",c),d};if(d.rangeToTextRange=p,d.prototype.toTextRange=function(){return p(this)},a.WrappedTextRange=d,!a.features.implementsDomRange||a.config.preferTextRange){var q=function(a){return a("return this;")()}(Function);"undefined"==typeof q.Range&&(q.Range=d),a.createNativeRange=function(a){return a=j(a,b,"createNativeRange"),i(a).createTextRange()},a.WrappedRange=d}}a.createRange=function(c){return c=j(c,b,"createRange"),new a.WrappedRange(a.createNativeRange(c))},a.createRangyRange=function(a){return a=j(a,b,"createRangyRange"),new h(a)},a.createIframeRange=function(c){return b.deprecationNotice("createIframeRange()","createRange(iframeEl)"),a.createRange(c)},a.createIframeRangyRange=function(c){return b.deprecationNotice("createIframeRangyRange()","createRangyRange(iframeEl)"),a.createRangyRange(c)},a.addShimListener(function(b){var c=b.document;"undefined"==typeof c.createRange&&(c.createRange=function(){return a.createRange(c)}),c=b=null})}),F.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(a,b){function c(a){return"string"==typeof a?/^backward(s)?$/i.test(a):!!a}function d(a,c){if(a){if(C.isWindow(a))return a;if(a instanceof r)return a.win;var d=C.getContentDocument(a,b,c);return C.getWindow(d)}return window}function e(a){return d(a,"getWinSelection").getSelection()}function f(a){return d(a,"getDocSelection").document.selection}function g(a){var b=!1;return a.anchorNode&&(b=1==C.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset)),b}function h(a,b,c){var d=c?"end":"start",e=c?"start":"end";a.anchorNode=b[d+"Container"],a.anchorOffset=b[d+"Offset"],a.focusNode=b[e+"Container"],a.focusOffset=b[e+"Offset"]}function i(a){var b=a.nativeSelection;a.anchorNode=b.anchorNode,a.anchorOffset=b.anchorOffset,a.focusNode=b.focusNode,a.focusOffset=b.focusOffset}function j(a){a.anchorNode=a.focusNode=null,a.anchorOffset=a.focusOffset=0,a.rangeCount=0,a.isCollapsed=!0,a._ranges.length=0}function k(b){var c;return b instanceof F?(c=a.createNativeRange(b.getDocument()),c.setEnd(b.endContainer,b.endOffset),c.setStart(b.startContainer,b.startOffset)):b instanceof G?c=b.nativeRange:J.implementsDomRange&&b instanceof C.getWindow(b.startContainer).Range&&(c=b),c}function l(a){if(!a.length||1!=a[0].nodeType)return!1;for(var b=1,c=a.length;c>b;++b)if(!C.isAncestorOf(a[0],a[b]))return!1;return!0}function m(a){var c=a.getNodes();if(!l(c))throw b.createError("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");return c[0]}function n(a){return!!a&&"undefined"!=typeof a.text}function o(a,b){var c=new G(b);a._ranges=[c],h(a,c,!1),a.rangeCount=1,a.isCollapsed=c.collapsed}function p(b){if(b._ranges.length=0,"None"==b.docSelection.type)j(b);else{var c=b.docSelection.createRange();if(n(c))o(b,c);else{b.rangeCount=c.length;for(var d,e=L(c.item(0)),f=0;f<b.rangeCount;++f)d=a.createRange(e),d.selectNode(c.item(f)),b._ranges.push(d);b.isCollapsed=1==b.rangeCount&&b._ranges[0].collapsed,h(b,b._ranges[b.rangeCount-1],!1)}}}function q(a,c){for(var d=a.docSelection.createRange(),e=m(c),f=L(d.item(0)),g=M(f).createControlRange(),h=0,i=d.length;i>h;++h)g.add(d.item(h));try{g.add(e)}catch(j){throw b.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}g.select(),p(a)}function r(a,b,c){this.nativeSelection=a,this.docSelection=b,this._ranges=[],this.win=c,this.refresh()}function s(a){a.win=a.anchorNode=a.focusNode=a._ranges=null,a.rangeCount=a.anchorOffset=a.focusOffset=0,a.detached=!0}function t(a,b){for(var c,d,e=ba.length;e--;)if(c=ba[e],d=c.selection,"deleteAll"==b)s(d);else if(c.win==a)return"delete"==b?(ba.splice(e,1),!0):d;return"deleteAll"==b&&(ba.length=0),null}function u(a,c){for(var d,e=L(c[0].startContainer),f=M(e).createControlRange(),g=0,h=c.length;h>g;++g){d=m(c[g]);try{f.add(d)}catch(i){throw b.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}f.select(),p(a)}function v(a,b){if(a.win.document!=L(b))throw new H("WRONG_DOCUMENT_ERR")}function w(b){return function(c,d){var e;this.rangeCount?(e=this.getRangeAt(0),e["set"+(b?"Start":"End")](c,d)):(e=a.createRange(this.win.document),e.setStartAndEnd(c,d)),this.setSingleRange(e,this.isBackward())}}function x(a){var b=[],c=new I(a.anchorNode,a.anchorOffset),d=new I(a.focusNode,a.focusOffset),e="function"==typeof a.getName?a.getName():"Selection";if("undefined"!=typeof a.rangeCount)for(var f=0,g=a.rangeCount;g>f;++f)b[f]=F.inspect(a.getRangeAt(f));return"["+e+"(Ranges: "+b.join(", ")+")(anchor: "+c.inspect()+", focus: "+d.inspect()+"]"}a.config.checkSelectionRanges=!0;var y,z,A="boolean",B="number",C=a.dom,D=a.util,E=D.isHostMethod,F=a.DomRange,G=a.WrappedRange,H=a.DOMException,I=C.DomPosition,J=a.features,K="Control",L=C.getDocument,M=C.getBody,N=F.rangesEqual,O=E(window,"getSelection"),P=D.isHostObject(document,"selection");J.implementsWinGetSelection=O,J.implementsDocSelection=P;var Q=P&&(!O||a.config.preferTextRange);if(Q)y=f,a.isSelectionValid=function(a){var b=d(a,"isSelectionValid").document,c=b.selection;return"None"!=c.type||L(c.createRange().parentElement())==b};else{if(!O)return b.fail("Neither document.selection or window.getSelection() detected."),!1;y=e,a.isSelectionValid=function(){return!0}}a.getNativeSelection=y;var R=y();if(!R)return b.fail("Native selection was null (possibly issue 138?)"),!1;var S=a.createNativeRange(document),T=M(document),U=D.areHostProperties(R,["anchorNode","focusNode","anchorOffset","focusOffset"]);J.selectionHasAnchorAndFocus=U;var V=E(R,"extend");J.selectionHasExtend=V;var W=typeof R.rangeCount==B;J.selectionHasRangeCount=W;var X=!1,Y=!0,Z=V?function(b,c){var d=F.getRangeDocument(c),e=a.createRange(d);e.collapseToPoint(c.endContainer,c.endOffset),b.addRange(k(e)),b.extend(c.startContainer,c.startOffset)}:null;D.areHostMethods(R,["addRange","getRangeAt","removeAllRanges"])&&typeof R.rangeCount==B&&J.implementsDomRange&&!function(){var b=window.getSelection();if(b){for(var c=b.rangeCount,d=c>1,e=[],f=g(b),h=0;c>h;++h)e[h]=b.getRangeAt(h);var i=C.createTestElement(document,"",!1),j=i.appendChild(document.createTextNode("   ")),k=document.createRange();if(k.setStart(j,1),k.collapse(!0),b.removeAllRanges(),b.addRange(k),Y=1==b.rangeCount,b.removeAllRanges(),!d){var l=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(l&&parseInt(l[1])>=36)X=!1;else{var m=k.cloneRange();k.setStart(j,0),m.setEnd(j,3),m.setStart(j,2),b.addRange(k),b.addRange(m),X=2==b.rangeCount}}for(C.removeNode(i),b.removeAllRanges(),h=0;c>h;++h)0==h&&f?Z?Z(b,e[h]):(a.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),b.addRange(e[h])):b.addRange(e[h])}}(),J.selectionSupportsMultipleRanges=X,J.collapsedNonEditableSelectionsSupported=Y;var $,_=!1;T&&E(T,"createControlRange")&&($=T.createControlRange(),D.areHostProperties($,["item","add"])&&(_=!0)),J.implementsControlRange=_,z=U?function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:!1};var aa;E(R,"getRangeAt")?aa=function(a,b){try{return a.getRangeAt(b)}catch(c){return null}}:U&&(aa=function(b){var c=L(b.anchorNode),d=a.createRange(c);return d.setStartAndEnd(b.anchorNode,b.anchorOffset,b.focusNode,b.focusOffset),d.collapsed!==this.isCollapsed&&d.setStartAndEnd(b.focusNode,b.focusOffset,b.anchorNode,b.anchorOffset),d}),r.prototype=a.selectionPrototype;var ba=[],ca=function(a){if(a&&a instanceof r)return a.refresh(),a;a=d(a,"getNativeSelection");var b=t(a),c=y(a),e=P?f(a):null;return b?(b.nativeSelection=c,b.docSelection=e,b.refresh()):(b=new r(c,e,a),ba.push({win:a,selection:b})),b};a.getSelection=ca,a.getIframeSelection=function(c){return b.deprecationNotice("getIframeSelection()","getSelection(iframeEl)"),a.getSelection(C.getIframeWindow(c))};var da=r.prototype;if(!Q&&U&&D.areHostMethods(R,["removeAllRanges","addRange"])){da.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),j(this)};var ea=function(a,b){Z(a.nativeSelection,b),a.refresh()};W?da.addRange=function(b,d){if(_&&P&&this.docSelection.type==K)q(this,b);else if(c(d)&&V)ea(this,b);else{var e;X?e=this.rangeCount:(this.removeAllRanges(),e=0);var f=k(b).cloneRange();try{this.nativeSelection.addRange(f)}catch(g){}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==e+1){if(a.config.checkSelectionRanges){var i=aa(this.nativeSelection,this.rangeCount-1);i&&!N(i,b)&&(b=new G(i))}this._ranges[this.rangeCount-1]=b,h(this,b,ha(this.nativeSelection)),this.isCollapsed=z(this)}else this.refresh()}}:da.addRange=function(a,b){c(b)&&V?ea(this,a):(this.nativeSelection.addRange(k(a)),this.refresh())},da.setRanges=function(a){if(_&&P&&a.length>1)u(this,a);else{this.removeAllRanges();for(var b=0,c=a.length;c>b;++b)this.addRange(a[b])}}}else{if(!(E(R,"empty")&&E(S,"select")&&_&&Q))return b.fail("No means of selecting a Range or TextRange was found"),!1;da.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var a;if(this.anchorNode)a=L(this.anchorNode);else if(this.docSelection.type==K){var b=this.docSelection.createRange();b.length&&(a=L(b.item(0)))}if(a){var c=M(a).createTextRange();c.select(),this.docSelection.empty()}}}catch(d){}j(this)},da.addRange=function(b){this.docSelection.type==K?q(this,b):(a.WrappedTextRange.rangeToTextRange(b).select(),this._ranges[0]=b,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,h(this,b,!1))},da.setRanges=function(a){this.removeAllRanges();var b=a.length;b>1?u(this,a):b&&this.addRange(a[0])}}da.getRangeAt=function(a){if(0>a||a>=this.rangeCount)throw new H("INDEX_SIZE_ERR");return this._ranges[a].cloneRange()};var fa;if(Q)fa=function(b){var c;a.isSelectionValid(b.win)?c=b.docSelection.createRange():(c=M(b.win.document).createTextRange(),c.collapse(!0)),b.docSelection.type==K?p(b):n(c)?o(b,c):j(b)};else if(E(R,"getRangeAt")&&typeof R.rangeCount==B)fa=function(b){if(_&&P&&b.docSelection.type==K)p(b);else if(b._ranges.length=b.rangeCount=b.nativeSelection.rangeCount,b.rangeCount){for(var c=0,d=b.rangeCount;d>c;++c)b._ranges[c]=new a.WrappedRange(b.nativeSelection.getRangeAt(c));h(b,b._ranges[b.rangeCount-1],ha(b.nativeSelection)),b.isCollapsed=z(b)}else j(b)};else{if(!U||typeof R.isCollapsed!=A||typeof S.collapsed!=A||!J.implementsDomRange)return b.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;fa=function(a){var b,c=a.nativeSelection;c.anchorNode?(b=aa(c,0),a._ranges=[b],a.rangeCount=1,i(a),a.isCollapsed=z(a)):j(a)}}da.refresh=function(a){var b=a?this._ranges.slice(0):null,c=this.anchorNode,d=this.anchorOffset;if(fa(this),a){var e=b.length;if(e!=this._ranges.length)return!0;if(this.anchorNode!=c||this.anchorOffset!=d)return!0;for(;e--;)if(!N(b[e],this._ranges[e]))return!0;return!1}};var ga=function(a,b){var c=a.getAllRanges();a.removeAllRanges();for(var d=0,e=c.length;e>d;++d)N(b,c[d])||a.addRange(c[d]);a.rangeCount||j(a)};_&&P?da.removeRange=function(a){if(this.docSelection.type==K){for(var b,c=this.docSelection.createRange(),d=m(a),e=L(c.item(0)),f=M(e).createControlRange(),g=!1,h=0,i=c.length;i>h;++h)b=c.item(h),b!==d||g?f.add(c.item(h)):g=!0;f.select(),p(this)}else ga(this,a)}:da.removeRange=function(a){ga(this,a)};var ha;!Q&&U&&J.implementsDomRange?(ha=g,da.isBackward=function(){return ha(this)}):ha=da.isBackward=function(){return!1},da.isBackwards=da.isBackward,da.toString=function(){for(var a=[],b=0,c=this.rangeCount;c>b;++b)a[b]=""+this._ranges[b];return a.join("")},da.collapse=function(b,c){v(this,b);var d=a.createRange(b);d.collapseToPoint(b,c),this.setSingleRange(d),this.isCollapsed=!0},da.collapseToStart=function(){if(!this.rangeCount)throw new H("INVALID_STATE_ERR");var a=this._ranges[0];this.collapse(a.startContainer,a.startOffset)},da.collapseToEnd=function(){if(!this.rangeCount)throw new H("INVALID_STATE_ERR");var a=this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)},da.selectAllChildren=function(b){v(this,b);var c=a.createRange(b);c.selectNodeContents(b),this.setSingleRange(c)},da.deleteFromDocument=function(){if(_&&P&&this.docSelection.type==K){for(var a,b=this.docSelection.createRange();b.length;)a=b.item(0),b.remove(a),C.removeNode(a);this.refresh()}else if(this.rangeCount){var c=this.getAllRanges();if(c.length){this.removeAllRanges();for(var d=0,e=c.length;e>d;++d)c[d].deleteContents();this.addRange(c[e-1])}}},da.eachRange=function(a,b){for(var c=0,d=this._ranges.length;d>c;++c)if(a(this.getRangeAt(c)))return b},da.getAllRanges=function(){var a=[];return this.eachRange(function(b){a.push(b)}),a},da.setSingleRange=function(a,b){this.removeAllRanges(),this.addRange(a,b)},da.callMethodOnEachRange=function(a,b){var c=[];return this.eachRange(function(d){c.push(d[a].apply(d,b))}),c},da.setStart=w(!0),da.setEnd=w(!1),a.rangePrototype.select=function(a){ca(this.getDocument()).setSingleRange(this,a)},da.changeEachRange=function(a){var b=[],c=this.isBackward();this.eachRange(function(c){a(c),b.push(c)}),this.removeAllRanges(),c&&1==b.length?this.addRange(b[0],"backward"):this.setRanges(b)},da.containsNode=function(a,b){return this.eachRange(function(c){return c.containsNode(a,b)},!0)||!1},da.getBookmark=function(a){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[a])}},da.moveToBookmark=function(b){for(var c,d,e=[],f=0;c=b.rangeBookmarks[f++];)d=a.createRange(this.win),d.moveToBookmark(c),e.push(d);b.backward?this.setSingleRange(e[0],"backward"):this.setRanges(e)},da.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}},da.restoreRanges=function(a){this.removeAllRanges();for(var b,c=0;b=a.ranges[c];++c)this.addRange(b,a.backward&&0==c)},da.toHtml=function(){var a=[];return this.eachRange(function(b){a.push(F.toHtml(b))}),a.join("")},J.implementsTextRange&&(da.getNativeTextRange=function(){var c;if(c=this.docSelection){var d=c.createRange();if(n(d))return d;throw b.createError("getNativeTextRange: selection is a control selection")}if(this.rangeCount>0)return a.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw b.createError("getNativeTextRange: selection contains no range")}),da.getName=function(){return"WrappedSelection"},da.inspect=function(){return x(this)},da.detach=function(){t(this.win,"delete"),s(this)},r.detachAll=function(){t(null,"deleteAll")},r.inspect=x,r.isDirectionBackward=c,a.Selection=r,a.selectionPrototype=da,a.addShimListener(function(a){"undefined"==typeof a.getSelection&&(a.getSelection=function(){return ca(a)}),a=null})});var K=!1,L=function(a){K||(K=!0,!F.initialized&&F.config.autoInitialize&&l())};return D&&("complete"==document.readyState?L():(a(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",L,!1),H(window,"load",L))),F},this),function(a){"use strict";a.fn.style=function(b){var c='';return a.each(this,function(){var d=a(this).attr('style');return void 0!==d&&a.each(a.fn.style.explode(';',d.replace(/ /g,'')),function(d,e){var f=a.fn.style.explode(':',e);return f[0]==b?(c=f[1],!1):void 0}),!1}),c},a.fn.styles=function(){var b={};return a.each(this,function(){var c=a(this).attr('style');return void 0!==c&&a.each(a.fn.style.explode(';',c.replace(/ /g,'')),function(c,d){var e=a.fn.style.explode(':',d);b[e[0]]=e[1]}),!1}),b},a.fn.style.explode=function(a,b){for(var c=[],d=0,e=b.length;e>d;){var f=b.indexOf(a,d);if(-1==f){c.push(b.slice(d));break}c.push(b.slice(d,f)),d=f+a.length}return c},a.fn.selection=function(b){var c={};return function(b,c){var d=[],e=rangy.getSelection(),f=e.getRangeAt(0),g=rangy.createRangyRange();return g.selectNodeContents(b[0]),!e.isCollapsed&&g.containsRange(f)&&(f.splitBoundaries(),a.each(f.getNodes([3]),function(b,c){f.containsNodeText(c.parentNode)?-1==a.inArray(c.parentNode,d)&&d.push(c.parentNode):d.push(c)})),e.setSingleRange(f),a(d)}(a(this),a.extend(!0,{},c,b))},a.fn.richtext=function(b){var c={toolbar:[['Maximize'],['Source'],['Bold','Italic','Underline','Strike','-','Subscript','Superscript','-','RemoveFormat']],height:'250px'},d=a.fn.richtext.buttons,e=function(a,b){b.mode='wysiwyg',b.maximized=!1,b.buttons_states={}},f=function(b,c){var e=a('<div/>').addClass('ui-editor-toolbar ui-widget-header ui-corner-all ui-front'),f=a('<div/>').addClass('ui-editor ui-widget ui-widget-content ui-corner-all').css({height:c.height}).append(e).append(a('<div/>').addClass('ui-editor-content ui-widget-content').attr({contenteditable:!0,spellcheck:!0}).html(b.html())).append(a('<textarea/>').addClass('ui-editor-source ui-widget-content').attr({spellcheck:!1}).val(b.html()).on('change',function(){b.trigger('change')}).hide());a.each(c.toolbar,function(b,f){if(!a.isArray(f))return void('/'==f&&e.append(a('<span/>').addClass('ui-editor-toolbar-break')));var g=a('<span/>').addClass('ui-editor-toolbar-group ui-state-default ui-corner-all');a.each(f,function(b,e){if('-'==e)g.append(a('<span/>').addClass('ui-editor-toolbar-separator'));else if('undefined'!=typeof d[e]&&'undefined'==typeof c.buttons_states[e]){c.buttons_states[e]=!1;a('<span/>').attr('title',e).attr('button',e).button({icons:{primary:d[e].icon},text:!1}).appendTo(g)}}),g.appendTo(e)});a('<div/>').css({position:'absolute',top:'0',left:'-9999px'}).append(f).appendTo('body');a('.ui-editor-content,.ui-editor-source',f).css('height',parseInt(f.css('height'))-parseInt(e.css('height'))-6+'px'),f.detach(),b.data('editor',f),0===b.parent().length?'TEXTAREA'==b.prop('nodeName').toUpperCase()?console.log('qRichtext error : cannot instanciate on detached TEXTAREA, insert or wrap it first or use DIV instead'):b.empty().append(f):(f.insertBefore(b.hide()),void 0!==b.attr('name')&&(a('.ui-editor-source',f).attr('name',b.attr('name')),b.removeAttr('name')))},g=function(b,c){var e=b.data('editor');a('.ui-button',e).on('click',function(){var f=a(this).attr('title');switch(d[f].type){case'action':return d[f].click(e,c);case'style':switch(d[f].method){case'css':var g={},i=a({});g[d[f].style.property]=d[f].style.value,c.buttons_states[f]?(i=h.removeCSS(e.selection(),g),h.setButtonState(b,c,f,!1)):(i=h.addCSS(e.selection(),g),h.setButtonState(b,c,f,!0)),a.fn.richtext.updateSelection(i);break;case'wrap':c.buttons_states[f]?(h.unwrap(e.selection(),d[f].tag),h.setButtonState(b,c,f,!1)):(h.wrap(e.selection(),d[f].tag),h.setButtonState(b,c,f,!0));break;case'wrapAll':if(c.buttons_states[f])h.unwrapAll(e.selection(),d[f].tag),h.setButtonState(b,c,f,!1);else{var g={};'undefined'!=typeof d[f].style&&(g[d[f].style.property]=d[f].style.value),h.wrapAll(e.selection(),d[f].tag,g),h.setButtonState(b,c,f,!0),h.updateButtonsStates(b,c)}}}h.updateValue(b,c)}),a('.ui-editor-content',e).on('focus',function(a){}).on('select',function(a){}).on('click',function(a){}).on('dblclick',function(a){}).on('mousedown',function(a){}).on('mouseup',function(a){h.updateButtonsStates(b,c)}).on('keyup',function(a){a.shiftKey||h.updateButtonsStates(b,c)}).on('keydown',function(d){if(13==d.which){var f=rangy.getSelection().getRangeAt(0),g=f.startContainer.parentNode;if('LI'==g.nodeName.toUpperCase()){f.splitBoundaries();var i=f.startContainer;i.nextSibling&&(f.selectNodeContents(g),f.setStart(i.nextSibling),f.select());var j=a('<li/>').append(e.selection().detach());a(i).parent().after(j),f.selectNode(j[0]),f.collapse(!0),f.select()}else{var k=a('<br/>')[0];f.collapse(!0),f.insertNode(k),f.setStartAfter(k),f.select()}return!1}h.updateValue(b,c)})},h={addCSS:function(b,c){return a.each(a.fn.richtext.normalize(b),function(b,d){var e=a(this);a.each(c,function(b,c){var d=e.style(b);-1==d.indexOf(c)&&(-1==a.inArray(d,[null,'','0','none'])&&(c=d+' '+c),e.css(b,c))})})},removeCSS:function(b,c){return a.each(a.fn.richtext.normalize(b),function(d,e){var f=a(this);a.each(c,function(c,e){var g=f.attr('style'),h=f.style(c);if(void 0===g||-1==g.indexOf(e)){var i=f.parent();do{h=i.style(c),f.addClass('qRtMoving');var j=i.prop('nodeName'),k=i.parent(),l=a('<'+j+'>'+i.html().replace(new RegExp(f[0].outerHTML),'</'+j+'>'+f[0].outerHTML+'<'+j+'>')+'</'+j+'>');i.replaceWith(l),f=a('.qRtMoving',k).removeAttr('class').attr('style',g),b[d]=f[0],f.add(f.prev()).add(f.next()).css(i.styles()),a.fn.richtext.normalize(k.children(),!1),i=k}while(-1==h.indexOf(e))}f.css(c,f.style(c).replace(new RegExp(e,'g'),''))})}),b},wrap:function(b,c){a.each(b,function(){0===a(this).closest(c).not('.ui-editor-content').length&&a(this).wrap(a('<'+c+'/>'))})},unwrap:function(b,c){a.each(b,function(){var b=a(this);return 3==this.nodeType?void(this.parentNode.firstChild==this?b.parent().before(b.detach()):b.parent().after(b.detach())):void(b.prop('nodeName').toUpperCase()==c.toUpperCase()?b.before(b.html()).remove():b.unwrap())})},wrapAll:function(b,c,d){if(b.prop('nodeName')&&b.prop('nodeName').toUpperCase()==c.toUpperCase())b.css(d);else{var e=a.fn.richtext.normalize(b).first().parent();e.prop('nodeName').toUpperCase()!=c.toUpperCase()||e.hasClass('ui-editor-content')?e.append(a('<'+c+'/>').css(d).append(e.children().detach())):e.css(d)}},unwrapAll:function(a,b){a.prop('nodeName')&&a.prop('nodeName').toUpperCase()==b.toUpperCase()?a.before(a.html()).remove():a.unwrap()},updateValue:function(b,c){c.timeoutId&&clearTimeout(c.timeoutId),c.timeoutId=setTimeout(function(){c.timeoutId=null;var d=b.data('editor');a('.ui-editor-source',d).val(a('.ui-editor-content',d).html()),b.trigger('change')},500)},setButtonState:function(b,c,d,e){var f=a('span[button="'+d+'"]',b.data('editor'));e?(c.buttons_states[d]=!0,f.addClass('ui-state-highlight')):(c.buttons_states[d]=!1,f.removeClass('ui-state-highlight'))},updateButtonsStates:function(b,c){var e,f=b.data('editor'),g=rangy.getSelection();if(e=g.isCollapsed?a(g.anchorNode):f.selection(),void 0!==e&&0!==e.length){var i=e.first(),j=function(b){var c={};return a.each(d,function(d,e){var g=a('span[button="'+d+'"]',f);if(g.length){if('style'!=e.type)return;c[d]=!1,'css'==e.method?(3==b[0].nodeType&&(b=a(b[0].parentNode)),b.css(e.style.property).indexOf(e.style.value)>-1&&(c[d]=!0)):'wrap'==e.method?(b.prop('nodeName').toUpperCase()==e.tag.toUpperCase()||b.parents(e.tag).length>0)&&(c[d]=!0):'wrapAll'==e.method&&('undefined'==typeof e.style?b.parentsUntil(a('.ui-editor-content',f),e.tag).length>0&&(c[d]=!0):b.css(e.style.property)==e.style.value&&(c[d]=!0))}}),c},k=j(i);a.each(e.slice(1),function(){var b=j(a(this)),c=!0;return a.each(k,function(a,d){k[a]=k[a]&&b[a],k[a]&&(c=!1)}),c?!1:void 0}),a.each(k,function(a,d){h.setButtonState(b,c,a,d)})}}};if('object'==typeof b)return a.each(this,function(){return function(a,b){return e(a,b),f(a,b),g(a,b),a}(a(this),a.extend({},c,b))});if('string'==typeof b)switch(b){case'value':return a('.ui-editor-source',a(this).data('editor')).val()}return this},a.fn.richtext.normalize=function(b,c){var d=arguments;return 1==d.length&&(d[1]=!0),a.each(b,function(c,e){var f=a(this);if(d[1])3==this.nodeType&&(b[c]=f.wrap(a('<span/>')).parent()[0]);else if(1==this.nodeType&&'SPAN'==f.prop('nodeName').toUpperCase()){var g=f.attr('style');if(0===f[0].innerHTML.length||void 0===g||0===g.length){var h=a(f[0].childNodes);f.before(h.detach()).remove(),b[c]=h[0]}}})},a.fn.richtext.updateSelection=function(a){var b=rangy.getSelection().getRangeAt(0);a.length&&(b.setStartBefore(a.first()[0]),b.setEndAfter(a.last()[0]),b.select())},a.fn.richtext.buttons={Maximize:{icon:'ui-icon-editor-maximize',type:'action',click:function(b,c){var d=a('.ui-editor-toolbar',b);c.maximized?(c.maximized=!1,b.css({position:'relative',width:c.width,height:c.height}),c.parent.append(b.detach()),a('body').append(c.body_children)):(c.maximized=!0,c.width=b.css('width'),c.parent=b.parent(),c.body_children=a('body').children().detach(),b.detach().appendTo('body').css({position:'absolute',width:'100%',height:'100%','z-index':'9999',top:'0px',left:'0px'})),a('.ui-editor-content,.ui-editor-source',b).css('height',parseInt(b.css('height'))-parseInt(d.css('height'))-6+'px')}},Source:{icon:'ui-icon-editor-source',type:'action',click:function(b,c){var d=a('.ui-editor-content',b),e=a('.ui-editor-source',b);'wysiwyg'==c.mode?(c.mode='source',e.val(d.html()),a('.ui-button',b).not(a('.ui-button[title="Source"]',b)).button({disabled:!0})):'source'==c.mode&&(c.mode='wysiwyg',d.html(e.val()),a('.ui-button',b).button({disabled:!1})),d.toggle(),e.toggle()}},Italic:{icon:'ui-icon-editor-italic',type:'style',method:'css',style:{property:'font-style',value:'italic'}},Underline:{icon:'ui-icon-editor-underline',type:'style',method:'css',style:{property:'text-decoration',value:'underline'}},Strike:{icon:'ui-icon-editor-strike',type:'style',method:'css',style:{property:'text-decoration',value:'line-through'}},Bold:{icon:'ui-icon-editor-bold',type:'style',method:'css',style:{property:'font-weight',value:'bold'}},Subscript:{icon:'ui-icon-editor-subscript',type:'style',method:'wrap',tag:'sub'},Superscript:{icon:'ui-icon-editor-superscript',type:'style',method:'wrap',tag:'sup'},RemoveFormat:{icon:'ui-icon-editor-removeformat',type:'action',click:function(b,c){a.fn.richtext.updateSelection(a.fn.richtext.normalize(b.selection().removeAttr('style'),!1))}},Blockquote:{icon:'ui-icon-editor-blockquote',type:'style',method:'wrapAll',tag:'blockquote'},Anchor:{icon:'ui-icon-editor-anchor',type:'action',click:function(a,b){}},Link:{icon:'ui-icon-editor-link',type:'action',click:function(a,b){}},Image:{icon:'ui-icon-editor-image',type:'action',click:function(a,b){}},Table:{icon:'ui-icon-editor-table',type:'action',click:function(a,b){}}},a.extend(!0,a.fn.richtext.buttons,{Undo:{icon:'ui-icon-editor-undo',type:'action',click:function(a,b){document.execCommand('undo',!1,null)}},Redo:{icon:'ui-icon-editor-redo',type:'action',click:function(a,b){document.execCommand('redo',!1,null)}},Cut:{icon:'ui-icon-editor-cut',type:'action',click:function(a,b){var c=rangy.getSelection().getRangeAt(0);b.clipboard=c.extractContents()}},Copy:{icon:'ui-icon-editor-copy',type:'action',click:function(a,b){var c=rangy.getSelection().getRangeAt(0);b.clipboard=c.cloneContents()}},Paste:{icon:'ui-icon-editor-paste',type:'action',click:function(b,c){var d=rangy.getSelection().getRangeAt(0);d.splitBoundaries(),a(d.startContainer).after(a(c.clipboard.childNodes))}}}),a.extend(!0,a.fn.richtext.buttons,{JustifyLeft:{icon:'ui-icon-editor-justifyleft',type:'style',method:'wrapAll',tag:'div',style:{property:'text-align',value:'left'}},JustifyCenter:{icon:'ui-icon-editor-justifycenter',type:'style',method:'wrapAll',tag:'div',style:{property:'text-align',value:'center'}},JustifyRight:{icon:'ui-icon-editor-justifyright',type:'style',method:'wrapAll',tag:'div',style:{property:'text-align',value:'right'}},JustifyBlock:{icon:'ui-icon-editor-justifyblock',type:'style',method:'wrapAll',tag:'div',style:{property:'text-align',value:'justify'}}}),a.extend(!0,a.fn.richtext.buttons,{NumberedList:{icon:'ui-icon-editor-numberedlist',type:'action',click:function(b,c){var d=b.selection();if(0===d.length){var e=rangy.getSelection().getRangeAt(0);e.splitBoundaries(),a(e.startContainer).after(a('<ol><li/></ol>'))}else a.fn.richtext.normalize(d).wrapAll('<ol><li/></ol>')}},BulletedList:{icon:'ui-icon-editor-bulletedlist',type:'action',click:function(b,c){var d=b.selection();if(0===d.length){var e=rangy.getSelection().getRangeAt(0);e.splitBoundaries(),a(e.startContainer).after(a('<ol><li/></ol>'))}else a.fn.richtext.normalize(d).wrapAll('<ul><li/></ul>')}},Outdent:{icon:'ui-icon-editor-outdent',type:'action',click:function(a,b){}},Indent:{icon:'ui-icon-editor-indent',type:'action',click:function(a,b){}}}),a.extend(!0,a.fn.richtext.buttons,{TextColor:{icon:'ui-icon-editor-textcolor',type:'action',click:function(b,c){var d=a('#qRtColorPicker',b);return 0===d.length?(d=a('<div/>').attr('id','qRtColorPicker').css({position:'absolute'}).colorpicker({color:'#31859b'}).on('change.color',function(c,e){a.fn.richtext.normalize(b.selection()).css('color',e),d.hide()}).appendTo(a('.ui-editor-toolbar',b)),b.on('click.colorpicker',function(){d.hide()})):d.toggle(),!1}}})}(jQuery),function(a,b){b.SearchWidgets={string:function(b,c){var d=a('<input type="text"/>').attr({id:c.id,name:c.name}).addClass('ui-widget').css('margin-right','10px').val(c.value);return d},short_text:function(a,c){return b.SearchWidgets.string(a,c)},text:function(a,c){return b.SearchWidgets.string(a,c)},binary:function(a,c){return b.SearchWidgets.string(a,c)},'boolean':function(a,c){return b.SearchWidgets.string(a,c)},integer:function(a,c){return b.SearchWidgets.string(a,c)},'float':function(a,c){return b.SearchWidgets.string(a,c)},many2one:function(a,c){return b.SearchWidgets.string(a,c)},time:function(a,c){return b.SearchWidgets.string(a,c)},timestamp:function(a,c){return b.SearchWidgets.string(a,c)},date:function(b,c){var d=a('<input type="text"/>').attr({id:c.id,name:c.name}).css('margin-right','10px').daterangepicker({dateFormat:'yy-mm-dd',presetRanges:[{text:'Today',dateStart:'today',dateEnd:'today'},{text:'The previous Month',dateStart:function(){return Date.parse('1 month ago').moveToFirstDayOfMonth()},dateEnd:function(){return Date.parse('1 month ago').moveToLastDayOfMonth()}},{text:'The previous Year',dateStart:function(){return Date.parse('12 months ago').moveToLastDayOfMonth()},dateEnd:function(){return Date.parse('1 day ago')}}],presets:{specificDate:'Specific Date',dateRange:'Date Range'},earliestDate:Date.parse('-70years'),latestDate:Date.parse('+20years'),datepickerOptions:{changeMonth:!0,changeYear:!0,yearRange:'c-70:c+20'}});return d},datetime:function(a,c){return b.SearchWidgets.date(a,c)}},a.fn.qSearchWidget=function(c){var d={id:null,name:null,value:null,type:'string'};return this.each(function(){return function(a,c){try{if('undefined'==typeof b.SearchWidgets[c.type])throw Error('Error raised in qinoa-ui.qSearchWidget : unknown type '+c.type);var d=b.SearchWidgets[c.type](a,c);return a.data('widget',d.appendTo(a))}catch(e){b.console.log(c.type+' '+c.name+e.message)}}(a(this),a.extend(!0,d,c))})}}(jQuery,qinoa),/*! 
* qinoa-ui.qSearch - v1.0.0
* https://github.com/cedricfrancoys/qinoa
* Copyright (c) 2015 Cedric Francoys; Licensed GPLv3 */
function(a){a.fn.qSearchGrid=function(b){var c={class_name:'',view:'list.default',ui:qinoa.conf.user_lang},d={layout:function(b,c){var d,e,f,g=a.Deferred();return a({}).queue(function(b){a.when(qinoa.get_schema(c.class_name)).done(function(a){d=a,b()})}).queue(function(b){a.when(qinoa.get_fields(c.class_name,c.view)).done(function(a){e=a,b()})}).queue(function(b){a.when(qinoa.get_lang(c.class_name,c.ui)).done(function(a){f=a,b()})}).queue(function(h){var i=a('<div/>').css('width','100%');a.each(e,function(b,c){a.extend({},c);if(a.inArray(d[b].type,qinoa.simple_types)>=0||0==d[b].type&&a.inArray(d[b].result_type,qinoa.simple_types)>=0&&1==d[b].store){var e='function'==d[b].type?d[b].result_type:d[b].type,g=b;a.isEmptyObject(f)||'undefined'==typeof f.model[b]||'undefined'==typeof f.model[b].label||(g=f.model[b].label),$widget=a('<span/>').qSearchWidget({id:b+(new Date).getTime(),name:b,type:e}),i.append(a('<div/>').css({'float':'left','margin-bottom':'2px'}).append(a('<div/>').append(a('<label/>').attr('for',b).css({'float':'left','text-align':'right',width:'80px','margin-right':'4px'}).text(g)).append($widget)))}});var j=a('<div/>').qGrid(c).on('ready',function(){var c=a.extend(!0,[],j.data('conf').domain),e=a('<div/>').append(a('<table/>').append(a('<tr/>').append(a('<td>').attr('width','90%').append(i)).append(a('<td>').append(a('<button type="button"/>').css('margin-bottom','2px').text('search').button().on('click',function(){var b=j.data('conf');b.domain=a.extend(!0,[],c),a('input',e).each(function(){var c=a(this),e=c.attr('name'),f=c.val();if(f.length)switch(b.records='',type=d[e].type,'function'==d[e].type&&(type=d[e].result_type),type){case'boolean':case'integer':case'many2one':case'selection':case'time':case'timestamp':b.domain[0].push([e,'=',f]);break;case'datetime':case'date':var g=f.split(" - ");switch(g.length){case 1:b.domain[0].push([e,'=',f]);break;case 2:b.domain[0].push([e,'>=',g[0]]),b.domain[0].push([e,'<=',g[1]])}break;case'string':case'short_text':case'text':case'binary':b.domain[0].push([e,'ilike','%'+f+'%'])}}),j.trigger('reload')})))));b.append(e).append(j),b.data('conf',j.data('conf')),g.resolve()})}),g.promise()},translate:function(a,b){}};return this.each(function(){return function(b,c){return a.when(d.layout(b,c)).done(function(){b.trigger('ready')}),b}(a(this),a.extend(!0,c,b))})}}(jQuery),function(a){a.fn.editable=function(b){var c={name:'',value:'',mode:'edit',type:'string',format:'',align:'left',readonly:!1,required:!1,onchange:function(){}};return this.each(function(){return function(b,c){switch(b.attr('mode',c.mode),b.data('value',c.value),c.type){case'boolean':b.on('render',function(){b.empty(),a('<input type="checkbox" />').attr({id:c.name,name:c.name}).prop('checked',parseInt(c.value)>0).on('change',function(){b.data('value',+this.checked),b.trigger('change')}).val(parseInt(b.data('value'))>0?1:0).appendTo(b)});break;case'integer':var d=a('<input type="text"/>').attr({id:c.name,name:c.name}).css({width:'100%','text-align':c.align}).val(c.value).on('change',c.onchange);d.inputmask("integer",{allowMinus:!0}),c.readonly&&d.attr("disabled","disabled");break;case'float':var d=a('<input type="text"/>').attr({id:c.name,name:c.name}).css({width:'100%','text-align':c.align}).val(c.value).on('change',c.onchange);d.inputmask("decimal",{radixPoint:".",digits:2,autoGroup:!1}),c.readonly&&d.attr("disabled","disabled");break;case'string':b.on('toggle',function(){b.attr('mode','view'==b.attr('mode')?'edit':'view'),b.trigger('render')}).on('render',function(){b.empty(),'edit'==b.attr('mode')?a('<input type="text"/>').attr({id:c.name,name:c.name}).css({width:'100%','text-align':c.align}).on('change',function(){b.data('value',a(this).val()),b.trigger('change')}).val(b.data('value')).appendTo(b):a('<div/>').css({width:'100%','text-align':c.align}).html(b.data('value')).appendTo(b)});break;case'selection':b.on('render',function(){b.empty();var d=a('<div />');a.each(c.selection,function(b,e){$option=a('<option />').attr('value',b).text(e),b==c.value&&$option.attr('selected','selected'),d.append($option)}),a('<select />').attr({id:c.name,name:c.name}).css({width:'100%','text-align':c.align}).append(d.children()).on('change',function(){b.data('value',a(this).val()),b.trigger('change')}).val(b.data('value')).appendTo(b)})}return b.trigger('render')}(a(this),a.extend(!0,c,b))})}}(jQuery);